import{a as E,b as P}from"./chunk-JHLG2C23.js";import{a as D}from"./chunk-2BRIRZP4.js";import{g as V,h as W}from"./chunk-GXPIWCJ5.js";import"./chunk-TWUCS5NJ.js";import"./chunk-J7CB3EH5.js";import{b as F,d as I,e as M,g as A,i as L}from"./chunk-LH57K2S6.js";import{$ as v,B as f,C as u,Ma as h,Oa as y,Q as d,Qa as T,Ra as w,Sa as x,W as _,la as C,ma as c,na as p,oa as g,va as S,x as a,xa as k,za as b}from"./chunk-Z6OSM3TB.js";import"./chunk-EQDQRRRY.js";function z(i,s){if(i&1&&h(0),i&2){let r=s.$implicit;y(" ",r.components==null?null:r.components.length," ")}}function B(i,s){if(i&1){let r=S();c(0,"label",3)(1,"input",4),k("ngModelChange",function(){let t=f(r).$implicit,n=b();return u(n.changeStatus(t))}),x("ngModelChange",function(t){let n=f(r).$implicit;return w(n.active,t)||(n.active=t),u(t)}),p(),g(2,"span",5),c(3,"span",6),h(4,"Active"),p()()}if(i&2){let r=s.$implicit;d(),T("ngModel",r.active)}}var X=(()=>{let s=class s{constructor(){this._translate=a(D),this._customformService=a(V),this._alert=a(L),this._form=a(W),this.columns=["formId","components","active"],this.form=this._form.prepareForm({formId:"customForm",title:"Custom form",components:[{name:"Text",key:"title",focused:!0,fields:[{name:"Placeholder",value:"Enter title ..."},{name:"Label",value:"Title"}]},{name:"Select",key:"formId",fields:[{name:"Placeholder",value:"Select form id ..."},{name:"Label",value:"Form ID"},{name:"Items",value:this._form.formIds}]}]}),this.components=[],this.formComponents=this._form.getForm("formComponents",{formId:"formComponents",title:"Custom components",components:[{components:this.components},{name:"Select",key:"addComponent",fields:[{name:"Placeholder",value:"Select form componnet ..."},{name:"Label",value:"Form Component"},{name:"Value",value:"name",skipTranslation:!0},{name:"Items",value:this._form.getTemplateComponentsNames()}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(e,t)=>{this._customformService.appId&&(e.appId=this._customformService.appId),this._customformService.create(e,{callback:t.bind(this)})}})},update:e=>{this._form.modal(this.form,{label:"Update",click:(t,n)=>{this._customformService.update(t,{callback:n.bind(this)})}},e).then(this._customformService.update.bind(this))},delete:e=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this user?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._customformService.delete(e)}}]})},buttons:[{icon:"text_fields",click:e=>{console.log(this.formComponents),this.components.splice(0,this.components.length);let t={addComponent:"Text"};e.components=e.components||[];for(let o=e.components.length-1;o>=0;o--){let l=this._form.getTemplateFields(e.components[o].name);e.components[o].fields=e.components[o].fields.filter(m=>l.includes(m.name));for(let m of l)e.components[o].fields.find(N=>N.name===m)||e.components[o].fields.push({value:"",name:m});t["key"+o]=e.components[o].key;for(let m of e.components[o].fields)t[m.name+o]=m.value}let n=o=>{this.components.splice(o,1),e.components.splice(o,1),this._customformService.updateAfterWhile(e)};(e.components||[]).forEach(o=>{this.components.push(this._addCustomComponent(o.name,this.components.length,n))}),this._form.modal(this.formComponents,{label:"Add component",click:()=>{let o=t.addComponent;this.components.push(this._addCustomComponent(o,this.components.length,n)),e.components.push({name:t.addComponent,fields:this._form.getTemplateFields(o).map(l=>({value:"",name:l}))})}},t,()=>{},{size:"big"}).then(()=>{for(let o=0;o<e.components.length;o++){e.components[o].key=t["key"+o];for(let l of e.components[o].fields)l.value=t[l.name+o]}this._customformService.updateAfterWhile(e)})}}]}}get rows(){return this._customformService.customforms}_addCustomComponent(e,t,n){let o=this._form.getTemplateFields(e).map(m=>({name:this._form.getCustomTemplateFields(e)[m]||"Text",key:m+t,fields:[{name:"Placeholder",value:"fill "+m},{name:"Label",value:m.charAt(0).toUpperCase()+m.slice(1,m.length)}]}));return{class:"d-f mt10",components:[{name:"Text",key:"key"+t,fields:[{name:"Placeholder",value:"Enter key ..."},{name:"Label",value:"Key"}]},...o,{name:"Button",fields:[{name:"Label",value:"Remove"},{name:"Click",value:()=>{n(t)}}]}]}}changeStatus(e){setTimeout(()=>{if(e.active)for(let t of this._customformService.customforms)t._id===e._id||t.formId!==e.formId||t.active&&(t.active=!1,this._customformService.updateAfterWhile(t));this._customformService.updateAfterWhile(e)})}};s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=_({type:s,selectors:[["ng-component"]],decls:3,vars:3,consts:[["title","Forms Customization",3,"columns","config","rows"],["cell","components"],["cell","active"],[1,"container-box"],["type","checkbox",1,"w-input__checkbox",3,"ngModelChange","ngModel"],[1,"checkmark"],[1,"checkmark-text"]],template:function(t,n){t&1&&(c(0,"wtable",0),v(1,z,1,1,"ng-template",1)(2,B,5,1,"ng-template",2),p()),t&2&&C("columns",n.columns)("config",n.config)("rows",n.rows)},dependencies:[P,E,A,F,I,M],encapsulation:2,changeDetection:0});let i=s;return i})();export{X as CustomformsComponent};
