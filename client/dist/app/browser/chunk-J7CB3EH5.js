import{n as u,o}from"./chunk-LH57K2S6.js";import{I as h,L as l,Y as g,t as n,x as a}from"./chunk-Z6OSM3TB.js";var f=(()=>{let t=class t extends o{constructor(){super({name:"translatelanguage",unauthorized:!0}),this.language=h({}),this.languages=h(this.getDocs()),this._storeService=a(u),this._storeService.get("languageId",e=>{e&&this.setLanguageId(e)}),this.get().subscribe(()=>{this.languages.set(this.getDocs())})}setLanguage(e){this.language.set(e),this._storeService.setJson("languageId",e._id)}setLanguageId(e){let s=this.languages().find(i=>i._id===e||i._localId===+e);s&&this.setLanguage(s)}nextLanguage(){let e=this.languages();if(e.length>1){let s=this.language(),i=e.findIndex(p=>p._id===s._id);this.setLanguage(i===e.length-1?e[0]:e[i])}}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var d=(()=>{let t=class t extends o{constructor(){super({name:"translatephrase",unauthorized:!0}),this.get()}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var m=(()=>{let t=class t extends o{constructor(){super({name:"translate",unauthorized:!0,replace:e=>{e.slug=e.phrase+e.language}}),this._resets={},this._phraseService=a(d),this._languageService=a(f),this._phrases={},this._translates={},this._phraseService.filteredDocuments(this._phrases,{field:"text",filtered:this._reTranslate.bind(this)}),this.filteredDocuments(this._translates,{field:"slug",filtered:this._reTranslate.bind(this)}),this.get()}translate(e,s){if(!e)return"";if(this._resets[e]||=[],s&&this._resets[e].push(s),console.log(e,!this._phrases[e]?.length,this._phrases[e],this._phraseService.getDocs()),!this._phrases[e]?.length)return this._phraseService.create({text:e}),e;let i=this._phrases[e][0]._id??""+this._languageService.language()._id;return this._translates[i]?.length&&this._translates[i][0].text||e}_reTranslate(){for(let e in this._resets){this._resets[e]||=[];for(let s of this._resets[e])s(this.translate(e))}}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var F=(()=>{let t=class t{constructor(){this._elementRef=a(l),this._translateService=a(m)}ngOnInit(){this._elementRef.nativeElement.innerHTML=this._translateService.translate(this._elementRef.nativeElement.innerHTML,e=>{this._elementRef.nativeElement.innerHTML=e})}};t.\u0275fac=function(s){return new(s||t)},t.\u0275dir=g({type:t,selectors:[["","translate",""]]});let r=t;return r})();export{f as a,d as b,m as c,F as d};
