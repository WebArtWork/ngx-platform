import{a as pe}from"./chunk-G5C7A5E6.js";import{a as Ht}from"./chunk-C6AZOIPQ.js";import{b as Ne}from"./chunk-YFSGOCWZ.js";import{a as Tt,b as Ee,c as Ft,d as Vt,e as Rt,f as Ot,g as Pt,h as zt,k as ce,m as kt,n as Dt,o as Et,p as Le,q as Lt,r as At,s as Nt,t as Ae,w as Bt}from"./chunk-QOT76O5U.js";import{$a as bt,C as Ve,Ca as R,D as _e,Da as O,E as d,Ea as P,F as h,Fa as Ct,Ga as xt,Ha as ae,Hb as It,Ia as fe,J as pt,Ja as $,Ka as Ce,L as V,La as v,M as mt,Ma as Q,Na as G,Q as Re,R as dt,S as m,Sa as le,Ta as z,Ua as C,Va as wt,W as ht,Wa as Oe,X as y,Xa as Pe,Ya as ze,Za as ve,_ as ut,_a as ke,aa as M,ab as vt,b as lt,bb as D,ca as _t,cb as N,da as be,db as Ye,ea as S,fa as I,fb as F,ga as Xe,ha as ge,ia as Y,ib as te,ja as J,jb as U,k as me,ka as x,kb as L,l as Qe,la as l,lb as g,ma as c,mb as yt,na as X,nb as De,p as ct,qb as Mt,ra as gt,s as Ke,sa as ft,sb as B,t as Fe,ta as re,tb as St,u as ue,ua as b,vb as xe,wa as _,y as w,ya as p}from"./chunk-H5N67KS5.js";import{a as A,b as oe,c as W}from"./chunk-2VMXMS7J.js";function Be(r="Required"){return i=>i==null||typeof i=="string"&&i.trim()===""||Array.isArray(i)&&i.length===0?r:null}function Wt(){let r;return{promise:new Promise(n=>r=n),resolve:r}}var ie=(()=>{let i=class i{constructor(){this._forms=new Map}getForm(e){let t=this._forms.get(e);return t||(t={fields:new Map,values:V({}),touched:V({}),errors:V({}),submitting:V(!1),submitDeferred:Wt(),handlers:{_multi:{onFieldRegister:[],onFieldChange:[],onFieldTouched:[]}}},this._forms.set(e,t),this._callSingle(e,"onInit"),t)}registerField(e,t,o=null,a=[]){let s=this.getForm(e);return s.fields.has(t)||(s.fields.set(t,{value:V(o),touched:V(!1),error:V(null),validators:a}),this._recompute(e),this._emit(e,"onFieldRegister",t)),this.getFieldAPI(e,t)}getFieldAPI(e,t){let a=this.getForm(e).fields.get(t);if(!a)throw new Error(`Field "${t}" not registered.`);let s=u=>{a.value.set(u),this.validateField(e,t),this._recompute(e),this._emit(e,"onFieldChange",t,u,this.getValues(e))};return{value:a.value,error:a.error,touched:a.touched,setValue:s,setTouched:u=>{a.touched.set(u),this._recompute(e),this._emit(e,"onFieldTouched",t,u)},getValue:()=>a.value(),validate:()=>this.validateField(e,t)}}setValue(e,t,o){this.getForm(e).fields.has(t)?this.getForm(e).fields.get(t).value.set(o):this.registerField(e,t,o),this.validateField(e,t),this._recompute(e),this._emit(e,"onFieldChange",t,o,this.getValues(e))}patch(e,t){Object.entries(t).forEach(([o,a])=>this.setValue(e,o,a)),this._callSingle(e,"onPatch",t)}getValues(e){return A({},this.getForm(e).values())}getErrors(e){return A({},this.getForm(e).errors())}validateField(e,t){let a=this.getForm(e).fields.get(t);if(!a)return null;let s=this.getValues(e),u=a.value(),f=a.validators.map(T=>T(u,s)).find(Boolean)??null;return a.error.set(f),f}validateForm(e){let t=!0;return this.getForm(e).fields.forEach((o,a)=>{this.validateField(e,a)&&(t=!1)}),this._recompute(e),t}touchAll(e){this.getForm(e).fields.forEach(t=>t.touched.set(!0)),this._recompute(e)}getSubmitPromise(e){return this.getForm(e).submitDeferred.promise}submit(e){return W(this,null,function*(){let t=this.getForm(e);t.submitting.set(!0);let o=this.getValues(e);yield this._callSingle(e,"onBeforeValidate",o),this.touchAll(e);let a=this.validateForm(e),s=this.getValues(e),u=this.getErrors(e);return a?yield this._callSingle(e,"onValidSubmit",s):yield this._callSingle(e,"onInvalidSubmit",u,s),yield this._callSingle(e,"onAfterValidate",{values:s,valid:a,errors:u}),t.submitDeferred.resolve(),t.submitDeferred=Wt(),yield this._callSingle(e,"onSubmitAlways",{values:s,valid:a}),t.submitting.set(!1),{values:s,valid:a}})}reset(e,t){this.getForm(e).fields.forEach((a,s)=>{a.value.set(t?.[s]??null),a.touched.set(!1),a.error.set(null)}),this._recompute(e),this._callSingle(e,"onReset",this.getValues(e))}destroyForm(e){this._callSingle(e,"onDestroy"),this._forms.delete(e)}setHandler(e,t,o){let a=this.getForm(e);o?a.handlers[t]=o:delete a.handlers[t]}addListener(e,t,o){this.getForm(e).handlers._multi[t].push(o)}removeListener(e,t,o){let a=this.getForm(e).handlers._multi[t];this.getForm(e).handlers._multi[t]=a.filter(s=>s!==o)}clearHandlers(e){this.getForm(e).handlers={_multi:{onFieldRegister:[],onFieldChange:[],onFieldTouched:[]}}}_recompute(e){let t=this.getForm(e),o={},a={},s={};t.fields.forEach((u,f)=>{o[f]=u.value(),a[f]=u.touched(),s[f]=u.error()}),t.values.set(o),t.touched.set(a),t.errors.set(s)}_callSingle(e,t,...o){return W(this,null,function*(){let a=this._forms.get(e);if(!a)return;let s=a.handlers[t];typeof s=="function"&&(yield s(...o))})}_emit(e,t,...o){return W(this,null,function*(){let a=this._forms.get(e)?.handlers._multi[t]??[];for(let s of a)yield s(...o)})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();var we=(()=>{let i=class i{constructor(){this._translateService=w(Ne)}transform(e){return this._translateService.translate(e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=ut({name:"translate",type:i,pure:!0});let r=i;return r})();var fi=["inputEl"];function Ci(r,i){if(r&1&&(l(0,"span",2),v(1),D(2,"translate"),c()),r&2){p(2);let n=C(2);m(),Q(N(2,1,n)())}}function xi(r,i){if(r&1){let n=b();l(0,"i",7),_("click",function(){d(n);let t=p(2);return t.model.set(null),t.onSubmit(),h(t.focus())}),v(1,"close"),c()}}function wi(r,i){if(r&1&&(l(0,"div",6),v(1),D(2,"translate"),c()),r&2){p(2);let n=C(2),e=C(7);m(),G(" ",N(2,1,(n||e)+" is invalid.")()," ")}}function bi(r,i){if(r&1){let n=b();l(0,"label",1),S(1,Ci,3,3,"span",2),l(2,"div",3)(3,"input",4,0),D(5,"translate"),_("ngModelChange",function(t){d(n);let o=p();return o.model.set(t),h(o.onChangeAfterWhile())})("keyup.enter",function(){d(n);let t=p();return h(t.onSubmit())})("blur",function(){d(n);let t=p();return h(t.onBlur())}),c(),S(6,xi,2,0,"i",5),c(),S(7,wi,3,3,"div",6),c()}if(r&2){let n,e=p(),t=C(0),o=C(1),a=C(2),s=C(3),u=C(5),f=C(6),T=C(7),j=C(8),q=C(9);m(),I(a?1:-1),m(2),$("error",j),x("placeholder",N(5,12,T||"Enter text...")())("type",t||"text")("autocomplete",e.getAutocompleteAttr(t))("disabled",s||(((n=e.control())==null?null:n.disabled)??!1))("ngModel",q)("ngClass",u)("name",o),m(3),I(f?6:-1),m(),I(j?7:-1)}}function vi(r,i){if(r&1&&(l(0,"span",2),v(1),D(2,"translate"),c()),r&2){p(2);let n=C(2);m(),Q(N(2,1,n)())}}function yi(r,i){if(r&1&&(l(0,"div",6),v(1),D(2,"translate"),c()),r&2){p(2);let n=C(2),e=C(7);m(),G(" ",N(2,1,(n||e)+" is invalid.")()," ")}}function Mi(r,i){if(r&1){let n=b();l(0,"label",1),S(1,vi,3,3,"span",2),l(2,"div",3)(3,"textarea",8,0),D(5,"translate"),_("ngModelChange",function(t){d(n);let o=p();return o.model.set(t),h(o.onChangeAfterWhile())})("keyup.enter",function(){d(n);let t=p();return h(t.onSubmit())})("blur",function(){d(n);let t=p();return h(t.onBlur())}),c()(),S(6,yi,3,3,"div",6),c()}if(r&2){let n,e=p(),t=C(1),o=C(2),a=C(3),s=C(5),u=C(7),f=C(8),T=C(9);m(),I(o?1:-1),m(2),$("error",f),x("placeholder",N(5,9,u||"Enter text...")())("disabled",a||(((n=e.control())==null?null:n.disabled)??!1))("ngModel",T)("ngClass",s)("name",t),m(3),I(f?6:-1)}}function Si(r,i){if(r&1){let n=b();l(0,"label",10)(1,"span",11),v(2),D(3,"translate"),c(),l(4,"input",12,0),_("ngModelChange",function(t){d(n);let o=p(2);return o.model.set(t),h(o.onChange())})("blur",function(){d(n);let t=p(2);return h(t.onBlur())}),c(),X(6,"span",13),c()}if(r&2){let n,e,t=i.$implicit,o=p(2),a=C(1),s=C(3),u=C(5),f=C(8),T=C(9);$("disabled",s||(((n=o.control())==null?null:n.disabled)??!1)),m(2),Q(N(3,10,t)()),m(2),$("error",f),x("disabled",s||(((e=o.control())==null?null:e.disabled)??!1))("ngModel",T)("ngClass",u)("value",t)("name",a)}}function Ii(r,i){if(r&1&&Y(0,Si,7,12,"label",9,Xe),r&2){p();let n=C(4);J(n)}}function Ti(r,i){if(r&1){let n=b();l(0,"label",10)(1,"span",11),v(2),D(3,"translate"),c(),l(4,"input",14,0),_("ngModelChange",function(t){let o=d(n).$index,a=p(2);return h(a.setCheckboxValue(t,o))})("blur",function(){d(n);let t=p(2);return h(t.onBlur())}),c(),X(6,"span",15),c()}if(r&2){let n,e,t=i.$implicit,o=i.$index,a=p(2),s=C(1),u=C(3),f=C(5),T=C(8);$("disabled",u||(((n=a.control())==null?null:n.disabled)??!1)),m(2),Q(N(3,9,t)()),m(2),$("error",T),x("disabled",u||(((e=a.control())==null?null:e.disabled)??!1))("ngClass",f)("ngModel",a.isChecked(t))("name",s+o)}}function Fi(r,i){if(r&1&&(l(0,"span",11),v(1),D(2,"translate"),c()),r&2){p(3);let n=C(2);m(),Q(N(2,1,n)())}}function Vi(r,i){if(r&1){let n=b();l(0,"label",10),S(1,Fi,3,3,"span",11),l(2,"input",14,0),_("ngModelChange",function(t){d(n);let o=p(2);return o.model.set(t),h(o.onChange())})("blur",function(){d(n);let t=p(2);return h(t.onBlur())}),c(),X(4,"span",15),c()}if(r&2){let n,e,t=p(2),o=C(1),a=C(2),s=C(3),u=C(5),f=C(8),T=C(9);$("disabled",s||(((n=t.control())==null?null:n.disabled)??!1)),m(),I(a?1:-1),m(),$("error",f),x("disabled",s||(((e=t.control())==null?null:e.disabled)??!1))("ngClass",u)("ngModel",T)("name",o)}}function Ri(r,i){if(r&1&&(Y(0,Ti,7,11,"label",9,Xe),S(2,Vi,5,9,"label",9)),r&2){p();let n=C(4);J(n),m(2),I(n.length?-1:2)}}var H=(()=>{let i=class i{constructor(){this.value=g(""),this.wModel=g(void 0),this.wModelChange=L(),this.control=g(null),this.formId=g(null),this.formKey=g(null),this.validators=g([]),this.items=g([]),this.type=g("text"),this.name=g("name"),this.placeholder=g(""),this.label=g(""),this.disabled=g(!1),this.focused=g(!1),this.clearable=g(!1),this.wClass=g(""),this.autocomplete=g(void 0),this.replace=g(),this.valid=g(e=>!!e),this.wChange=L(),this.wSubmit=L(),this.wBlur=L(),this.model=V(null),this.error=V(!1),this._usewForm=V(!1),this._inputEl=yt.required("inputEl"),this._core=w(ce),this._destroyRef=w(pt),this._virtualFormService=w(ie),this._fieldApi=null,U(()=>{let e=!!this.formId()&&!!this.formKey();if(this._usewForm.set(e),!e){this._fieldApi=null;return}this._fieldApi=this._virtualFormService.registerField(this.formId(),this.formKey(),this.model(),this.validators())}),U(()=>{let e=this.control();if(e){this.model.set(e.value),this._reflectControlError(),e.valueChanges?.pipe(Tt(this._destroyRef)).subscribe(o=>{this.model.set(o),this._reflectControlError()});return}if(this._usewForm()&&this._fieldApi){this.model.set(this._fieldApi.value()),this.error.set(!!this._fieldApi.error());return}let t=this.wModel();if(t!==void 0){this.model.set(t);return}this.model.set(this.value())})}ngAfterViewInit(){this.focused()&&this.focus()}focus(){this._inputEl().nativeElement.focus()}onChange(){let e=this.replace(),t=this.model();if(typeof e=="function"){let o=e(t);o!==t&&this.model.set(o)}if(this._usewForm()&&this._fieldApi)this._fieldApi.setValue(this.model()),this.error.set(!!this._fieldApi.error());else{let o=this.control();o?(o.setValue(this.model(),{emitEvent:!0}),this._reflectControlError()):this.wModel()!==void 0&&this.wModelChange.emit(this.model())}this._core.afterWhile(this,()=>this.wChange.emit(this.model()),2e3)}onChangeAfterWhile(){this.error.set(!1),this.onChange()}onBlur(){if(this.wBlur.emit(),this._usewForm()&&this._fieldApi){this._fieldApi.setTouched(!0),this.error.set(!!this._fieldApi.error());return}let e=this.control();e&&(e.markAsTouched(),this._reflectControlError())}onSubmit(){if(this.onChange(),this._usewForm()&&this._fieldApi){this._fieldApi.validate(),this.error.set(!!this._fieldApi.error()),this.wSubmit.emit(this.model());return}let e=this.control();if(e){e.markAsTouched(),this._reflectControlError(),this.wSubmit.emit(this.model());return}this.valid()(this.model())?this.wSubmit.emit(this.model()):this.error.set(!0)}setCheckboxValue(e,t){let o=Array.isArray(this.model())?this.model():[],a=this.items()[t],s=e?[...o,a]:o.filter(u=>u!==a);this.model.set(s),this.onChange()}isChecked(e){let t=this.model();return Array.isArray(t)?t.includes(e):!1}getAutocompleteAttr(e){let t=this.autocomplete();return t??(e==="password"?"current-password":null)}_reflectControlError(){let e=this.control();e&&this.error.set(!!(e.invalid&&(e.touched||e.dirty)))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["winput"]],viewQuery:function(t,o){t&1&&Ct(o._inputEl,fi,5),t&2&&xt()},inputs:{value:[1,"value"],wModel:[1,"wModel"],control:[1,"control"],formId:[1,"formId"],formKey:[1,"formKey"],validators:[1,"validators"],items:[1,"items"],type:[1,"type"],name:[1,"name"],placeholder:[1,"placeholder"],label:[1,"label"],disabled:[1,"disabled"],focused:[1,"focused"],clearable:[1,"clearable"],wClass:[1,"wClass"],autocomplete:[1,"autocomplete"],replace:[1,"replace"],valid:[1,"valid"]},outputs:{wModelChange:"wModelChange",wChange:"wChange",wSubmit:"wSubmit",wBlur:"wBlur"},decls:14,vars:14,consts:[["inputEl",""],[1,"winput"],[1,"winput__label"],[1,"winput__control"],[1,"winput__field",3,"ngModelChange","keyup.enter","blur","placeholder","type","autocomplete","disabled","ngModel","ngClass","name"],[1,"material-icons","winput__clear"],[1,"winput__error"],[1,"material-icons","winput__clear",3,"click"],[1,"winput__field","winput__field--textarea",3,"ngModelChange","keyup.enter","blur","placeholder","disabled","ngModel","ngClass","name"],[1,"winput__choice",3,"disabled"],[1,"winput__choice"],[1,"winput__choice-text"],["type","radio",1,"winput__native",3,"ngModelChange","blur","disabled","ngModel","ngClass","value","name"],[1,"winput__choice-mark","winput__choice-mark--radio"],["type","checkbox",1,"winput__native",3,"ngModelChange","blur","disabled","ngClass","ngModel","name"],[1,"winput__choice-mark"]],template:function(t,o){if(t&1&&(le(0)(1)(2)(3)(4)(5)(6)(7)(8)(9),S(10,bi,8,14,"label",1),S(11,Mi,7,11,"label",1),S(12,Ii,2,0),S(13,Ri,3,1)),t&2){let a=z(o.type());m(),z(o.name()),m(),z(o.label()),m(),z(o.disabled()),m(),z(o.items()),m(),z(o.wClass()),m(),z(o.clearable()),m(),z(o.placeholder()),m(),z(o.error()),m(),z(o.model()),m(),I(a!=="radio"&&a!=="checkbox"&&a!=="textarea"?10:-1),m(),I(a==="textarea"?11:-1),m(),I(a==="radio"?12:-1),m(),I(a==="checkbox"?13:-1)}},dependencies:[zt,Vt,Ft,Pt,Rt,Ot,B,we],styles:['[_ngcontent-%COMP%]:root{--c-white: #fff;--c-basic: #3558ae;--c-primary: #256eff;--c-primary-hover: #0051f1;--c-secondary: rgb(197, 61, 61);--c-secondary-hover: rgb(150, 42, 42);--c-bg-primary: #f3f4f7;--c-bg-secondary: #ffffff;--c-bg-tertiary: #fcfdfe;--c-border: #f0f1f7;--c-shadow: #f3f3f3;--c-text-primary: #666666;--c-text-secondary: #19235c;--c-placeholder: #313335ab;--c-img-round: 50%;--card-background: #fefefe;--card-border-radius: 10px;--card-box-shadow: 0 4px 12px rgba(0, 0, 0, .15);--card-margin-bottom: 24px;--card-header-padding: 20px;--card-header-background: #e0e0e0;--card-body-padding: 20px;--card-section-padding: 10px 0;--card-footer-padding: 20px;--card-footer-background: #e0e0e0;--card-border-width: 2px;--card-border-color: #cccccc;--file-img-border-radius: 50%;--file-add-bg: #28a745;--file-add-bg-hover: #218838;--file-item-border-radius: 10px;--day-name: #988888;--b-radius-btn: 10px;--transition: all .3s;--events: #4c8e9d;--border: rgba(102, 91, 91, .432);--header-doc: #d8d8d8;--doc-products: #f5f5f5}html.dark[_ngcontent-%COMP%]:root{--c-white: #fff;--c-basic: #333;--c-bg-primary: #282828;--c-bg-secondary: #343434;--c-bg-tertiary: #404040;--c-border: #404040;--c-shadow: #444444;--c-text-primary: #ffffff;--c-text-secondary: #ffffff;--c-placeholder: #d3cdcd;--c-calendar: #141414;--day-name: #dad5d5;--events: #1c2e32;--border: rgb(255 255 255 / 23%);--header-doc: #1b1b1be3;--doc-products: #252222}.winput[_ngcontent-%COMP%]{position:relative;padding:10px 0;display:block}.winput__label[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;font-weight:500;font-size:20px;line-height:23px;color:var(--c-text-primary);border-radius:var(--b-radius);letter-spacing:0}.winput__control[_ngcontent-%COMP%]{position:relative}.winput__field[_ngcontent-%COMP%]{width:100%;display:block;background-color:transparent;border:1px solid var(--c-border);border-radius:var(--b-radius);color:var(--c-text-secondary);font-size:calc(var(--fs) - 2px);line-height:calc(var(--fs) + 4px);letter-spacing:var(--letter-spacing);padding:8px 12px;transition:var(--transition);appearance:textfield;-webkit-appearance:textfield;-moz-appearance:textfield}.winput__field[_ngcontent-%COMP%]::placeholder{color:var(--c-placeholder);transition:var(--transition)}.winput__field[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--c-primary);transition:var(--transition)}.winput__field[_ngcontent-%COMP%]:disabled{background-color:var(--c-grey);border-color:var(--c-grey);color:var(--c-grey);cursor:default;opacity:.6}.winput__field[type=time][_ngcontent-%COMP%]{appearance:textfield;-webkit-appearance:textfield;-moz-appearance:textfield}.winput__field--textarea[_ngcontent-%COMP%]{min-height:88px;resize:vertical}.winput__clear[_ngcontent-%COMP%]{position:absolute;right:7px;bottom:8px;cursor:pointer;-webkit-user-select:none;user-select:none}.winput__error[_ngcontent-%COMP%]{margin-top:4px;font-size:12px;color:red}.winput__choice[_ngcontent-%COMP%]{display:flex;column-gap:5px;align-items:center;cursor:pointer}.winput__choice.disabled[_ngcontent-%COMP%]{opacity:.5}.winput__choice.disabled[_ngcontent-%COMP%]   .winput__choice-mark[_ngcontent-%COMP%]{background-color:gray!important}.winput__choice-text[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:500;font-size:18px;line-height:1.2}.winput__native[_ngcontent-%COMP%]{width:0;height:0;overflow:hidden;position:absolute;opacity:0;pointer-events:none}.winput__native[_ngcontent-%COMP%]:checked ~ .winput__choice-mark[_ngcontent-%COMP%]:before{opacity:1}.winput__native[_ngcontent-%COMP%]:checked ~ .winput__choice-mark--radio[_ngcontent-%COMP%]:before{opacity:1}.winput__choice-mark[_ngcontent-%COMP%]{order:-1;position:relative;width:26px;height:26px;display:inline-block;border-radius:4px;background-color:var(--c-primary);border:1px solid var(--c-border);box-shadow:0 1px 1px var(--c-shadow);transition:var(--transition);transform:scale(1)}.winput__choice-mark[_ngcontent-%COMP%]:before{content:"";position:absolute;left:50%;top:50%;width:7px;height:14px;border-bottom:3px solid #fff;border-right:3px solid #fff;transform:translate(-50%,-71%) rotate(45deg);opacity:0;transition:var(--transition);display:block}.winput__choice-mark--radio[_ngcontent-%COMP%]{border-radius:120px}.winput__choice-mark--radio[_ngcontent-%COMP%]:before{width:12px;height:12px;border-radius:120px;background:#fff;border:none;transform:translate(-50%,-50%)}input.error[_ngcontent-%COMP%], textarea.error[_ngcontent-%COMP%]{border:1px solid red}'],changeDetection:0});let r=i;return r})();var $t=(()=>{let i=class i extends At{constructor(){super({name:"file"}),this._file=w(Nt),this._http=w(Le),this.files=this.getDocs(),this._file.add({id:"formPhoto",resize:1920,cb:e=>typeof e=="string"&&this.setFile?.(e)}),this._file.add({id:"formPhotos",multiple:!0,resize:1920,cb:e=>typeof e=="string"&&this.setFile?.(e)})}uploadBase64(e,t="general",o=""){return W(this,null,function*(){return yield new Promise(a=>{this._http.post("/api/file/photo",{container:t,name:o,dataUrl:e},s=>a(s))})})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();var Oi=["wrapper"],Pi=["sourceImage"];function zi(r,i){if(r&1){let n=b();l(0,"img",5,0),_("load",function(){d(n);let t=p();return h(t.imageLoadedInView())})("mousedown",function(t){d(n);let o=p();return h(o.startMove(t,o.moveTypes.Drag))})("touchstart",function(t){d(n);let o=p();return h(o.startMove(t,o.moveTypes.Drag))})("error",function(t){d(n);let o=p();return h(o.loadImageError(t))}),c()}if(r&2){let n=i.ngIf,e=p();fe("visibility",e.imageVisible?"visible":"hidden")("transform",e.safeTransformStyle()),$("ngx-ic-draggable",!e.disabled&&e.allowMoveImage),x("src",n,Re),be("alt",e.imageAltText)}}function ki(r,i){if(r&1){let n=b();gt(0),l(1,"span",9),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"topleft"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"topleft"))}),X(2,"span",10),c(),l(3,"span",11),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"topright"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"topright"))}),X(4,"span",10),c(),l(5,"span",12),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"bottomright"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"bottomright"))}),X(6,"span",10),c(),l(7,"span",13),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"bottomleft"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"bottomleft"))}),X(8,"span",10),c(),l(9,"span",14),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"top"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"top"))}),c(),l(10,"span",15),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"top"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"top"))}),X(11,"span",10),c(),l(12,"span",16),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"right"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"right"))}),c(),l(13,"span",17),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"right"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"right"))}),X(14,"span",10),c(),l(15,"span",18),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"bottom"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"bottom"))}),c(),l(16,"span",19),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"bottom"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"bottom"))}),X(17,"span",10),c(),l(18,"span",20),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"left"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"left"))}),c(),l(19,"span",21),_("mousedown",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"left"))})("touchstart",function(t){d(n);let o=p(2);return h(o.startMove(t,o.moveTypes.Resize,"left"))}),X(20,"span",10),c(),ft()}}function Di(r,i){if(r&1){let n=b();l(0,"div",6),_("keydown",function(t){d(n);let o=p();return h(o.keyboardAccess(t))}),l(1,"div",7),_("mousedown",function(t){d(n);let o=p();return h(o.startMove(t,o.moveTypes.Move))})("touchstart",function(t){d(n);let o=p();return h(o.startMove(t,o.moveTypes.Move))}),c(),M(2,ki,21,0,"ng-container",8),c()}if(r&2){let n=p();fe("top",n.state.cropper().y1,"px")("left",n.state.cropper().x1,"px")("width",n.state.cropper().x2-n.state.cropper().x1,"px")("height",n.state.cropper().y2-n.state.cropper().y1,"px")("margin-left",n.state.options.alignImage==="center"?n.marginLeft:null)("visibility",n.imageVisible?"visible":"hidden"),$("ngx-ic-round",n.state.options.roundCropper),be("aria-label",n.state.options.cropperFrameAriaLabel),m(2),x("ngIf",!n.state.options.hideResizeSquares&&!(n.state.options.cropperStaticWidth&&n.state.options.cropperStaticHeight))}}function ye(r,i,n){return r=Ei(r,i),He(r,i,n)}function Ei(r,i){let n=r.x2-r.x1,e=r.y2-r.y1,t=r.x1+n/2,o=r.y1+e/2;i.options.cropperStaticHeight&&i.options.cropperStaticWidth?(n=i.maxSize().width>i.options.cropperStaticWidth?i.options.cropperStaticWidth:i.maxSize().width,e=i.maxSize().height>i.options.cropperStaticHeight?i.options.cropperStaticHeight:i.maxSize().height):(n=Math.max(i.cropperScaledMinWidth,Math.min(n,i.cropperScaledMaxWidth,i.maxSize().width)),e=Math.max(i.cropperScaledMinHeight,Math.min(e,i.cropperScaledMaxHeight,i.maxSize().height)),i.options.maintainAspectRatio&&(i.maxSize().width/i.options.aspectRatio<i.maxSize().height?e=n/i.options.aspectRatio:n=e*i.options.aspectRatio));let a=t-n/2,s=a+n,u=o-e/2,f=u+e;return{x1:a,x2:s,y1:u,y2:f}}function He(r,i,n=!1){return r.x1<0&&(r=oe(A({},r),{x1:0,x2:r.x2-(n?r.x1:0)})),r.y1<0&&(r=oe(A({},r),{y2:r.y2-(n?r.y1:0),y1:0})),r.x2>i.maxSize().width&&(r=oe(A({},r),{x1:r.x1-(n?r.x2-i.maxSize().width:0),x2:i.maxSize().width})),r.y2>i.maxSize().height&&(r=oe(A({},r),{y1:r.y1-(n?r.y2-i.maxSize().height:0),y2:i.maxSize().height})),r}function Li(r,i){let n=We(r)-i.clientX,e=$e(r)-i.clientY;return{x1:i.cropper.x1+n,y1:i.cropper.y1+e,x2:i.cropper.x2+n,y2:i.cropper.y2+e}}function Ut(r,i,n){let e=A({},n.cropper()),t=We(r)-i.clientX,o=$e(r)-i.clientY;switch(i.position){case"left":e.x1=Math.min(Math.max(i.cropper.x1+t,e.x2-n.cropperScaledMaxWidth),e.x2-n.cropperScaledMinWidth);break;case"topleft":e.x1=Math.min(Math.max(i.cropper.x1+t,e.x2-n.cropperScaledMaxWidth),e.x2-n.cropperScaledMinWidth),e.y1=Math.min(Math.max(i.cropper.y1+o,e.y2-n.cropperScaledMaxHeight),e.y2-n.cropperScaledMinHeight);break;case"top":e.y1=Math.min(Math.max(i.cropper.y1+o,e.y2-n.cropperScaledMaxHeight),e.y2-n.cropperScaledMinHeight);break;case"topright":e.x2=Math.max(Math.min(i.cropper.x2+t,e.x1+n.cropperScaledMaxWidth),e.x1+n.cropperScaledMinWidth),e.y1=Math.min(Math.max(i.cropper.y1+o,e.y2-n.cropperScaledMaxHeight),e.y2-n.cropperScaledMinHeight);break;case"right":e.x2=Math.max(Math.min(i.cropper.x2+t,e.x1+n.cropperScaledMaxWidth),e.x1+n.cropperScaledMinWidth);break;case"bottomright":e.x2=Math.max(Math.min(i.cropper.x2+t,e.x1+n.cropperScaledMaxWidth),e.x1+n.cropperScaledMinWidth),e.y2=Math.max(Math.min(i.cropper.y2+o,e.y1+n.cropperScaledMaxHeight),e.y1+n.cropperScaledMinHeight);break;case"bottom":e.y2=Math.max(Math.min(i.cropper.y2+o,e.y1+n.cropperScaledMaxHeight),e.y1+n.cropperScaledMinHeight);break;case"bottomleft":e.x1=Math.min(Math.max(i.cropper.x1+t,e.x2-n.cropperScaledMaxWidth),e.x2-n.cropperScaledMinWidth),e.y2=Math.max(Math.min(i.cropper.y2+o,e.y1+n.cropperScaledMaxHeight),e.y1+n.cropperScaledMinHeight);break;case"center":let a="scale"in r?r.scale:1,s=Math.min(Math.max(n.cropperScaledMinWidth,Math.abs(i.cropper.x2-i.cropper.x1)*a),n.cropperScaledMaxWidth),u=Math.min(Math.max(n.cropperScaledMinHeight,Math.abs(i.cropper.y2-i.cropper.y1)*a),n.cropperScaledMaxHeight);e.x1=i.clientX-s/2,e.x2=i.clientX+s/2,e.y1=i.clientY-u/2,e.y2=i.clientY+u/2,e.x1<0?(e.x2-=e.x1,e.x1=0):e.x2>n.maxSize().width&&(e.x1-=e.x2-n.maxSize().width,e.x2=n.maxSize().width),e.y1<0?(e.y2-=e.y1,e.y1=0):e.y2>n.maxSize().height&&(e.y1-=e.y2-n.maxSize().height,e.y2=n.maxSize().height);break}return n.options.maintainAspectRatio?Ai(i.position,e,n):e}function Ai(r,i,n){i=A({},i);let e=0,t=0;switch(r){case"top":i.x2=i.x1+(i.y2-i.y1)*n.options.aspectRatio,e=Math.max(i.x2-n.maxSize().width,0),t=Math.max(0-i.y1,0),(e>0||t>0)&&(i.x2-=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y1+=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"bottom":i.x2=i.x1+(i.y2-i.y1)*n.options.aspectRatio,e=Math.max(i.x2-n.maxSize().width,0),t=Math.max(i.y2-n.maxSize().height,0),(e>0||t>0)&&(i.x2-=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y2-=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"topleft":i.y1=i.y2-(i.x2-i.x1)/n.options.aspectRatio,e=Math.max(0-i.x1,0),t=Math.max(0-i.y1,0),(e>0||t>0)&&(i.x1+=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y1+=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"topright":i.y1=i.y2-(i.x2-i.x1)/n.options.aspectRatio,e=Math.max(i.x2-n.maxSize().width,0),t=Math.max(0-i.y1,0),(e>0||t>0)&&(i.x2-=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y1+=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"right":case"bottomright":i.y2=i.y1+(i.x2-i.x1)/n.options.aspectRatio,e=Math.max(i.x2-n.maxSize().width,0),t=Math.max(i.y2-n.maxSize().height,0),(e>0||t>0)&&(i.x2-=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y2-=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"left":case"bottomleft":i.y2=i.y1+(i.x2-i.x1)/n.options.aspectRatio,e=Math.max(0-i.x1,0),t=Math.max(i.y2-n.maxSize().height,0),(e>0||t>0)&&(i.x1+=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y2-=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"center":i.x2=i.x1+(i.y2-i.y1)*n.options.aspectRatio,i.y2=i.y1+(i.x2-i.x1)/n.options.aspectRatio;let o=Math.max(0-i.x1,0),a=Math.max(i.x2-n.maxSize().width,0),s=Math.max(i.y2-n.maxSize().height,0),u=Math.max(0-i.y1,0);(o>0||a>0||s>0||u>0)&&(i.x1+=s*n.options.aspectRatio>o?s*n.options.aspectRatio:o,i.x2-=u*n.options.aspectRatio>a?u*n.options.aspectRatio:a,i.y1+=u*n.options.aspectRatio>a?u:a/n.options.aspectRatio,i.y2-=s*n.options.aspectRatio>o?s:o/n.options.aspectRatio);break}return i}function We(r){return"touches"in r&&r.touches[0]?r.touches[0].clientX:"clientX"in r?r.clientX:0}function $e(r){return"touches"in r&&r.touches[0]?r.touches[0].clientY:"clientX"in r?r.clientY:0}var Je=class{constructor(){this.cropper=V({x1:0,x2:0,y1:0,y2:0}),this.maxSize=V({width:0,height:0}),this.transform={},this.options={format:"png",output:"blob",autoCrop:!0,maintainAspectRatio:!0,aspectRatio:1,resetCropOnAspectRatioChange:!0,resizeToWidth:0,resizeToHeight:0,cropperMinWidth:0,cropperMinHeight:0,cropperMaxHeight:0,cropperMaxWidth:0,cropperStaticWidth:0,cropperStaticHeight:0,canvasRotation:0,roundCropper:!1,onlyScaleDown:!1,imageQuality:92,backgroundColor:void 0,containWithinAspectRatio:!1,hideResizeSquares:!1,alignImage:"center",cropperFrameAriaLabel:void 0,checkImageType:!0},this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=3}setOptionsFromChanges(i){i.options?.currentValue&&this.setOptions(i.options.currentValue);let n=Object.entries(i).filter(([e])=>e in this.options).reduce((e,[t,o])=>oe(A({},e),{[t]:o.currentValue}),{});Object.keys(n).length>0&&this.setOptions(n)}setOptions(i){if(this.options=A(A({},this.options),i||{}),this.validateOptions(),!this.loadedImage?.transformed.image.complete||!this.maxSize)return;let n=!1;this.options.maintainAspectRatio&&i.aspectRatio||"maintainAspectRatio"in i?(this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.options.maintainAspectRatio&&(this.options.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(this.cropper.set(this.maxSizeCropperPosition()),n=!0)):((i.cropperMinWidth||i.cropperMinHeight)&&(this.setCropperScaledMinSize(),n=!0),(i.cropperMaxWidth||i.cropperMaxHeight)&&(this.setCropperScaledMaxSize(),n=!0),(i.cropperStaticWidth||i.cropperStaticHeight)&&(n=!0)),n&&this.cropper.update(e=>ye(e,this,!1))}validateOptions(){if(this.options.maintainAspectRatio&&!this.options.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}setMaxSize(i,n){this.maxSize.set({width:i,height:n}),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}setCropperScaledMinSize(){this.loadedImage?.transformed.size?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.cropperScaledMinWidth=this.options.cropperMinWidth>0?Math.max(20,this.options.cropperMinWidth/this.loadedImage.transformed.size.width*this.maxSize().width):20}setCropperScaledMinHeight(){this.options.maintainAspectRatio?this.cropperScaledMinHeight=Math.max(20,this.cropperScaledMinWidth/this.options.aspectRatio):this.options.cropperMinHeight>0?this.cropperScaledMinHeight=Math.max(20,this.options.cropperMinHeight/this.loadedImage.transformed.size.height*this.maxSize().height):this.cropperScaledMinHeight=20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed.size){let i=this.loadedImage.transformed.size.width/this.maxSize().width;this.cropperScaledMaxWidth=this.options.cropperMaxWidth>20?this.options.cropperMaxWidth/i:this.maxSize().width,this.cropperScaledMaxHeight=this.options.cropperMaxHeight>20?this.options.cropperMaxHeight/i:this.maxSize().height,this.options.maintainAspectRatio&&(this.cropperScaledMaxWidth>this.cropperScaledMaxHeight*this.options.aspectRatio?this.cropperScaledMaxWidth=this.cropperScaledMaxHeight*this.options.aspectRatio:this.cropperScaledMaxWidth<this.cropperScaledMaxHeight*this.options.aspectRatio&&(this.cropperScaledMaxHeight=this.cropperScaledMaxWidth/this.options.aspectRatio))}else this.cropperScaledMaxWidth=this.maxSize().width,this.cropperScaledMaxHeight=this.maxSize().height}equalsCropperPosition(i){let n=this.cropper();return n==null&&i==null||n!=null&&i!=null&&n.x1.toFixed(3)===i.x1.toFixed(3)&&n.y1.toFixed(3)===i.y1.toFixed(3)&&n.x2.toFixed(3)===i.x2.toFixed(3)&&n.y2.toFixed(3)===i.y2.toFixed(3)}equalsTransformTranslate(i){return(this.transform.translateH??0)===(i.translateH??0)&&(this.transform.translateV??0)===(i.translateV??0)}equalsTransform(i){return this.equalsTransformTranslate(i)&&(this.transform.scale??1)===(i.scale??1)&&(this.transform.rotate??0)===(i.rotate??0)&&(this.transform.flipH??!1)===(i.flipH??!1)&&(this.transform.flipV??!1)===(i.flipV??!1)}aspectRatioIsCorrect(){let i=this.cropper();return(i.x2-i.x1)/(i.y2-i.y1)===this.options.aspectRatio}resizeCropperPosition(i){(i.width!==this.maxSize().width||i.height!==this.maxSize().height)&&this.cropper.update(n=>({x1:n.x1*this.maxSize().width/i.width,x2:n.x2*this.maxSize().width/i.width,y1:n.y1*this.maxSize().height/i.height,y2:n.y2*this.maxSize().height/i.height}))}maxSizeCropperPosition(){return{x1:0,y1:0,x2:this.maxSize().width,y2:this.maxSize().height}}toCropInput(){return{cropper:this.cropper(),maxSize:this.maxSize(),transform:this.transform,loadedImage:this.loadedImage,options:A({},this.options)}}},Z=(function(r){return r.Drag="drag",r.Move="move",r.Resize="resize",r.Pinch="pinch",r})(Z||{});function Ni(r,i,n){let e=r.width,t=r.height;i=Math.round(i),n=Math.round(n);let o=e/i,a=t/n,s=Math.ceil(o/2),u=Math.ceil(a/2),f=r.getContext("2d");if(f){let T=f.getImageData(0,0,e,t),j=f.createImageData(i,n),q=T.data,K=j.data;for(let ee=0;ee<n;ee++)for(let se=0;se<i;se++){let Me=(se+ee*i)*4,di=ee*a,ne=0,Se=0,tt=0,it=0,nt=0,ot=0,rt=0,hi=Math.floor(se*o),ui=Math.floor(ee*a),je=Math.ceil((se+1)*o),qe=Math.ceil((ee+1)*a);je=Math.min(je,e),qe=Math.min(qe,t);for(let Ie=ui;Ie<qe;Ie++){let at=Math.abs(di-Ie)/u,_i=se*o,gi=at*at;for(let Te=hi;Te<je;Te++){let st=Math.abs(_i-Te)/s,de=Math.sqrt(gi+st*st);if(de>=1)continue;ne=2*de*de*de-3*de*de+1;let he=4*(Te+Ie*e);rt+=ne*q[he+3],tt+=ne,q[he+3]<255&&(ne=ne*q[he+3]/250),it+=ne*q[he],nt+=ne*q[he+1],ot+=ne*q[he+2],Se+=ne}}K[Me]=it/Se,K[Me+1]=nt/Se,K[Me+2]=ot/Se,K[Me+3]=rt/tt}r.width=i,r.height=n,f.putImageData(j,0,0)}}function jt(r,i){return r/100*i}var Ge=class{crop(i,n){let e=this.getImagePosition(i),t=e.x2-e.x1,o=e.y2-e.y1,a=document.createElement("canvas");a.width=t,a.height=o;let s=a.getContext("2d");if(!s)return null;i.options?.backgroundColor!=null&&(s.fillStyle=i.options.backgroundColor,s.fillRect(0,0,t,o));let u=(i.transform?.scale||1)*(i.transform?.flipH?-1:1),f=(i.transform?.scale||1)*(i.transform?.flipV?-1:1),{translateH:T,translateV:j}=this.getCanvasTranslate(i),q=i.loadedImage.transformed;s.setTransform(u,0,0,f,q.size.width/2+T,q.size.height/2+j),s.translate(-e.x1/u,-e.y1/f),s.rotate((i.transform?.rotate||0)*Math.PI/180),s.drawImage(q.image,-q.size.width/2,-q.size.height/2);let K={width:t,height:o,imagePosition:e,cropperPosition:A({},i.cropper)};i.options?.containWithinAspectRatio&&(K.offsetImagePosition=this.getOffsetImagePosition(i));let ee=this.getResizeRatio(t,o,i.options);return ee!==1&&(K.width=Math.round(t*ee),K.height=i.options?.maintainAspectRatio?Math.round(K.width/(i.options?.aspectRatio??1)):Math.round(o*ee),Ni(a,K.width,K.height)),n==="blob"?this.cropToBlob(K,a,i):(K.base64=a.toDataURL("image/"+(i.options?.format??"png"),this.getQuality(i.options)),K)}cropToBlob(i,n,e){return W(this,null,function*(){return i.blob=yield new Promise(t=>n.toBlob(t,"image/"+(e.options?.format??"png"),this.getQuality(e.options))),i.blob&&(i.objectUrl=URL.createObjectURL(i.blob)),i})}getCanvasTranslate(i){if(i.transform?.translateUnit==="px"){let n=this.getRatio(i);return{translateH:(i.transform?.translateH||0)*n,translateV:(i.transform?.translateV||0)*n}}else return{translateH:i.transform?.translateH?jt(i.transform.translateH,i.loadedImage.transformed.size.width):0,translateV:i.transform?.translateV?jt(i.transform.translateV,i.loadedImage.transformed.size.height):0}}getRatio(i){return i.loadedImage.transformed.size.width/i.maxSize.width}getImagePosition(i){let n=this.getRatio(i),e={x1:Math.round(i.cropper.x1*n),y1:Math.round(i.cropper.y1*n),x2:Math.round(i.cropper.x2*n),y2:Math.round(i.cropper.y2*n)};return i.options?.containWithinAspectRatio||(e.x1=Math.max(e.x1,0),e.y1=Math.max(e.y1,0),e.x2=Math.min(e.x2,i.loadedImage.transformed.size.width),e.y2=Math.min(e.y2,i.loadedImage.transformed.size.height)),e}getOffsetImagePosition(i){let n=(i.options?.canvasRotation??0)+i.loadedImage.exifTransform.rotate,e=this.getRatio(i),t,o;n%2?(t=(i.loadedImage.transformed.size.width-i.loadedImage.original.size.height)/2,o=(i.loadedImage.transformed.size.height-i.loadedImage.original.size.width)/2):(t=(i.loadedImage.transformed.size.width-i.loadedImage.original.size.width)/2,o=(i.loadedImage.transformed.size.height-i.loadedImage.original.size.height)/2);let a=i.cropper,s={x1:Math.round(a.x1*e)-t,y1:Math.round(a.y1*e)-o,x2:Math.round(a.x2*e)-t,y2:Math.round(a.y2*e)-o};return i.options?.containWithinAspectRatio||(s.x1=Math.max(s.x1,0),s.y1=Math.max(s.y1,0),s.x2=Math.min(s.x2,i.loadedImage.transformed.size.width),s.y2=Math.min(s.y2,i.loadedImage.transformed.size.height)),s}getResizeRatio(i,n,e){let t=new Array;e?.resizeToWidth&&e.resizeToWidth>0&&t.push(e.resizeToWidth/i),e?.resizeToHeight&&e.resizeToHeight>0&&t.push(e.resizeToHeight/n);let o=t.length===0?1:Math.min(...t);return o>1&&!e?.onlyScaleDown?o:Math.min(o,1)}getQuality(i){return Math.min(1,Math.max(0,(i?.imageQuality??92)/100))}},Bi=[new Uint8Array([255,216,255,225,0,34,69,120,105,102,0,0,77,77,0,42,0,0,0,8,0,1,1,18,0,3,0,0,0,1,0,6,0,0,0,0,0,0,255,219,0,132,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,255,192,0,17,8,0,1,0,2,3,1,17,0,2,17,1,3,17,1,255,196,0,74,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,16,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,218,0,12,3,1,0,2,17,3,17,0,63,0,63,240,127,255,217])],Hi=URL.createObjectURL(new Blob(Bi,{type:"image/jpeg"}));function Wi(){return new Promise(r=>{let i=new Image;i.onload=()=>{let n=i.width===1&&i.height===2;r(n)},i.src=Hi})}function $i(r){switch(typeof r=="object"&&(r=Ui(r)),r){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}function Ui(r){let i=new DataView(r);if(i.getUint16(0,!1)!==65496)return-2;let n=i.byteLength,e=2;for(;e<n;){if(i.getUint16(e+2,!1)<=8)return-1;let t=i.getUint16(e,!1);if(e+=2,t==65505){if(i.getUint32(e+=2,!1)!==1165519206)return-1;let o=i.getUint16(e+=6,!1)==18761;e+=i.getUint32(e+4,o);let a=i.getUint16(e,o);e+=2;for(let s=0;s<a;s++)if(i.getUint16(e+s*12,o)==274)return i.getUint16(e+s*12+8,o)}else{if((t&65280)!==65280)break;e+=i.getUint16(e,!1)}}return-1}var Ze=class{constructor(){this.autoRotateSupported=Wi()}loadImageFile(i,n){return W(this,null,function*(){let e=yield i.arrayBuffer();return n.checkImageType?yield this.checkImageTypeAndLoadImageFromArrayBuffer(e,i.type,n):yield this.loadImageFromArrayBuffer(e,n)})}checkImageTypeAndLoadImageFromArrayBuffer(i,n,e){return this.isValidImageType(n)?this.loadImageFromArrayBuffer(i,e,n):Promise.reject(new Error("Invalid image type"))}isValidImageType(i){return/image\/(png|jpg|jpeg|heic|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(i)}loadImageFromURL(i,n){return W(this,null,function*(){let t=yield(yield fetch(i)).blob(),o=yield t.arrayBuffer();return yield this.loadImageFromArrayBuffer(o,n,t.type)})}loadBase64Image(i,n){let e=this.base64ToArrayBuffer(i);return this.loadImageFromArrayBuffer(e,n)}base64ToArrayBuffer(i){i=i.replace(/^data:([^;]+);base64,/gmi,"");let n=atob(i),e=n.length,t=new Uint8Array(e);for(let o=0;o<e;o++)t[o]=n.charCodeAt(o);return t.buffer}loadImageFromArrayBuffer(i,n,e){return W(this,null,function*(){let t=yield new Promise((o,a)=>W(this,null,function*(){try{let s=new Blob([i],e?{type:e}:void 0),u=URL.createObjectURL(s),f=new Image,j=e==="image/svg+xml"?yield this.getSvgImageSize(s):void 0;f.onload=()=>o({originalImage:f,originalImageSize:j,originalObjectUrl:u,originalArrayBuffer:i}),f.onerror=a,f.src=u}catch(s){a(s)}}));return yield this.transformImageFromArrayBuffer(t,n,t.originalImageSize!=null)})}getSvgImageSize(i){return W(this,null,function*(){let t=new DOMParser().parseFromString(yield i.text(),"image/svg+xml").querySelector("svg");if(!t)throw Error("Failed to parse SVG image");let o=t.getAttribute("width"),a=t.getAttribute("height");if(o&&a)return null;let s=t.getAttribute("viewBox")||t.getAttribute("viewbox");if(s){let u=s.split(" ");return{width:+u[2],height:+u[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})}transformImageFromArrayBuffer(i,n,e=!1){return W(this,null,function*(){let t=yield this.autoRotateSupported,o=$i(t?-1:i.originalArrayBuffer);if(!i.originalImage||!i.originalImage.complete)return Promise.reject(new Error("No image loaded"));let a={original:{objectUrl:i.originalObjectUrl,image:i.originalImage,size:i.originalImageSize??{width:i.originalImage.naturalWidth,height:i.originalImage.naturalHeight}},exifTransform:o};return this.transformLoadedImage(a,n,e)})}transformLoadedImage(i,n,e=!1){return W(this,null,function*(){let t=(n.canvasRotation??0)+i.exifTransform.rotate,o=i.original.size;if(!e&&t===0&&!i.exifTransform.flip&&!n.containWithinAspectRatio)return{original:{objectUrl:i.original.objectUrl,image:i.original.image,size:A({},o)},transformed:{objectUrl:i.original.objectUrl,image:i.original.image,size:A({},o)},exifTransform:i.exifTransform};let a=this.getTransformedSize(o,i.exifTransform,n),s=document.createElement("canvas");s.width=a.width,s.height=a.height;let u=s.getContext("2d");u?.setTransform(i.exifTransform.flip?-1:1,0,0,1,s.width/2,s.height/2),u?.rotate(Math.PI*(t/2)),u?.drawImage(i.original.image,-o.width/2,-o.height/2);let f=yield new Promise(q=>s.toBlob(q,"image/"+(n.format??"png")));if(!f)throw new Error("Failed to get Blob for transformed image.");let T=URL.createObjectURL(f),j=yield this.loadImageFromObjectUrl(T);return{original:{objectUrl:i.original.objectUrl,image:i.original.image,size:A({},o)},transformed:{objectUrl:T,image:j,size:{width:j.width,height:j.height}},exifTransform:i.exifTransform}})}loadImageFromObjectUrl(i){return new Promise((n,e)=>{let t=new Image;t.onload=()=>n(t),t.onerror=e,t.src=i})}getTransformedSize(i,n,e){let t=(e.canvasRotation??0)+n.rotate;if(e.containWithinAspectRatio)if(t%2){let o=i.width*(e.aspectRatio??1),a=i.height/(e.aspectRatio??1);return{width:Math.max(i.height,o),height:Math.max(i.width,a)}}else{let o=i.height*(e.aspectRatio??1),a=i.width/(e.aspectRatio??1);return{width:Math.max(i.width,o),height:Math.max(i.height,a)}}return t%2?{height:i.width,width:i.height}:{width:i.width,height:i.height}}};function ji(r){switch(r){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}function qi(r){switch(r){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}function Qi(r,i){switch(r){case"ArrowUp":return{clientX:0,clientY:i*-1};case"ArrowRight":return{clientX:i,clientY:0};case"ArrowDown":return{clientX:0,clientY:i};case"ArrowLeft":default:return{clientX:i*-1,clientY:0}}}var qt=(()=>{let i=class i{get alignImageStyle(){return this.state.options.alignImage}constructor(e){this.sanitizer=e,this.pinchStart$=new lt,this.cropService=new Ge,this.loadImageService=new Ze,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.moveTypes=Z,this.state=new Je,this.safeImgDataUrl=V(void 0),this.safeTransformStyle=V(void 0),this.marginLeft="0px",this.imageVisible=!1,this.allowMoveImage=!1,this.checkImageType=!0,this.disabled=!1,this.hidden=!1,this.imageCropped=L(),this.startCropImage=L(),this.imageLoaded=L(),this.cropperReady=L(),this.loadImageFailed=L(),this.transformChange=L(),this.cropperChange=L(),this.reset()}ngOnInit(){this.state.stepSize=this.initialStepSize||this.state.stepSize}ngOnChanges(e){let t=this.state.cropper(),o=this.state.transform,a=this.state.options.backgroundColor;if(this.state.setOptionsFromChanges(e),this.onChangesInputImage(e),e.transform&&this.transform&&(this.state.transform=this.transform,this.setCssTransform()),!this.state.loadedImage?.transformed.image.complete||!this.state.maxSize)return;if(this.containWithinAspectRatio&&e.aspectRatio||e.containWithinAspectRatio||e.canvasRotation){this.loadImageService.transformLoadedImage(this.state.loadedImage,this.state.options).then(u=>this.setLoadedImage(u)).catch(u=>this.loadImageError(u));return}e.cropper&&this.cropper&&this.state.cropper.set(ye(this.cropper,this.state,!0));let s=!this.state.equalsCropperPosition(t);s&&(!this.cropper||!this.state.equalsCropperPosition(this.cropper))&&this.cropperChange.emit(this.state.cropper()),(s||!this.state.equalsTransform(o)||this.state.options.backgroundColor!==a)&&this.doAutoCrop(),e.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesInputImage(e){(e.imageChangedEvent||e.imageURL||e.imageBase64||e.imageFile)&&this.reset(),e.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),e.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),e.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),e.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){let e=this.imageChangedEvent?.target?.files;return e instanceof FileList&&e.length>0}reset(){this.state.loadedImage=void 0,this.state.maxSize.set({width:0,height:0}),this.imageVisible=!1}loadImageFile(e){this.loadImageService.loadImageFile(e,this.state.options).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadBase64Image(e){this.loadImageService.loadBase64Image(e,this.state.options).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadImageFromURL(e){this.loadImageService.loadImageFromURL(e,this.state.options).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}setLoadedImage(e){this.state.loadedImage=e,this.safeImgDataUrl.set(this.sanitizer.bypassSecurityTrustResourceUrl(e.transformed.objectUrl))}loadImageError(e){console.error(e),this.loadImageFailed.emit()}setCssTransform(){let e=this.state.transform?.translateUnit||"%";this.safeTransformStyle.set(this.sanitizer.bypassSecurityTrustStyle(`translate(${this.state.transform.translateH||0}${e}, ${this.state.transform.translateV||0}${e}) scaleX(`+(this.state.transform.scale||1)*(this.state.transform.flipH?-1:1)+") scaleY("+(this.state.transform.scale||1)*(this.state.transform.flipV?-1:1)+") rotate("+(this.state.transform.rotate||0)+"deg)"))}imageLoadedInView(){this.state.loadedImage!=null&&(this.imageLoaded.emit(this.state.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.cropper&&(!this.maintainAspectRatio||this.state.aspectRatioIsCorrect())?(this.state.cropper.set(ye(this.cropper,this.state,!0)),this.emitCropperPositionChange(this.cropper)):(this.state.cropper.set(ye(this.state.maxSizeCropperPosition(),this.state,!0)),this.cropperChange.emit(this.state.cropper())),this.imageVisible=!0,this.cropperReady.emit(this.state.maxSize()),this.doAutoCrop()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>1}onResize(){if(this.state.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{let e=this.state.maxSize();this.setMaxSize(),this.state.resizeCropperPosition(e)}}keyboardAccess(e){this.changeKeyboardStepSize(e),this.keyboardMoveCropper(e)}changeKeyboardStepSize(e){let t=+e.key;t>=1&&t<=9&&(this.state.stepSize=t)}keyboardMoveCropper(e){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e.key))return;let o=e.shiftKey?Z.Resize:Z.Move,a=e.altKey?qi(e.key):ji(e.key),s=Qi(e.key,this.state.stepSize);e.preventDefault(),e.stopPropagation(),this.moveStart={type:o,position:a,clientX:0,clientY:0,transform:this.state.transform,cropper:this.state.cropper()},this.handleMouseMove(s),this.handleMouseUp()}startMove(e,t,o=null){this.disabled||this.moveStart&&this.moveStart.type===Z.Pinch||t===Z.Drag&&!this.allowMoveImage||("preventDefault"in e&&e.preventDefault(),this.moveStart={type:t,position:o,clientX:We(e),clientY:$e(e),transform:this.state.transform,cropper:this.state.cropper()},this.initMouseMove())}initMouseMove(){Qe(me(document,"mousemove"),me(document,"touchmove")).pipe(Ke(Qe(me(document,"mouseup"),me(document,"touchend"),this.pinchStart$).pipe(ct()))).subscribe({next:e=>this.handleMouseMove(e),complete:()=>this.handleMouseUp()})}handleMouseMove(e){if(this.moveStart){if("stopPropagation"in e&&e.stopPropagation(),"preventDefault"in e&&e.preventDefault(),this.moveStart.type===Z.Move)this.state.cropper.set(He(Li(e,this.moveStart),this.state,!0));else if(this.moveStart.type===Z.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.state.cropper.set(He(Ut(e,this.moveStart,this.state),this.state,!1));else if(this.moveStart.type===Z.Drag){let t=We(e)-this.moveStart.clientX,o=$e(e)-this.moveStart.clientY;this.state.transform=oe(A({},this.state.transform),{translateH:(this.moveStart.transform?.translateH||0)+t,translateV:(this.moveStart.transform?.translateV||0)+o}),this.setCssTransform()}}}handleMouseUp(){!this.moveStart||this.moveStart.type===Z.Pinch||((!this.state.equalsCropperPosition(this.moveStart.cropper)||this.moveStart.transform&&!this.state.equalsTransform(this.moveStart.transform))&&(this.moveStart.type===Z.Drag?this.transformChange.emit(this.state.transform):this.cropperChange.emit(this.state.cropper()),this.doAutoCrop()),this.moveStart=void 0)}startPinch(e){if(this.disabled||!this.sourceImageLoaded()||e.touches.length<2)return;"preventDefault"in e&&e.preventDefault();let t=this.state.cropper();this.moveStart={type:Z.Pinch,position:"center",clientX:t.x1+(t.x2-t.x1)/2,clientY:t.y1+(t.y2-t.y1)/2,cropper:t},this.initPinch()}initPinch(){this.pinchStart$.next(),me(document,"touchmove").pipe(Ke(me(document,"touchend"))).subscribe({next:e=>this.handlePinchMove(e),complete:()=>this.handlePinchStop()})}handlePinchMove(e){this.moveStart&&(e.preventDefault&&e.preventDefault(),this.moveStart.type===Z.Pinch&&!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.state.cropper.set(He(Ut(e,this.moveStart,this.state),this.state,!1)))}handlePinchStop(){this.moveStart&&(this.state.equalsCropperPosition(this.moveStart.cropper)||(this.emitCropperPositionChange(this.moveStart.cropper),this.doAutoCrop()),this.moveStart=void 0)}setMaxSize(){if(this.sourceImage){let e=getComputedStyle(this.sourceImage.nativeElement);this.state.setMaxSize(parseFloat(e.width),parseFloat(e.height)),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.state.maxSize().width/2+"px)")}}emitCropperPositionChange(e){this.state.equalsCropperPosition(e)||this.cropperChange.emit(this.state.cropper())}doAutoCrop(){this.state.options.autoCrop&&this.crop()}crop(e=this.state.options.output){if(this.state.loadedImage?.transformed?.image!=null){if(this.startCropImage.emit(),e==="blob")return this.cropToBlob();if(e==="base64")return this.cropToBase64()}return null}cropToBlob(){return new Promise((e,t)=>W(this,null,function*(){let o=yield this.cropService.crop(this.state.toCropInput(),"blob");o?(this.imageCropped.emit(o),e(o)):t("Crop image failed")}))}cropToBase64(){let e=this.cropService.crop(this.state.toCropInput(),"base64");return e?(this.imageCropped.emit(e),e):null}resetCropperPosition(){this.state.cropper.set(ye(this.state.maxSizeCropperPosition(),this.state,!0)),this.cropperChange.emit(this.state.cropper())}ngOnDestroy(){this.pinchStart$.complete()}};i.\u0275fac=function(t){return new(t||i)(ht(It))},i.\u0275cmp=y({type:i,selectors:[["image-cropper"]],viewQuery:function(t,o){if(t&1&&(R(Oi,7),R(Pi,5)),t&2){let a;O(a=P())&&(o.wrapper=a.first),O(a=P())&&(o.sourceImage=a.first)}},hostVars:6,hostBindings:function(t,o){t&1&&_("resize",function(){return o.onResize()},dt),t&2&&(fe("text-align",o.alignImageStyle),$("disabled",o.disabled)("ngx-ic-hidden",o.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",options:"options",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",autoCrop:"autoCrop",cropper:"cropper",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",checkImageType:"checkImageType",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange",cropperChange:"cropperChange"},features:[mt],decls:4,vars:10,consts:[["sourceImage",""],[3,"touchstart"],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,o){t&1&&(l(0,"div",1),_("touchstart",function(s){return o.startPinch(s)}),M(1,zi,2,8,"img",2),X(2,"div",3),M(3,Di,3,16,"div",4),c()),t&2&&(fe("background",o.imageVisible&&o.state.options.backgroundColor),m(),x("ngIf",o.safeImgDataUrl()),m(),fe("width",o.state.maxSize().width||0,"px")("height",o.state.maxSize().height||0,"px")("margin-left",o.state.options.alignImage==="center"?o.marginLeft:null),m(),x("ngIf",o.imageVisible))},dependencies:[St],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{display:inline;max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:var(--cropper-color, #53535C);background:transparent;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:var(--cropper-border, 1px solid rgba(255, 255, 255, .5))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:hover   .ngx-ic-move[_ngcontent-%COMP%]{border:var(--cropper-hover-border, var(--cropper-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border:var(--cropper-focus-border, 2px solid dodgerblue)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{background:var(--cropper-resize-square-focus-bg, var(--cropper-resize-square-bg, #53535C));border:var(--cropper-resize-square-focus-border, var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;width:6px;height:6px;box-sizing:content-box;background:var(--cropper-resize-square-bg, #53535C);border:var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]:hover   .ngx-ic-square[_ngcontent-%COMP%]{background:var(--cropper-resize-square-hover-bg, var(--cropper-resize-square-bg, #53535C));border:var(--cropper-resize-square-hover-border, var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ic-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0});let r=i;return r})();var Qt=(()=>{let i=class i{constructor(){this.maintainAspectRatio=!0,this.aspectRatio=1}imageCropped(e){this.croppedDataUrl=e.base64}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["app-file-cropper"]],decls:3,vars:5,consts:[["output","base64","format","png",3,"imageCropped","maintainAspectRatio","cropperStaticHeight","cropperStaticWidth","aspectRatio","imageBase64"],[1,"mt10",3,"click"]],template:function(t,o){t&1&&(l(0,"image-cropper",0),_("imageCropped",function(s){return o.imageCropped(s)}),c(),l(1,"wbutton",1),_("click",function(){return o.uploadImage(o.croppedDataUrl),o.close()}),v(2,` Crop
`),c()),t&2&&x("maintainAspectRatio",o.maintainAspectRatio)("cropperStaticHeight",o.height)("cropperStaticWidth",o.width)("aspectRatio",o.aspectRatio)("imageBase64",o.dataUrl)},dependencies:[qt,pe],encapsulation:2});let r=i;return r})();var Ki=(r,i)=>({$implicit:r,index:i});function Xi(r,i){if(r&1&&(l(0,"div",4),v(1),D(2,"translate"),c()),r&2){p();let n=C(0);m(),Q(N(2,1,n)())}}function Yi(r,i){if(r&1&&(l(0,"div",13),v(1),D(2,"translate"),c()),r&2){p(2);let n=C(1);m(),Q(N(2,1,n)())}}function Ji(r,i){if(r&1&&(re(0,12),M(1,Yi,3,3,"ng-template",null,1,F)),r&2){let n=ae(2),e=p();x("ngTemplateOutlet",e.t_empty()||n)}}function Gi(r,i){if(r&1&&X(0,"img",17),r&2){let n=p().$implicit;x("src",n,Re)}}function Zi(r,i){if(r&1){let n=b();l(0,"span",16),v(1),c(),S(2,Gi,1,1,"img",17),l(3,"button",18),_("click",function(){let t=d(n).index,o=p(3);return h(o.removeAt(t))}),v(4," close "),c()}if(r&2){let n=i.$implicit,e=p(3);m(),Q(n),m(),I(e.preview()&&e.isImage(n)?2:-1)}}function en(r,i){if(r&1&&(l(0,"li",14),re(1,15),M(2,Zi,5,2,"ng-template",null,2,F),c()),r&2){let n=i.$implicit,e=i.$index,t=ae(3),o=p(2);m(),x("ngTemplateOutlet",o.t_item()||t)("ngTemplateOutletContext",bt(2,Ki,n,e))}}function tn(r,i){if(r&1&&(l(0,"ul"),Y(1,en,4,5,"li",14,ge),c()),r&2){p();let n=C(2);m(),J(n)}}function nn(r,i){if(r&1){let n=b();l(0,"button",19),_("click",function(){d(n);let t=p();return h(t.clear())}),l(1,"span",10),v(2,"close"),c(),l(3,"span"),v(4),D(5,"translate"),c()()}if(r&2){p();let n=C(3);x("disabled",n),m(4),Q(N(5,2,"Clear")())}}var Kt=(()=>{let i=class i{constructor(){this.label=g(""),this.placeholder=g("Select file"),this.disabled=g(!1),this.clearable=g(!0),this.accept=g("*/*"),this.multiple=g(!1),this.preview=g(!0),this.cropWidth=g(null),this.cropHeight=g(null),this.t_item=g(),this.t_empty=g(),this.formId=g(null),this.formKey=g(null),this.container=g("general"),this.name=g(""),this.wModel=De(null,{alias:"wModel"}),this.wChange=L(),this._vf=w(ie),this._modal=w(Ae),this._fs=w($t),this._onChange=()=>{},this._onTouched=()=>{},this._disabledCva=!1,this.isDisabled=te(()=>this.disabled()||this._disabledCva),this.files=te(()=>{let t=this.wModel();return Array.isArray(t)?t:t?[t]:[]});let e=!1;U(()=>{let t=this.formId(),o=this.formKey();if(!t||!o)return;this._vf.registerField(t,o,null,[]);let a=this._vf.getValues(t)[o]??null;!e&&!this._equal(a,this.wModel())&&(e=!0,this.wModel.set(a),e=!1)}),U(()=>{let t=this.formId(),o=this.formKey();if(!t||!o)return;let a=this.wModel();this._equal(this._vf.getValues(t)[o],a)||this._vf.setValue(t,o,a??null)}),U(()=>{let t=this.wModel();this._onChange(t),this.wChange.emit(t)})}triggerPick(e){this.isDisabled()||e.click()}isImage(e){return/\.(png|jpe?g|webp|gif)(\?|$)/i.test(e??"")}onPicked(e){return W(this,null,function*(){let t=e.files;if(!t||!t.length)return;let o=!!(this.cropWidth()&&this.cropHeight()),a=[],s=this.container(),u=this.name();for(let T=0;T<t.length;T++){let j=t.item(T),q=yield on(j);if(o)yield new Promise(K=>{this._modal.show({component:Qt,dataUrl:q,width:this.cropWidth(),height:this.cropHeight(),uploadImage:ee=>{this._fs.uploadBase64(ee,s,u).then(se=>{a.push(se),K()})}})});else{let K=yield this._fs.uploadBase64(q,s,u);a.push(K)}}let f=this.multiple()?[...this.files(),...a]:a[0]??null;this.wModel.set(f),e.value="",this._onTouched()})}removeAt(e){if(!this.multiple()){this.wModel.set(null);return}let t=[...this.files()];t.splice(e,1),this.wModel.set(t.length?t:[])}clear(){this.wModel.set(this.multiple()?[]:null)}writeValue(e){this._equal(this.wModel(),e)||this.wModel.set(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._disabledCva=e}_equal(e,t){return Array.isArray(e)||Array.isArray(t)?JSON.stringify(e)===JSON.stringify(t):e===t}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ngx-file"]],inputs:{label:[1,"label"],placeholder:[1,"placeholder"],disabled:[1,"disabled"],clearable:[1,"clearable"],accept:[1,"accept"],multiple:[1,"multiple"],preview:[1,"preview"],cropWidth:[1,"cropWidth"],cropHeight:[1,"cropHeight"],t_item:[1,"t_item"],t_empty:[1,"t_empty"],formId:[1,"formId"],formKey:[1,"formKey"],container:[1,"container"],name:[1,"name"],wModel:[1,"wModel"]},outputs:{wModel:"wModelChange",wChange:"wChange"},features:[ze([{provide:Ee,useExisting:Fe(()=>i),multi:!0}])],decls:20,vars:15,consts:[["fileInput",""],["emptyTpl",""],["itemTpl",""],[1,"wfile"],[1,"wfile__label"],[1,"wfile__body"],[1,"wfile__list"],[1,"wfile__actions"],["type","file","hidden","",3,"change"],["type","button",1,"wfile__btn",3,"click","disabled"],[1,"material-icons"],["type","button",1,"wfile__btn","wfile__btn--ghost",3,"disabled"],[3,"ngTemplateOutlet"],[1,"wfile__empty"],[1,"wfile__item"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"wfile__name"],["alt","preview",1,"wfile__thumb",3,"src"],["type","button",1,"wfile__remove","material-icons",3,"click"],["type","button",1,"wfile__btn","wfile__btn--ghost",3,"click","disabled"]],template:function(t,o){if(t&1){let a=b();le(0)(1)(2)(3),l(4,"div",3),S(5,Xi,3,3,"div",4),l(6,"div",5)(7,"div",6),S(8,Ji,3,1)(9,tn,3,0,"ul"),c(),l(10,"div",7)(11,"input",8,0),_("change",function(){d(a);let u=ae(12);return h(o.onPicked(u))}),c(),l(13,"button",9),_("click",function(){d(a);let u=ae(12);return h(o.triggerPick(u))}),l(14,"span",10),v(15,"upload_file"),c(),l(16,"span"),v(17),D(18,"translate"),c()(),S(19,nn,6,4,"button",11),c()()()}if(t&2){let a=z(o.label());m(),z(o.placeholder()),m();let s=z(o.files());m();let u=z(o.isDisabled());m(),$("_disabled",u),m(),I(a?5:-1),m(3),I(s.length===0?8:9),m(3),be("accept",o.accept())("multiple",o.multiple()?"":null),m(2),x("disabled",u),m(4),Q(N(18,13,"Browse")()),m(2),I(o.clearable()&&s.length?19:-1)}},dependencies:[xe,we],styles:["[_nghost-%COMP%]{display:block}.wfile._disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.wfile__label[_ngcontent-%COMP%]{margin-bottom:6px}.wfile__body[_ngcontent-%COMP%]{border:2px solid var(--c-text-primary);border-radius:12px;padding:12px;background:var(--c-bg-secondary);color:var(--c-text-primary)}.wfile__list[_ngcontent-%COMP%]{margin-bottom:10px}.wfile__list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}.wfile__empty[_ngcontent-%COMP%]{color:var(--c-text-primary);opacity:.8}.wfile__item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:6px 0;border-bottom:1px solid var(--c-border)}.wfile__item[_ngcontent-%COMP%]:last-child{border-bottom:0}.wfile__name[_ngcontent-%COMP%]{max-width:50%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.wfile__thumb[_ngcontent-%COMP%]{width:64px;height:64px;object-fit:cover;border-radius:8px;border:1px solid var(--c-border)}.wfile__remove[_ngcontent-%COMP%]{border:0;background:transparent;cursor:pointer;color:var(--c-text-primary);display:inline-flex;align-items:center;justify-content:center;border-radius:8px;padding:4px}.wfile__actions[_ngcontent-%COMP%]{display:flex;gap:8px}.wfile__btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:8px 12px;border-radius:10px;border:2px solid var(--c-primary);background:var(--c-primary);color:var(--c-white);cursor:pointer}.wfile__btn--ghost[_ngcontent-%COMP%]{background:transparent;color:var(--c-primary)}"],changeDetection:0});let r=i;return r})();function on(r){return new Promise((i,n)=>{let e=new FileReader;e.onload=()=>i(e.result),e.onerror=n,e.readAsDataURL(r)})}var rn=["templateRef"];function an(r,i){if(r&1){let n=b();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("name",(n.props==null?null:n.props.Label)||"boolean")("focused",n.component.focused)("ngClass",n.component.class)}}var Xt=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Boolean",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(rn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","checkbox",3,"wChange","formId","formKey","label","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,an,1,6,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var sn=["templateRef"];function ln(r,i){if(r&1){let n=b();l(0,"wbutton",1),_("click",function(){let t=d(n).$implicit;return p().invoke(t.props==null?null:t.props.Click),h(t.wClick())}),v(1),c()}if(r&2){let n=i.$implicit;x("disableSubmit",!0),m(),G(" ",n.props==null?null:n.props.Label," ")}}var Yt=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Button",this.templateRef)}invoke(e){typeof e=="function"&&e()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(sn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[3,"click","disableSubmit"]],template:function(t,o){t&1&&M(0,ln,2,2,"ng-template",null,0,F)},dependencies:[pe],encapsulation:2,changeDetection:0});let r=i;return r})();var cn=["templateRef"];function pn(r,i){if(r&1){let n=b();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("label",(n.props==null?null:n.props.Label)||"Code")("placeholder",(n.props==null?null:n.props.Placeholder)||"{ ... }")("name",(n.props==null?null:n.props.Label)||"code")("focused",n.component.focused)("ngClass",n.component.class)}}var Jt=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Code",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["w-form-code"]],viewQuery:function(t,o){if(t&1&&R(cn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","textarea",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,pn,1,7,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var mn=["templateRef"];function dn(r,i){if(r&1){let n=b();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"date")("focused",n.component.focused)("ngClass",n.component.class)}}var Gt=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Date",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(mn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","date",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,dn,1,7,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var hn=["templateRef"];function un(r,i){if(r&1){let n=b();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())})("wSubmit",function(){let t=d(n).$implicit;return h(t.wSubmit())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"email")("focused",n.component.focused)("ngClass",n.component.class)}}var Zt=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Email",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(hn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","email",3,"wChange","wSubmit","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,un,1,7,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var _n=["templateRef"];function gn(r,i){if(r&1){let n=b();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("label",(n.props==null?null:n.props.Label)||"HTML")("placeholder",(n.props==null?null:n.props.Placeholder)||"<p>...</p>")("name",(n.props==null?null:n.props.Label)||"html")("focused",n.component.focused)("ngClass",n.component.class)}}var ei=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Html",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["w-form-html"]],viewQuery:function(t,o){if(t&1&&R(_n,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","textarea",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,gn,1,7,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var fn=["templateRef"];function Cn(r,i){if(r&1){let n=b();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"number")("focused",n.component.focused)("ngClass",n.component.class)}}var ti=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Number",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(fn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","number",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,Cn,1,7,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var xn=["templateRef"];function wn(r,i){if(r&1){let n=b();l(0,"div",1)(1,"winput",2),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())})("wSubmit",function(){let t=d(n).$implicit;return h(t.wSubmit())}),c(),l(2,"div",3)(3,"span",4),_("click",function(){let t=d(n).$implicit;return h(t.props&&(t.props.Show=!t.props.Show))}),v(4," visibility "),c()()()}if(r&2){let n=i.$implicit;m(),x("formId",n.wFormId)("formKey",n.wFormKey)("type",n.props!=null&&n.props.Show?"text":"password")("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"password")("focused",n.component.focused)("ngClass",n.component.class)}}var ii=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Password",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(xn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[1,"pass_container"],[3,"wChange","wSubmit","formId","formKey","type","label","placeholder","name","focused","ngClass"],[1,"eye"],[1,"material-icons",3,"click"]],template:function(t,o){t&1&&M(0,wn,5,8,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var bn=["templateRef"];function vn(r,i){if(r&1){let n=b();l(0,"ngx-file",1),_("wChange",function(){let t=d(n).$implicit;return h((t==null?null:t.wChange)&&t.wChange())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("label",(n.props==null?null:n.props.Label)||"Photo")("accept",(n.props==null?null:n.props.Accept)||"image/*")("container",(n.props==null?null:n.props.Container)||n.wFormId)("name",(n.props==null?null:n.props.Name)||"")("multiple",!!(n.props!=null&&n.props.Multiple))("preview",(n.props==null?null:n.props.Preview)??!0)("clearable",(n.props==null?null:n.props.Clearable)??!0)("cropWidth",(n.props==null?null:n.props.Width)||null)("cropHeight",(n.props==null?null:n.props.Height)||null)}}var ni=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Photo",this.templateRef),this._form.addTemplateComponent("Photos",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(bn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[3,"wChange","formId","formKey","label","accept","container","name","multiple","preview","clearable","cropWidth","cropHeight"]],template:function(t,o){t&1&&M(0,vn,1,11,"ng-template",null,0,F)},dependencies:[Kt],encapsulation:2,changeDetection:0});let r=i;return r})();var yn=()=>[],Mn=r=>({item:r}),Sn=(r,i)=>i.icon||i.text,In=(r,i)=>i().id;function Tn(r,i){if(r&1&&(l(0,"div",4),v(1),D(2,"translate"),c()),r&2){p();let n=C(1);m(),Q(N(2,1,n)())}}function Fn(r,i){if(r&1&&(l(0,"div"),v(1),D(2,"translate"),c()),r&2){p(3);let n=C(0);m(),Q(N(2,1,n)())}}function Vn(r,i){r&1&&(l(0,"span"),v(1,", "),c())}function Rn(r,i){if(r&1){let n=b();l(0,"span"),v(1),D(2,"translate"),l(3,"i",14),_("click",function(){d(n);let t=p().$index,o=p(3);return h(o.removeItem(t))}),v(4,"close"),c()()}if(r&2){let n=p().$implicit,e=p(3);m(),G(" ",N(2,1,e.allItem[n])()," ")}}function On(r,i){if(r&1&&(l(0,"span"),S(1,Vn,2,0,"span"),S(2,Rn,5,3,"span"),c()),r&2){let n=i.$implicit,e=i.$index,t=p(3);m(),I(e&&t.allItem[n]?1:-1),m(),I(t.allItem[n]?2:-1)}}function Pn(r,i){if(r&1&&(l(0,"div",13),S(1,Fn,3,3,"div"),Y(2,On,3,2,"span",null,ge),c()),r&2){p(2);let n=C(3);m(),I(n.length?-1:1),m(),J(n)}}function zn(r,i){if(r&1&&(l(0,"div",13),v(1),D(2,"translate"),c()),r&2){let n=p(2),e=C(0),t=C(4);m(),G(" ",N(2,1,t?n.allItem[t]:e)()," ")}}function kn(r,i){if(r&1&&(l(0,"div",12),S(1,Pn,4,1,"div",13)(2,zn,3,3,"div",13),c()),r&2){p();let n=C(2);m(),I(n?1:2)}}function Dn(r,i){if(r&1){let n=b();l(0,"div",10),_("click",function(){d(n);let t=p();return h(t.clear())}),v(1,"close"),c()}}function En(r,i){if(r&1){let n=b();l(0,"i",15),_("click",function(){d(n);let t=p().$implicit;return h(t.click())}),v(1),c()}if(r&2){let n=p().$implicit;m(),Q(n.icon)}}function Ln(r,i){if(r&1){let n=b();l(0,"span",16),_("click",function(){d(n);let t=p().$implicit;return h(t.click())}),v(1),c()}if(r&2){let n=p().$implicit;m(),Q(n.text)}}function An(r,i){if(r&1&&S(0,En,2,1,"i",7)(1,Ln,2,1,"span"),r&2){let n=i.$implicit;I(n.icon?0:n.text?1:-1)}}function Nn(r,i){if(r&1){let n=b();l(0,"winput",21),D(1,"translate"),_("wChange",function(t){d(n);let o=p(3);return h(o.search.set((t??"")+""))}),c()}r&2&&x("placeholder",wt(N(1,3,"Enter search text...")()))("focused",!0)}function Bn(r,i){if(r&1&&(l(0,"div"),re(1,8),M(2,Nn,2,5,"ng-template",null,2,F),c()),r&2){let n=ae(3),e=p(2);m(),x("ngTemplateOutlet",e.t_search()?e.t_search():n)}}function Hn(r,i){if(r&1&&re(0,19),r&2){let n=i.$implicit;p();let e=ae(9),t=p();x("ngTemplateOutlet",t.t_item()?t.t_item():e)("ngTemplateOutletContext",ke(2,Mn,n))}}function Wn(r,i){r&1&&(l(0,"div",20),v(1," Nothing was found "),c())}function $n(r,i){if(r&1&&(v(0),D(1,"translate")),r&2){let n=p().item,e=p(2);G(" ",N(1,1,n()[e.bindLabel()])()," ")}}function Un(r,i){r&1&&(v(0),D(1,"translate")),r&2&&G(" ",N(1,1,"Unknown item")()," ")}function jn(r,i){if(r&1){let n=b();l(0,"div",22),_("click",function(){let t=d(n).item,o=p(2);return h(o.selectOption(t()))}),l(1,"div",23),S(2,$n,2,3)(3,Un,2,3),c()()}if(r&2){let n=i.item,e=p(2),t=C(2),o=C(3),a=n().id;m(),$("selected",t?o.includes(a):!1),m(),I(n()[e.bindLabel()]?2:3)}}function qn(r,i){if(r&1&&(l(0,"div",17),S(1,Bn,4,1,"div"),l(2,"div",18),Y(3,Hn,1,4,"ng-container",19,In),D(5,"search"),S(6,Wn,2,0,"div",20),D(7,"search"),c(),M(8,jn,4,3,"ng-template",null,1,F),c()),r&2){let n;p();let e=C(5),t=C(6),o=C(7),a=C(8);$("_search",e),m(),I(e?1:-1),m(2),J(Ye(5,4,t,a,o+" __search")),m(3),I((n=Ye(7,8,t,a,o+" __search"))!=null&&n.length?-1:6)}}var oi=(()=>{let i=class i{constructor(){this.disabled=g(!1),this.clearable=g(!1),this.placeholder=g(""),this.multiple=g(!1),this.bindLabel=g("name"),this.bindValue=g("_id"),this.label=g(""),this.searchable=g(!1),this.searchableBy=g("name"),this.items=g([]),this.buttons=g([]),this.t_view=g(),this.t_item=g(),this.t_search=g(),this.formId=g(null),this.formKey=g(null),this.wModel=De(null,{alias:"wModel"}),this.wChange=L(),this._core=w(ce),this._vform=w(ie),this.allItem={},this.allItems=V(this._core.toSignalsArray([])),this.showOptions=V(!1),this.search=V(""),this.isMulti=te(()=>this.multiple()),this._disabledCva=!1,this.isDisabled=te(()=>this.disabled()||this._disabledCva),this.selectedIds=te(()=>{let t=this.wModel();return this.isMulti()?Array.isArray(t)?t:[]:t==null?[]:[t]}),this.selectedId=te(()=>this.selectedIds()[0]??null),this._onChange=()=>{},this._onTouched=()=>{},U(()=>{let t=this.items();this.allItems.update(()=>t.map(s=>{let u={name:typeof s=="object"?s[this.bindLabel()]:s,id:typeof s=="object"?s[this.bindValue()]:s};return this.allItem[u.id]=u.name,this._core.toSignal(u)}));let o=new Set(this.allItems().map(s=>s().id)),a=this.wModel();if(this.isMulti()){let s=(Array.isArray(a)?a:[]).filter(u=>o.has(u));JSON.stringify(s)!==JSON.stringify(a)&&this.wModel.set(s)}else a!=null&&!o.has(a)&&this.wModel.set(null)});let e=!1;U(()=>{let t=this.formId(),o=this.formKey();if(!t||!o)return;this._vform.registerField(t,o,null,[]);let a=this._vform.getValues(t)[o]??null;!e&&!this._equal(a,this.wModel())&&(e=!0,this.wModel.set(a),e=!1)}),U(()=>{let t=this.formId(),o=this.formKey();if(!t||!o)return;let a=this.wModel();!e&&!this._equal(this._vform.getValues(t)[o],a)&&(e=!0,this._vform.setValue(t,o,a??null),e=!1)}),U(()=>{let t=this.wModel();this._onChange(t),this.wChange.emit(t)})}toggleOptions(e=!this.showOptions()){this.isDisabled()||this.showOptions.set(e)}selectOption(e){if(this.isMulti()){let t=new Set(this.selectedIds());t.has(e.id)?t.delete(e.id):t.add(e.id),this.wModel.set([...t])}else this.wModel.set(e.id),this.showOptions.set(!1);this._onTouched()}removeItem(e){if(!this.isMulti())return;let t=[...this.selectedIds()];t.splice(e,1),this.wModel.set(t)}clear(){this.wModel.set(this.isMulti()?[]:null)}writeValue(e){this._equal(this.wModel(),e)||this.wModel.set(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._disabledCva=e}_equal(e,t){return Array.isArray(e)||Array.isArray(t)?JSON.stringify(e)===JSON.stringify(t):e===t}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["wselect"]],inputs:{disabled:[1,"disabled"],clearable:[1,"clearable"],placeholder:[1,"placeholder"],multiple:[1,"multiple"],bindLabel:[1,"bindLabel"],bindValue:[1,"bindValue"],label:[1,"label"],searchable:[1,"searchable"],searchableBy:[1,"searchableBy"],items:[1,"items"],buttons:[1,"buttons"],t_view:[1,"t_view"],t_item:[1,"t_item"],t_search:[1,"t_search"],formId:[1,"formId"],formKey:[1,"formKey"],wModel:[1,"wModel"]},outputs:{wModel:"wModelChange",wChange:"wChange"},features:[ze([{provide:Ee,useExisting:Fe(()=>i),multi:!0}])],decls:24,vars:20,consts:[["defaultView",""],["defaultItem",""],["defaultSearch",""],[1,"wselect",3,"clickOutside"],[1,"wselect__label"],[1,"wselect__body"],[1,"wselect__header",3,"click"],[1,"material-icons"],[3,"ngTemplateOutlet"],[1,"wselect__arrow","material-icons"],[1,"wselect__arrow","material-icons",3,"click"],[1,"wselect__popup",3,"_search"],[1,"wselect__text"],[1,"text-overflow"],[1,"material-icons","avatar__icon",3,"click"],[1,"material-icons",3,"click"],[3,"click"],[1,"wselect__popup"],[1,"popup-block"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["translate","",1,"popup-block__empty-search"],[3,"wChange","placeholder","focused"],[1,"item",3,"click"],[1,"item__text"]],template:function(t,o){if(t&1){let a=b();le(0)(1)(2)(3)(4)(5)(6)(7)(8),l(9,"div",3),_("clickOutside",function(){return d(a),h(o.toggleOptions(!1))}),S(10,Tn,3,3,"div",4),l(11,"div",5)(12,"div",6),_("click",function(){return d(a),h(o.toggleOptions())}),l(13,"span",7),v(14,"unfold_more"),c(),re(15,8),M(16,kn,3,1,"ng-template",null,0,F),c(),S(18,Dn,2,0,"div",9),l(19,"div",10),_("click",function(){return d(a),h(o.toggleOptions())}),v(20," expand_more "),c(),Y(21,An,2,1,null,null,Sn),S(23,qn,10,12,"div",11),c()()}if(t&2){let a=ae(17),s=o.showOptions();z(o.placeholder()),m();let u=z(o.label());m();let f=z(o.isMulti());m();let T=z(o.selectedIds());m();let j=z(o.selectedId());m(),z(o.searchable()),m(),z(o.allItems()),m(),z(o.searchableBy()),m(),z(o.search()),m(2),I(u?10:-1),m(),$("_disabled",o.isDisabled())("_active",s),m(4),x("ngTemplateOutlet",o.t_view()?o.t_view():a),m(3),I(o.clearable()&&(f?T.length:j)?18:-1),m(),$("_active",s),m(2),J(o.buttons()||ve(19,yn)),m(2),I(s?23:-1)}},dependencies:[xe,Ht,H,kt,Dt,we],styles:["[_nghost-%COMP%]{display:block}._disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.wselect[_ngcontent-%COMP%]{width:100%}.wselect__label[_ngcontent-%COMP%]{margin-bottom:5px}.wselect__body[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:flex;min-height:50px;height:50px;align-items:center;border:2px solid var(--c-text-primary);border-radius:12px;transition:var(--transition)}.wselect__body._active[_ngcontent-%COMP%]{border-color:var(--c-primary)}.wselect__header[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;overflow:hidden;white-space:nowrap;position:relative}.wselect__text[_ngcontent-%COMP%]{margin-right:10px;flex-grow:1;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.wselect__text[_ngcontent-%COMP%]   .text-overflow[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;word-break:keep-all;color:var(--c-text-primary)}.wselect__arrow[_ngcontent-%COMP%]{margin-right:15px;transition:var(--transition);display:flex;align-items:center;justify-content:center;border-radius:50%}.wselect__arrow._active[_ngcontent-%COMP%]{transform:rotate(180deg)}.wselect[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:var(--c-text-primary)}.wselect[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding:10px;transition:var(--transition);border-bottom:1px solid var(--c-text-primary)}.wselect[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{background:var(--c-shadow);border-bottom:1px solid var(--c-primary);color:var(--c-primary)}.wselect__popup[_ngcontent-%COMP%]{z-index:9;width:100%;left:0;position:absolute;top:calc(100% + 10px);background:var(--c-white);box-shadow:0 0 4px var(--c-border);border-radius:10px;border:2px solid var(--c-primary);background:var(--c-bg-secondary);color:var(--c-text-primary);padding-bottom:15px;padding-top:15px}.wselect__popup._search[_ngcontent-%COMP%]{padding-top:60px}.wselect__popup[_ngcontent-%COMP%]   .popup-block[_ngcontent-%COMP%]{max-height:180px;overflow-y:auto;padding:0 15px;margin-right:10px}.wselect__popup[_ngcontent-%COMP%]   .popup-block__empty-search[_ngcontent-%COMP%]{padding:15px;text-align:center;color:var(--c-text-primary)}.wselect__search[_ngcontent-%COMP%]{top:10px;position:absolute;display:flex;justify-content:center;align-items:center;width:100%;left:0;padding:0 15px}.wselect[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px;height:5px;background-color:var(--c-white)}.wselect[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:0;background-color:var(--c-border)}.selected[_ngcontent-%COMP%]{font-weight:700}"],changeDetection:0});let r=i;return r})();var Qn=["templateRef"];function Kn(r,i){if(r&1){let n=b();l(0,"wselect",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("multiple",(n.props==null?null:n.props.Multiple)||!1)("placeholder",n.props==null?null:n.props.Placeholder)("bindValue",(n.props==null?null:n.props.Value)||"_id")("bindLabel",(n.props==null?null:n.props.Name)||"name")("ngClass",n.component.class)("items",n.props==null?null:n.props.Items)("searchable",!0)}}var ri=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Select",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(Qn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[3,"wChange","formId","formKey","multiple","placeholder","bindValue","bindLabel","ngClass","items","searchable"]],template:function(t,o){t&1&&M(0,Kn,1,9,"ng-template",null,0,F)},dependencies:[oi,B],encapsulation:2});let r=i;return r})();var Xn=["templateRef"];function Yn(r,i){if(r&1){let n=b();l(0,"div",1)(1,"winput",2),_("wChange",function(t){let o=d(n).$implicit;return h(o.props.__name=t)})("wSubmit",function(){let t=d(n).$implicit,o=p();return h(o.addTag(t))}),c(),X(2,"div",3),l(3,"wbutton",4),_("click",function(){let t=d(n).$implicit,o=p();return h(o.addTag(t))}),v(4),c()()}if(r&2){let n=i.$implicit;m(),x("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder),m(2),x("disableSubmit",!0),m(),G(" ",(n.props==null?null:n.props.Button)||"Add"," ")}}var ai=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Tags",this.templateRef)}addTag(e){let t=e.props?.__name;t&&(Array.isArray(e.props.__buffer)&&e.props.__buffer.push(t),e.props.__name="",setTimeout(()=>e.wChange()))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(Xn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[1,"tags"],[3,"wChange","wSubmit","label","placeholder"],[1,"tags__list"],[3,"click","disableSubmit"]],template:function(t,o){t&1&&M(0,Yn,5,4,"ng-template",null,0,F)},dependencies:[H,pe],encapsulation:2});let r=i;return r})();var Jn=["templateRef"];function Gn(r,i){if(r&1){let n=b();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())})("wSubmit",function(){let t=d(n).$implicit;return h(t.wSubmit())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("type",n.props!=null&&n.props.Textarea?"textarea":"text")("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"name")("focused",n.component.focused)("ngClass",n.component.class)}}var si=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Text",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(Jn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[3,"wChange","wSubmit","formId","formKey","type","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,Gn,1,8,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var Zn=["templateRef"];function eo(r,i){if(r&1){let n=b();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),c()}if(r&2){let n=i.$implicit;x("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"time")("focused",n.component.focused)("ngClass",n.component.class)}}var li=(()=>{let i=class i{constructor(){this._form=w(k)}ngOnInit(){this._form.addTemplateComponent("Time",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&R(Zn,7),t&2){let a;O(a=P())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","time",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,eo,1,7,"ng-template",null,0,F)},dependencies:[H,B],encapsulation:2});let r=i;return r})();var ci={Email:Zt,Boolean:Xt,Button:Yt,Code:Jt,Date:Gt,Html:ei,Number:ti,Password:ii,Photo:ni,Select:ri,Tags:ai,Text:si,Time:li};var to=()=>[],io=()=>({}),no=(r,i,n,e,t,o,a,s)=>({props:r,config:i,component:n,wFormId:e,wFormKey:t,wSubmit:o,wChange:a,wClick:s}),oo=r=>({$implicit:r}),ro=(r,i)=>i.key??r;function ao(r,i){if(r&1){let n=b();l(0,"form-component",3),_("wSubmit",function(){d(n);let t=p(3);return h(t.wSubmit.emit(t.submition()))})("wChange",function(){d(n);let t=p(3);return h(t.wChange.emit())})("wClick",function(){d(n);let t=p(3);return h(t.wClick.emit())}),c()}if(r&2){let n=p(),e=n.$implicit,t=n.$index,o=p(2);Ce(Pe("wformc__item ",o.formId()," ",o.formId()+"_"+o.index()+"_"+t," ",e.class||"")),x("formId",o.formId())("component",e)("config",o.config())("submition",o.submition())("index",o.index()+"_"+t)}}function so(r,i){if(r&1&&S(0,ao,1,10,"form-component",2),r&2){let n=i.$implicit;I(n.hidden?-1:0)}}function lo(r,i){if(r&1&&(l(0,"div"),Y(1,so,1,1,null,null,ro),c()),r&2){let n=p();Ce(Oe("wformc ",n.component().class||"")),m(),J(n.component().components??ve(3,to))}}function co(r,i){r&1&&re(0)}function po(r,i){if(r&1&&(l(0,"div",1),M(1,co,1,0,"ng-container",4),c()),r&2){let n=p();m(),x("ngTemplateOutlet",n.template())("ngTemplateOutletContext",ke(12,oo,vt(3,no,n.component().props||ve(2,io),n.config(),n.component(),n.formId(),n.effectiveKey(),n.submit.bind(n),n.change.bind(n),n.click.bind(n))))}}var pi=(()=>{let i=class i{constructor(){this._form=w(k),this.index=g(""),this.formId=g(""),this.config=g.required(),this.component=g.required(),this.submition=g({}),this.wSubmit=L(),this.wChange=L(),this.wClick=L(),this.template=V(null),U(()=>{this._form.templatesVersion();let e=this.component().name;this.template.set(e?this._form.getTemplateComponent(e):null)})}hasChildren(){return Array.isArray(this.component().components)}effectiveKey(){let e=this.component().key;if(!e)return null;if(!e.includes("[]"))return e;let t=(this.index()||"").split("_").pop()||"0",o=Number.isFinite(+t)?+t:0;return e.replace(/\[\]/g,`[${o}]`)}submit(){this.wSubmit.emit(this.submition())}change(){this.wChange.emit()}click(){this.wClick.emit()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["form-component"]],inputs:{index:[1,"index"],formId:[1,"formId"],config:[1,"config"],component:[1,"component"],submition:[1,"submition"]},outputs:{wSubmit:"wSubmit",wChange:"wChange",wClick:"wClick"},decls:2,vars:1,consts:[[3,"class"],[1,"wformc"],[3,"class","formId","component","config","submition","index"],[3,"wSubmit","wChange","wClick","formId","component","config","submition","index"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,o){t&1&&S(0,lo,3,4,"div",0)(1,po,2,14,"div",1),t&2&&I(o.hasChildren()?0:o.component().name&&o.template()?1:-1)},dependencies:[i,xe],styles:["[_nghost-%COMP%]{display:block;position:relative}.wformc[_ngcontent-%COMP%]{position:relative;padding:0}.wformc__item[_ngcontent-%COMP%]{display:block;margin:0 0 10px}"],changeDetection:0});let r=i;return r})();var mo=(r,i)=>i.key??r;function ho(r,i){if(r&1&&(l(0,"h1",0),v(1),c()),r&2){p();let n=C(0);m(),Q(n.title)}}function uo(r,i){if(r&1){let n=b();l(0,"form-component",3),_("wSubmit",function(){d(n);let t=p();return h(t.onSubmit())})("wChange",function(){d(n);let t=p();return h(t.onLegacyChange())})("wClick",function(){d(n);let t=p();return h(t.onClick())}),c()}if(r&2){let n=i.$implicit,e=i.$index,t=p(),o=C(0),a=C(1);Ce(Pe("wform__component ",t._formId()," ",t._formId()+"_"+e," ",n.class||"")),x("formId",t._formId())("component",n)("config",o)("submition",a)("index",""+e)}}var Ue=(()=>{let i=class i{constructor(){this._core=w(ce),this._virtualFormService=w(ie),this._ei=w(Ve),this.config=g.required(),this.submition=g({}),this.wChange=L(),this.wSubmit=L(),this._formId=V(""),this.components=te(()=>this.config()?.components??[]),this.visibleComponents=te(()=>this.components().filter(e=>!e?.hidden)),this._unsubFns=[]}ngOnInit(){let e=this.config(),o=e?.formId||this._formId()||crypto.randomUUID();this._formId.set(o),this._virtualFormService.getForm(o),(e?.components||[]).forEach(u=>this._registerFromSchema(o,u));let a=this.submition();a&&Object.keys(a).length&&this._virtualFormService.patch(o,a),this._clearHandlers(),this._virtualFormService.setHandler(o,"onValidSubmit",u=>this.wSubmit.emit(u)),this._virtualFormService.setHandler(o,"onInvalidSubmit",(u,f)=>this._emitLegacyChange(f)),this._virtualFormService.setHandler(o,"onPatch",()=>{this._emitLegacyChange(this._virtualFormService.getValues(o))});let s=()=>{this._core.afterWhile(this,()=>{this._emitLegacyChange(this._virtualFormService.getValues(o))})};this._virtualFormService.addListener(o,"onFieldChange",s),this._unsubFns.push(()=>this._virtualFormService.removeListener(o,"onFieldChange",s))}ngAfterViewInit(){this._stop=_e(this._ei,()=>U(()=>{let t=this.config()?.formId||this._formId();!t||t===this._formId()||(this._destroyForm(),this._formId.set(t),this.ngOnInit())}))}ngOnDestroy(){this._stop?.destroy(),this._destroyForm()}onSubmit(){let e=this._formId();this._virtualFormService.submit(e)}onLegacyChange(){let e=this._formId();this._core.afterWhile(this,()=>{this._emitLegacyChange(this._virtualFormService.getValues(e))})}onClick(){}_emitLegacyChange(e){this.wChange.emit(e||{})}_registerFromSchema(e,t){if(Array.isArray(t.components)&&t.components.length){t.components.forEach(s=>this._registerFromSchema(e,s));return}if(!t.key)return;let o=(this.submition()||{})[t.key],a=[t.props&&t.props.Required?Be():null,...t.validators||[]].filter(Boolean);this._virtualFormService.registerField(e,t.key,o,a||[])}_clearHandlers(){this._unsubFns.forEach(t=>t()),this._unsubFns=[];let e=this._formId();e&&this._virtualFormService.clearHandlers(e)}_destroyForm(){this._clearHandlers();let e=this._formId();e&&this._virtualFormService.destroyForm(e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["wform"]],inputs:{config:[1,"config"],submition:[1,"submition"]},outputs:{wChange:"wChange",wSubmit:"wSubmit"},decls:7,vars:6,consts:[[1,"wform__title"],[1,"wform__body",3,"ngSubmit"],[3,"class","formId","component","config","submition","index"],[3,"wSubmit","wChange","wClick","formId","component","config","submition","index"]],template:function(t,o){if(t&1){let a=b();le(0)(1),l(2,"div"),S(3,ho,2,1,"h1",0),l(4,"form",1),_("ngSubmit",function(){return d(a),h(o.onSubmit())}),Y(5,uo,1,10,"form-component",2,mo),c()()}if(t&2){let a=z(o.config());m(),z(o.submition()),m(),Ce(Oe("wform ",(a==null?null:a.class)||"")),m(),I(a!=null&&a.title?3:-1),m(2),J(o.visibleComponents())}},dependencies:[pi],styles:[".wform[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;row-gap:12px;width:100%}.wform__title[_ngcontent-%COMP%]{margin:0 0 10px;color:var(--c-text-primary);font-weight:600;font-size:20px;line-height:1.2;letter-spacing:var(--letter-spacing, 0)}.wform__body[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:12px;width:100%}.wform__component[_ngcontent-%COMP%]{display:block;width:100%}.wform__input[_ngcontent-%COMP%], .wform__textarea[_ngcontent-%COMP%], .wform__select[_ngcontent-%COMP%]{width:100%;display:block;border:1px solid var(--c-border);border-radius:var(--b-radius, 8px);background:transparent;color:var(--c-text-secondary);font-size:var(--fs, 16px);line-height:1.25;padding:10px 12px;transition:var(--transition, .15s ease)}.wform__input[_ngcontent-%COMP%]::placeholder, .wform__textarea[_ngcontent-%COMP%]::placeholder, .wform__select[_ngcontent-%COMP%]::placeholder{color:var(--c-placeholder);transition:inherit}.wform__input[_ngcontent-%COMP%]:focus, .wform__textarea[_ngcontent-%COMP%]:focus, .wform__select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--c-primary)}.wform__input[_ngcontent-%COMP%]:disabled, .wform__textarea[_ngcontent-%COMP%]:disabled, .wform__select[_ngcontent-%COMP%]:disabled{background:var(--c-grey);border-color:var(--c-grey);color:var(--c-grey);opacity:.6;cursor:default}.wform__textarea[_ngcontent-%COMP%]{min-height:88px;resize:vertical}.wform__select[_ngcontent-%COMP%]{appearance:none;padding-right:30px;position:relative}.wform--two-col[_ngcontent-%COMP%]   .wform__body[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}@media (max-width: 768px){.wform__body[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"],changeDetection:0});let r=i;return r})();function _o(r,i){if(r&1){let n=b();l(0,"wbutton",4),_("wClick",function(){let t=d(n).$implicit,o=p();return h(o.onButtonClick(t))}),v(1),c()}if(r&2){let n=i.$implicit,e=p();x("extraClass","w-btn _primary "+(n.class||""))("disabled",e.submitting()),m(),G(" ",n.label," ")}}var et=(()=>{let i=class i{constructor(){this._core=w(ce),this.submit=e=>{},this.change=e=>{},this.submitting=V(!1)}_sync(e){this._core.copy(e,this.submition),this._core.copy(e.data,this.submition.data)}handleSubmit(){this.submitting.set(!0);try{this._sync(this.submition),this.submit(this.submition),this.close()}finally{this.submitting.set(!1)}}handleChange(){this._sync(this.submition),this.change(this.submition)}onButtonClick(e){this.submitting()||e.click(this.submition,this.close)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],decls:5,vars:2,consts:[["formRef",""],[3,"wSubmit","wChange","config","submition"],[1,"modal-actions"],[3,"extraClass","disabled"],[3,"wClick","extraClass","disabled"]],template:function(t,o){if(t&1){let a=b();l(0,"wform",1,0),_("wSubmit",function(){return d(a),h(o.handleSubmit())})("wChange",function(){return d(a),h(o.handleChange())}),c(),l(2,"div",2),Y(3,_o,2,3,"wbutton",3,ge),c()}t&2&&(x("config",o.form)("submition",o.submition),m(3),J(o.modalButtons))},dependencies:[Ue,pe],styles:[".modal-actions[_ngcontent-%COMP%]{padding:30px 0 0}.modal-actions[_ngcontent-%COMP%]   .w-btn[_ngcontent-%COMP%]{width:100%;display:block}"]});let r=i;return r})();var mi=(()=>{let i=class i{constructor(){this._http=w(Le),this.form=g.required(),this.module=g.required(),this.field=g.required(),this.doc=g.required()}get getDoc(){return this.doc()}change(){this._http.post(`/api/${this.module()}/unique${this.field()||""}`,this.doc()).subscribe(e=>{this.doc()[this.field()]!==e&&(this.doc()[this.field()]=e)})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],inputs:{form:[1,"form"],module:[1,"module"],field:[1,"field"],doc:[1,"doc"]},decls:1,vars:2,consts:[[3,"wChange","config","submition"]],template:function(t,o){t&1&&(l(0,"wform",0),_("wChange",function(){return o.change()}),c()),t&2&&x("config",o.form())("submition",o.getDoc)},dependencies:[Ue],encapsulation:2,changeDetection:0});let r=i;return r})();var k=(()=>{let i=class i{constructor(){this._translate=w(Ne),this.appRef=w(_t),this._modal=w(Ae),this._store=w(Lt),this._emitterService=w(Et),this._vform=w(ie),this._ei=w(Ve),this.appId=Bt.appId,this._templateComponent=new Map,this.templatesVersion=V(0),this.templateFields={},this.customTemplateFields={},this.forms=[],this.formIds=[],this._registeredFields=new Map,this._addedFormComponent={},this._store.getJson("formIds",e=>{Array.isArray(e)&&this.formIds.push(...e)})}addTemplateComponent(e,t){this._templateComponent.has(e)||(this._templateComponent.set(e,t),this.templatesVersion.update(o=>o+1))}removeTemplateComponent(e){this._templateComponent.delete(e)&&this.templatesVersion.update(t=>t+1)}getTemplateComponent(e){return this._templateComponent.get(e)??null}getTemplateComponentsNames(){return Array.from(this._templateComponent.keys())}getTemplateFields(e){return this.templateFields[e]||["Placeholder","Label"]}setTemplateFields(e,t,o={}){this.templateFields[e]=t,this.customTemplateFields[e]=A(A({},this.customTemplateFields[e]||{}),o)}getCustomTemplateFields(e){return this.customTemplateFields[e]||{}}translateForm(e){if(e.title){let t=this._translate.translate(`${e.title}`);_e(this._ei,()=>U(()=>e.title=t()))}this._translateComponents(e.components)}_translateComponents(e=[]){for(let t of e){if(t.props){for(let[o,a]of Object.entries(t.props))if(typeof a=="string"){let s=this._translate.translate(`${a}`);_e(this._ei,()=>U(()=>t.props[o]=s()))}else if(Array.isArray(a)){let s=a;s.forEach((u,f)=>{if(typeof u=="string"){let T=this._translate.translate(`${u}`);_e(this._ei,()=>U(()=>s[f]=T()))}})}}Array.isArray(t.components)&&t.components.length&&this._translateComponents(t.components)}}getDefaultForm(e,t=["name","description"]){this._rememberFormId(e);let o=t.map((a,s)=>{let u=a.includes(".")?a.split(".")[1]:"Text",f=(a.split(".")[0]||a).replace(/\[\]|\[\d+\]/g,"");return{name:u,key:a,focused:s===0,props:{Placeholder:`Enter your ${f}`,Label:f.charAt(0).toUpperCase()+f.slice(1)}}});return{formId:e,components:o}}prepareForm(e){let t=`${e.formId??""}`;return this._rememberFormId(t),e=e||this.getDefaultForm(t),e.formId=t,this._emitterService.onComplete("form_loaded").subscribe(()=>{this.translateForm(e),this._addFormComponents(e.components),this.ensureVirtualForm(e)}),this.translateForm(e),this._addFormComponents(e.components),this.ensureVirtualForm(e),e}ensureVirtualForm(e,t){let o=e.formId||crypto.randomUUID();this._vform.getForm(o),this._registeredFields.has(o)||this._registeredFields.set(o,new Set);let a=this._registeredFields.get(o),s=(u=[])=>{for(let f of u){if(f.components?.length){s(f.components);continue}if(!f.key||a.has(f.key))continue;let T=(t||{})[f.key]??null,j=[f.props&&f.props.Required?Be():null,...f.validators||[]].filter(Boolean);this._vform.registerField(o,f.key,T,j),a.add(f.key)}};s(e.components),t&&Object.keys(t).length&&this._vform.patch(o,t)}modal(e,t=[],o={data:{}},a=u=>{},s={}){return(Array.isArray(e)?e:[e]).forEach(f=>this.ensureVirtualForm(f,o)),new Promise(f=>{this._modal.show(oe(A({},s),{component:et,class:"forms_modal",size:"big",form:e,modalButtons:Array.isArray(t)?t:[t],submition:o,onClose:()=>f(o),submit:T=>f(T),change:T=>{typeof a=="function"&&a(T)}}))})}modalDocs(e){return new Promise(t=>{let o={docs:JSON.stringify(e.length?e:[],null,4)};this._modal.show({component:et,class:"forms_modal",size:"big",submition:o,form:{title:"Modify content of documents",components:[{name:"Code",key:"docs",props:{Placeholder:"fill content of documents"}}]},onClose:()=>{let a=o.docs?JSON.parse(o.docs):[];t(a)},submit:()=>{let a=o.docs?JSON.parse(o.docs):[];t(a)}})})}modalUnique(e,t,o,a="",s=()=>{}){let u=this.getDefaultForm("unique",[t+(a?"."+a:"")]);this.ensureVirtualForm(u,o),this._modal.show({component:mi,form:u,module:e,field:t,doc:o,class:"forms_modal",onClose:s})}getComponent(e,t){return this._getComponent(e.components,t)||{}}getProp(e,t,o){return this.getComponent(e,t)?.props?.[o]??null}setProp(e,t,o,a){let s=this.getComponent(e,t);s&&(s.props=s.props||{},s.props[o]=a)}_getComponent(e=[],t){for(let o of e||[]){if(o.key===t)return o;if(o.components?.length){let a=this._getComponent(o.components,t);if(a)return a}}return null}_addFormComponents(e){return W(this,null,function*(){for(let t of e||[])t.name&&(yield this._addFormComponent(t.name)),t.components?.length&&(yield this._addFormComponents(t.components))})}_addFormComponent(e){return W(this,null,function*(){let t=ci[e];if(t&&!this._addedFormComponent[e]){this._addedFormComponent[e]=!0;let o=Mt(t,{environmentInjector:this.appRef.injector});this.appRef.attachView(o.hostView),o.hostView.detectChanges?.()}})}_rememberFormId(e){e&&(this.formIds.includes(e)||(this.formIds.push(e),this._store.setJson("formIds",this.formIds)))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();export{we as a,H as b,Kt as c,oi as d,k as e,Ue as f};
