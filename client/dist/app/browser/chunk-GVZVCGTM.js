import{a as U}from"./chunk-NWZSYFXN.js";import{a as F,d as j}from"./chunk-4YLOSOFQ.js";import{$ as v,Ab as I,Db as N,E as k,G as s,Ka as d,L as y,M as b,T as m,U as c,Y as g,Ya as x,Z as a,_ as u,da as S,db as E,ea as p,fa as h,mb as T,pa as C,r as w,rb as P,tb as M,u as o,w as _,wb as L,x as f,yb as V}from"./chunk-Q5TT443V.js";function H(t,e){if(t&1&&v(0,"img",3),t&2){let l=h();g("src",l.logo,k)}}function R(t,e){t&1&&v(0,"icon-spider")}function z(t,e){if(t&1){let l=S();a(0,"span",8),p("click",function(){_(l);let n=h();return f(n.userService.setMode("dark"))}),C(1," dark_mode "),u()}}function A(t,e){if(t&1){let l=S();a(0,"span",8),p("click",function(){_(l);let n=h();return f(n.userService.setMode())}),C(1," light_mode "),u()}}var q=(()=>{let e=class e{constructor(){this.userService=o(U),this.ui=o(L),this._alert=o(T),this._http=o(P),this._hash=o(M),this._router=o(x),this._form=o(N),this._translate=o(V),this.logo=d.sign.logo,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Submit",value:!0},{name:"Click",value:()=>{this.submit()}}]}]}),this.user={email:d.sign.email,password:d.sign.password,resetPin:null},this._set=i=>{if(i){let n=i.token||"";n&&this._http.set("token",n),localStorage.setItem("waw_user",JSON.stringify(i)),this.userService.setUser(i),this.userService.get(),this._router.navigateByUrl("/profile")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?(this._hash.set("email",this.user.email),this._http.post("/api/user/status",this.user,i=>{i.email&&i.pass?this.login():i.email?this.reset():this.sign()})):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",this.user,this._set.bind(this))}sign(){this._http.post("/api/user/sign",this.user,this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,i=>{i?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=y({type:e,selectors:[["ng-component"]],decls:10,vars:6,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img",3,"click"],["alt","Logo",3,"src"],[1,"auth__form"],[1,"auth"],[1,"material-icons","auth__icon"],[3,"wSubmit","submition","config"],[1,"material-icons","auth__icon",3,"click"]],template:function(n,r){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),p("click",function(){return r.userService.setMode(r.userService.mode?"":"dark")}),m(3,H,1,1,"img",3),m(4,R,1,0,"icon-spider"),u(),a(5,"div",4)(6,"div",5),m(7,z,2,0,"span",6),m(8,A,2,0,"span",6),a(9,"wform",7),p("wSubmit",function(){return r.submit()}),u()()()()()),n&2&&(s(3),c(r.logo?3:-1),s(),c(r.logo?-1:4),s(3),c(r.userService.mode?-1:7),s(),c(r.userService.mode?8:-1),s(),g("submition",r.user)("config",r.form))},dependencies:[F,I],encapsulation:2});let t=e;return t})();var J=[{path:"",component:q}],oe=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=b({type:e}),e.\u0275inj=w({imports:[E.forChild(J),j]});let t=e;return t})();export{oe as SignModule};
