import{a as Q}from"./chunk-LX222HT6.js";import{$ as U,A as f,Aa as W,Ba as z,I as p,M as A,Ma as B,Oa as H,S as b,T as R,W as L,X as P,Xa as G,a as w,aa as I,ba as V,d as M,ea as v,fa as g,ga as y,la as Z,lb as $,ma as x,na as T,nb as S,o as C,oa as F,ob as q,s as k,ub as J,v as O,vb as K,w as j,x as E,z as N,za as h}from"./chunk-LNXCJEQM.js";import{a as u,b as m,e as D}from"./chunk-FDERIQAA.js";var X=(()=>{let c=class c{constructor(t){this.doc=t,this.list={},this.cached={},this._notify=new M([])}fixPaths(t){return t=t||[],Array.isArray(t)||(t=[t]),t.map(i=>{let s=typeof i=="string"?{path:i}:i;return s.type||(s.type=s.path.endsWith(".js")||s.callback?"script":"style"),s})}monitor(t){let i=this.fixPaths(t),s=[k(),C(r=>r.length!==0)];return i.length>0&&s.push(C(r=>r.length===i.length&&r.every(a=>a.status==="ok"&&i.find(l=>l.path===a.path)))),this._notify.asObservable().pipe(w.apply(this,s))}clear(){this.list={},this.cached={}}load(t){return D(this,null,function*(){return t=this.fixPaths(t),Promise.all(t.map(i=>i.type==="script"?this.loadScript(i.path,{callback:i.callback}):this.loadStyle(i.path))).then(i=>(this._notify.next(i),Promise.resolve(i)))})}loadScript(t,i){let{innerContent:s}=u({},i);return new Promise(r=>{if(this.list[t]===!0){r(m(u({},this.cached[t]),{status:"loading"}));return}this.list[t]=!0;let a=d=>{d.status==="ok"&&i?.callback?window[i?.callback]=()=>{l(d)}:l(d)},l=d=>{d.type="script",this.cached[t]=d,r(d),this._notify.next([d])},o=this.doc.createElement("script");o.type="text/javascript",o.src=t,o.charset="utf-8",s&&(o.innerHTML=s),o.readyState?o.onreadystatechange=()=>{(o.readyState==="loaded"||o.readyState==="complete")&&(o.onreadystatechange=null,a({path:t,status:"ok"}))}:o.onload=()=>a({path:t,status:"ok"}),o.onerror=d=>a({path:t,status:"error",error:d}),this.doc.getElementsByTagName("head")[0].appendChild(o)})}loadStyle(t,i){let{rel:s,innerContent:r}=u({rel:"stylesheet"},i);return new Promise(a=>{if(this.list[t]===!0){a(this.cached[t]);return}this.list[t]=!0;let l=this.doc.createElement("link");l.rel=s,l.type="text/css",l.href=t,r&&(l.innerHTML=r),this.doc.getElementsByTagName("head")[0].appendChild(l);let o={path:t,status:"ok",type:"style"};this.cached[t]=o,a(o)})}};c.\u0275fac=function(i){return new(i||c)(N(p))},c.\u0275prov=j({token:c,factory:c.\u0275fac,providedIn:"root"});let n=c;return n})();var et=["*"];function nt(n,c){if(n&1&&(x(0,"div"),z(1),T()),n&2){let e=h();v("id",e.id)}}function it(n,c){if(n&1&&F(0,"textarea",0),n&2){let e=h();v("id",e.id)("placeholder",e.placeholder)}}function ot(n,c){if(n&1&&B(0),n&2){let e=h(2);H(" ",e._loading," ")}}function st(n,c){}function at(n,c){if(n&1&&U(0,st,0,0,"ng-template",2),n&2){let e=h(2);Z("ngTemplateOutlet",e._loadingTpl)}}function ct(n,c){if(n&1&&(x(0,"div",1),g(1,ot,1,1)(2,at,1,1,null,2),T()),n&2){let e=h();b(),y(e._loading?1:2)}}var _=class{baseURL="./assets/tinymce/";fileName="tinymce.min.js";config;delay},Y=!(typeof document=="object"&&document),St=(()=>{class n{defConfig=f(_,{optional:!0});lazySrv=f(X);ngZone=f(V);doc=f(p);cd=f($);_instance;value="";load=!0;id=`_tinymce-${Math.random().toString(36).substring(2)}`;onChange;onTouched;config;placeholder="";inline=!1;set disabled(e){this._disabled=e,this.setDisabled()}_disabled=!1;_loading=null;_loadingTpl=null;set loading(e){e instanceof R?(this._loading=null,this._loadingTpl=e):this._loading=e}delay=0;ready=new I;get instance(){return this._instance}_getWin(){return this.doc.defaultView||window}initDelay(){Y||setTimeout(()=>this.init(),Math.max(0,this.delay))}init(){let e=this._getWin();if(!e.tinymce)throw new Error("tinymce js\u6587\u4EF6\u52A0\u8F7D\u5931\u8D25");let{defConfig:t,config:i,id:s,inline:r}=this;if(this._instance)return;if(t?.baseURL){let o=""+t.baseURL;o.endsWith("/")&&(o=o.substring(0,o.length-1)),e.tinymce.baseURL=o}let a=u(u({},t?.config),i),l=m(u(u({selector:"#"+s,inline:r},t?.config),i),{setup:o=>{this._instance=o,this.onChange&&o.on("change keyup",()=>{this.value=o.getContent(),this.ngZone.run(()=>this.onChange(this.value))}),typeof a.setup=="function"&&a.setup(o)},init_instance_callback:o=>{o&&this.value&&o.setContent(this.value),this.setDisabled(),typeof a.init_instance_callback=="function"&&a.init_instance_callback(o),this.ready.emit(o)}});a.auto_focus&&(l.auto_focus=s),this.ngZone.runOutsideAngular(()=>e.tinymce.init(l)),this.load=!1,this.cd.detectChanges()}destroy(){this._instance!=null&&(this.ngZone.runOutsideAngular(()=>{this._instance.off(),this._instance.remove()}),this._instance=null)}setDisabled(){this._instance&&this.ngZone.runOutsideAngular(()=>{let e=this._disabled?"readonly":"design",t=this._instance.setMode;typeof t=="function"?t(e):this._instance.mode.set(e)})}ngAfterViewInit(){if(Y)return;if(this._getWin().tinymce){this.initDelay();return}let{defConfig:e}=this,t=e&&e.baseURL,i=e&&e.fileName,s=(t||"./assets/tinymce/")+(i||"tinymce.min.js");this.lazySrv.monitor(s).subscribe(()=>this.initDelay()),this.lazySrv.load(s)}ngOnChanges(e){this._instance&&e.config&&(this.destroy(),this.initDelay())}ngOnDestroy(){this.destroy()}writeValue(e){this.value=e||"",this._instance&&this.ngZone.runOutsideAngular(()=>this._instance.setContent(this.value))}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this.setDisabled()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=L({type:n,selectors:[["tinymce"]],inputs:{config:"config",placeholder:"placeholder",inline:[2,"inline","inline",S],disabled:[2,"disabled","disabled",S],loading:"loading",delay:[2,"delay","delay",q]},outputs:{ready:"ready"},exportAs:["tinymce"],features:[G([{provide:Q,useExisting:O(()=>n),multi:!0}]),A],ngContentSelectors:et,decls:3,vars:2,consts:[[1,"tinymce-selector"],[1,"loading"],[3,"ngTemplateOutlet"]],template:function(t,i){t&1&&(W(),g(0,nt,2,1,"div")(1,it,1,2,"textarea",0),g(2,ct,3,1,"div",1)),t&2&&(y(i.inline?0:1),b(2),y(i.load?2:-1))},dependencies:[J],styles:[`tinymce .tinymce-selector{display:none}
`],encapsulation:2,changeDetection:0})}return n})(),Dt=(()=>{class n{static forRoot(e){return{ngModule:n,providers:[{provide:_,useValue:e}]}}static \u0275fac=function(t){return new(t||n)};static \u0275mod=P({type:n});static \u0275inj=E({imports:[K]})}return n})();export{St as a,Dt as b};
