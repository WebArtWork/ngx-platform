import{a as F}from"./chunk-HOLFXWHA.js";import{a as N,d as D}from"./chunk-XJ7IFRCF.js";import{$ as C,Ab as q,Db as B,E as x,G as s,J as o,Ka as _,L as E,M as I,T as m,U as c,Y as S,Ya as j,Z as a,_ as u,da as w,db as T,ea as d,fa as h,mb as P,pa as k,r as b,rb as M,tb as L,w as g,wb as U,x as v,yb as V}from"./chunk-KBY33BJJ.js";function W(i,e){if(i&1&&C(0,"img",3),i&2){let l=h();S("src",l.logo,x)}}function G(i,e){i&1&&C(0,"icon-spider")}function K(i,e){if(i&1){let l=w();a(0,"span",8),d("click",function(){g(l);let n=h();return v(n.userService.setMode("dark"))}),k(1," dark_mode "),u()}}function Q(i,e){if(i&1){let l=w();a(0,"span",8),d("click",function(){g(l);let n=h();return v(n.userService.setMode())}),k(1," light_mode "),u()}}var H=(()=>{let e=class e{constructor(t,n,r,f,R,z,A,J){this.userService=t,this.ui=n,this._alert=r,this._http=f,this._hash=R,this._router=z,this._form=A,this._translate=J,this.logo=_.sign.logo,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Submit",value:!0},{name:"Click",value:()=>{this.submit()}}]}]}),this.user={email:_.sign.email,password:_.sign.password,resetPin:null},this._set=p=>{if(p){let y=p.token||"";y&&this._http.set("token",y),localStorage.setItem("waw_user",JSON.stringify(p)),this.userService.setUser(p),this.userService.get(),this._router.navigateByUrl("/profile")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?(this._hash.set("email",this.user.email),this._http.post("/api/user/status",this.user,t=>{t.email&&t.pass?this.login():t.email?this.reset():this.sign()})):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",this.user,this._set.bind(this))}sign(){this._http.post("/api/user/sign",this.user,this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,t=>{t?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}};e.\u0275fac=function(n){return new(n||e)(o(F),o(U),o(P),o(M),o(L),o(j),o(B),o(V))},e.\u0275cmp=E({type:e,selectors:[["ng-component"]],decls:10,vars:6,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img",3,"click"],["alt","Logo",3,"src"],[1,"auth__form"],[1,"auth"],[1,"material-icons","auth__icon"],[3,"wSubmit","submition","config"],[1,"material-icons","auth__icon",3,"click"]],template:function(n,r){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),d("click",function(){return r.userService.setMode(r.userService.mode?"":"dark")}),m(3,W,1,1,"img",3),m(4,G,1,0,"icon-spider"),u(),a(5,"div",4)(6,"div",5),m(7,K,2,0,"span",6),m(8,Q,2,0,"span",6),a(9,"wform",7),d("wSubmit",function(){return r.submit()}),u()()()()()),n&2&&(s(3),c(r.logo?3:-1),s(),c(r.logo?-1:4),s(3),c(r.userService.mode?-1:7),s(),c(r.userService.mode?8:-1),s(),S("submition",r.user)("config",r.form))},dependencies:[N,q],encapsulation:2});let i=e;return i})();var X=[{path:"",component:H}],me=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=I({type:e}),e.\u0275inj=b({imports:[T.forChild(X),D]});let i=e;return i})();export{me as SignModule};
