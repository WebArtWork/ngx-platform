import{a as me}from"./chunk-G5C7A5E6.js";import{a as Bt}from"./chunk-AP5MEQR4.js";import{b as Le}from"./chunk-PJAMXDDA.js";import{a as St,b as ke,c as Tt,d as It,e as Ft,f as Vt,g as Rt,h as Ot,k as pe,m as Pt,n as zt,o as kt,p as De,q as Dt,r as Et,s as Lt,t as Ee,w as At}from"./chunk-QOT76O5U.js";import{$a as xt,Ca as V,Da as R,E as d,Ea as O,F as h,Fa as gt,Ga as ft,Ha as ae,Hb as Mt,Ia as ge,J as lt,Ja as $,Ka as fe,L as k,La as v,M as ct,Ma as j,Na as G,Q as Ie,R as pt,S as m,Sa as le,Ta as P,Ua as f,Va as Ct,W as mt,Wa as Fe,X as y,Xa as Ve,Ya as Re,Za as Oe,_ as dt,_a as Pe,aa as M,ab as wt,b as at,bb as D,ca as ht,cb as N,da as we,db as Ke,ea as S,fa as T,fb as F,ga as Qe,ha as te,ia as Y,ib as ce,ja as J,jb as U,k as de,ka as C,kb as L,l as qe,la as l,lb as g,ma as p,mb as bt,na as K,nb as ze,p as st,qb as vt,ra as ut,s as je,sa as _t,sb as A,t as Te,ta as re,tb as yt,u as _e,ua as w,vb as Ce,wa as _,y as x,ya as c}from"./chunk-H5N67KS5.js";import{a as B,b as oe,c as W}from"./chunk-2VMXMS7J.js";function Ae(r="Required"){return i=>i==null||typeof i=="string"&&i.trim()===""||Array.isArray(i)&&i.length===0?r:null}function Nt(){let r;return{promise:new Promise(n=>r=n),resolve:r}}var ie=(()=>{let i=class i{constructor(){this._forms=new Map}getForm(e){let t=this._forms.get(e);return t||(t={fields:new Map,values:k({}),touched:k({}),errors:k({}),submitting:k(!1),submitDeferred:Nt(),handlers:{_multi:{onFieldRegister:[],onFieldChange:[],onFieldTouched:[]}}},this._forms.set(e,t),this._callSingle(e,"onInit"),t)}registerField(e,t,o=null,a=[]){let s=this.getForm(e);return s.fields.has(t)||(s.fields.set(t,{value:k(o),touched:k(!1),error:k(null),validators:a}),this._recompute(e),this._emit(e,"onFieldRegister",t)),this.getFieldAPI(e,t)}getFieldAPI(e,t){let a=this.getForm(e).fields.get(t);if(!a)throw new Error(`Field "${t}" not registered.`);let s=u=>{a.value.set(u),this.validateField(e,t),this._recompute(e),this._emit(e,"onFieldChange",t,u,this.getValues(e))};return{value:a.value,error:a.error,touched:a.touched,setValue:s,setTouched:u=>{a.touched.set(u),this._recompute(e),this._emit(e,"onFieldTouched",t,u)},getValue:()=>a.value(),validate:()=>this.validateField(e,t)}}setValue(e,t,o){this.getForm(e).fields.has(t)?this.getForm(e).fields.get(t).value.set(o):this.registerField(e,t,o),this.validateField(e,t),this._recompute(e),this._emit(e,"onFieldChange",t,o,this.getValues(e))}patch(e,t){Object.entries(t).forEach(([o,a])=>this.setValue(e,o,a)),this._callSingle(e,"onPatch",t)}getValues(e){return B({},this.getForm(e).values())}getErrors(e){return B({},this.getForm(e).errors())}validateField(e,t){let a=this.getForm(e).fields.get(t);if(!a)return null;let s=this.getValues(e),u=a.value(),b=a.validators.map(I=>I(u,s)).find(Boolean)??null;return a.error.set(b),b}validateForm(e){let t=!0;return this.getForm(e).fields.forEach((o,a)=>{this.validateField(e,a)&&(t=!1)}),this._recompute(e),t}touchAll(e){this.getForm(e).fields.forEach(t=>t.touched.set(!0)),this._recompute(e)}getSubmitPromise(e){return this.getForm(e).submitDeferred.promise}submit(e){return W(this,null,function*(){let t=this.getForm(e);t.submitting.set(!0);let o=this.getValues(e);yield this._callSingle(e,"onBeforeValidate",o),this.touchAll(e);let a=this.validateForm(e),s=this.getValues(e),u=this.getErrors(e);return a?yield this._callSingle(e,"onValidSubmit",s):yield this._callSingle(e,"onInvalidSubmit",u,s),yield this._callSingle(e,"onAfterValidate",{values:s,valid:a,errors:u}),t.submitDeferred.resolve(),t.submitDeferred=Nt(),yield this._callSingle(e,"onSubmitAlways",{values:s,valid:a}),t.submitting.set(!1),{values:s,valid:a}})}reset(e,t){this.getForm(e).fields.forEach((a,s)=>{a.value.set(t?.[s]??null),a.touched.set(!1),a.error.set(null)}),this._recompute(e),this._callSingle(e,"onReset",this.getValues(e))}destroyForm(e){this._callSingle(e,"onDestroy"),this._forms.delete(e)}setHandler(e,t,o){let a=this.getForm(e);o?a.handlers[t]=o:delete a.handlers[t]}addListener(e,t,o){this.getForm(e).handlers._multi[t].push(o)}removeListener(e,t,o){let a=this.getForm(e).handlers._multi[t];this.getForm(e).handlers._multi[t]=a.filter(s=>s!==o)}clearHandlers(e){this.getForm(e).handlers={_multi:{onFieldRegister:[],onFieldChange:[],onFieldTouched:[]}}}_recompute(e){let t=this.getForm(e),o={},a={},s={};t.fields.forEach((u,b)=>{o[b]=u.value(),a[b]=u.touched(),s[b]=u.error()}),t.values.set(o),t.touched.set(a),t.errors.set(s)}_callSingle(e,t,...o){return W(this,null,function*(){let a=this._forms.get(e);if(!a)return;let s=a.handlers[t];typeof s=="function"&&(yield s(...o))})}_emit(e,t,...o){return W(this,null,function*(){let a=this._forms.get(e)?.handlers._multi[t]??[];for(let s of a)yield s(...o)})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=_e({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();var xe=(()=>{let i=class i{constructor(){this._translateService=x(Le)}transform(e){return this._translateService.translate(e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=dt({name:"translate",type:i,pure:!0});let r=i;return r})();var _i=["inputEl"];function gi(r,i){if(r&1&&(l(0,"span",2),v(1),D(2,"translate"),p()),r&2){c(2);let n=f(2);m(),j(N(2,1,n)())}}function fi(r,i){if(r&1){let n=w();l(0,"i",7),_("click",function(){d(n);let t=c(2);return t.model.set(null),t.onSubmit(),h(t.focus())}),v(1,"close"),p()}}function Ci(r,i){if(r&1&&(l(0,"div",6),v(1),D(2,"translate"),p()),r&2){c(2);let n=f(2),e=f(7);m(),G(" ",N(2,1,(n||e)+" is invalid.")()," ")}}function xi(r,i){if(r&1){let n=w();l(0,"label",1),S(1,gi,3,3,"span",2),l(2,"div",3)(3,"input",4,0),D(5,"translate"),_("ngModelChange",function(t){d(n);let o=c();return o.model.set(t),h(o.onChangeAfterWhile())})("keyup.enter",function(){d(n);let t=c();return h(t.onSubmit())})("blur",function(){d(n);let t=c();return h(t.onBlur())}),p(),S(6,fi,2,0,"i",5),p(),S(7,Ci,3,3,"div",6),p()}if(r&2){let n,e=c(),t=f(0),o=f(1),a=f(2),s=f(3),u=f(5),b=f(6),I=f(7),X=f(8),q=f(9);m(),T(a?1:-1),m(2),$("error",X),C("placeholder",N(5,12,I||"Enter text...")())("type",t||"text")("autocomplete",e.getAutocompleteAttr(t))("disabled",s||(((n=e.control())==null?null:n.disabled)??!1))("ngModel",q)("ngClass",u)("name",o),m(3),T(b?6:-1),m(),T(X?7:-1)}}function wi(r,i){if(r&1&&(l(0,"span",2),v(1),D(2,"translate"),p()),r&2){c(2);let n=f(2);m(),j(N(2,1,n)())}}function bi(r,i){if(r&1&&(l(0,"div",6),v(1),D(2,"translate"),p()),r&2){c(2);let n=f(2),e=f(7);m(),G(" ",N(2,1,(n||e)+" is invalid.")()," ")}}function vi(r,i){if(r&1){let n=w();l(0,"label",1),S(1,wi,3,3,"span",2),l(2,"div",3)(3,"textarea",8,0),D(5,"translate"),_("ngModelChange",function(t){d(n);let o=c();return o.model.set(t),h(o.onChangeAfterWhile())})("keyup.enter",function(){d(n);let t=c();return h(t.onSubmit())})("blur",function(){d(n);let t=c();return h(t.onBlur())}),p()(),S(6,bi,3,3,"div",6),p()}if(r&2){let n,e=c(),t=f(1),o=f(2),a=f(3),s=f(5),u=f(7),b=f(8),I=f(9);m(),T(o?1:-1),m(2),$("error",b),C("placeholder",N(5,9,u||"Enter text...")())("disabled",a||(((n=e.control())==null?null:n.disabled)??!1))("ngModel",I)("ngClass",s)("name",t),m(3),T(b?6:-1)}}function yi(r,i){if(r&1){let n=w();l(0,"label",10)(1,"span",11),v(2),D(3,"translate"),p(),l(4,"input",12,0),_("ngModelChange",function(t){d(n);let o=c(2);return o.model.set(t),h(o.onChange())})("blur",function(){d(n);let t=c(2);return h(t.onBlur())}),p(),K(6,"span",13),p()}if(r&2){let n,e,t=i.$implicit,o=c(2),a=f(1),s=f(3),u=f(5),b=f(8),I=f(9);$("disabled",s||(((n=o.control())==null?null:n.disabled)??!1)),m(2),j(N(3,10,t)()),m(2),$("error",b),C("disabled",s||(((e=o.control())==null?null:e.disabled)??!1))("ngModel",I)("ngClass",u)("value",t)("name",a)}}function Mi(r,i){if(r&1&&Y(0,yi,7,12,"label",9,Qe),r&2){c();let n=f(4);J(n)}}function Si(r,i){if(r&1){let n=w();l(0,"label",10)(1,"span",11),v(2),D(3,"translate"),p(),l(4,"input",14,0),_("ngModelChange",function(t){let o=d(n).$index,a=c(2);return h(a.setCheckboxValue(t,o))})("blur",function(){d(n);let t=c(2);return h(t.onBlur())}),p(),K(6,"span",15),p()}if(r&2){let n,e,t=i.$implicit,o=i.$index,a=c(2),s=f(1),u=f(3),b=f(5),I=f(8);$("disabled",u||(((n=a.control())==null?null:n.disabled)??!1)),m(2),j(N(3,9,t)()),m(2),$("error",I),C("disabled",u||(((e=a.control())==null?null:e.disabled)??!1))("ngClass",b)("ngModel",a.isChecked(t))("name",s+o)}}function Ti(r,i){if(r&1&&(l(0,"span",11),v(1),D(2,"translate"),p()),r&2){c(3);let n=f(2);m(),j(N(2,1,n)())}}function Ii(r,i){if(r&1){let n=w();l(0,"label",10),S(1,Ti,3,3,"span",11),l(2,"input",14,0),_("ngModelChange",function(t){d(n);let o=c(2);return o.model.set(t),h(o.onChange())})("blur",function(){d(n);let t=c(2);return h(t.onBlur())}),p(),K(4,"span",15),p()}if(r&2){let n,e,t=c(2),o=f(1),a=f(2),s=f(3),u=f(5),b=f(8),I=f(9);$("disabled",s||(((n=t.control())==null?null:n.disabled)??!1)),m(),T(a?1:-1),m(),$("error",b),C("disabled",s||(((e=t.control())==null?null:e.disabled)??!1))("ngClass",u)("ngModel",I)("name",o)}}function Fi(r,i){if(r&1&&(Y(0,Si,7,11,"label",9,Qe),S(2,Ii,5,9,"label",9)),r&2){c();let n=f(4);J(n),m(2),T(n.length?-1:2)}}var H=(()=>{let i=class i{constructor(){this.value=g(""),this.wModel=g(void 0),this.wModelChange=L(),this.control=g(null),this.formId=g(null),this.formKey=g(null),this.validators=g([]),this.items=g([]),this.type=g("text"),this.name=g("name"),this.placeholder=g(""),this.label=g(""),this.disabled=g(!1),this.focused=g(!1),this.clearable=g(!1),this.wClass=g(""),this.autocomplete=g(void 0),this.replace=g(),this.valid=g(e=>!!e),this.wChange=L(),this.wSubmit=L(),this.wBlur=L(),this.model=k(null),this.error=k(!1),this._usewForm=k(!1),this._inputEl=bt.required("inputEl"),this._core=x(pe),this._destroyRef=x(lt),this._virtualFormService=x(ie),this._fieldApi=null,U(()=>{let e=!!this.formId()&&!!this.formKey();if(this._usewForm.set(e),!e){this._fieldApi=null;return}this._fieldApi=this._virtualFormService.registerField(this.formId(),this.formKey(),this.model(),this.validators())}),U(()=>{let e=this.control();if(e){this.model.set(e.value),this._reflectControlError(),e.valueChanges?.pipe(St(this._destroyRef)).subscribe(o=>{this.model.set(o),this._reflectControlError()});return}if(this._usewForm()&&this._fieldApi){this.model.set(this._fieldApi.value()),this.error.set(!!this._fieldApi.error());return}let t=this.wModel();if(t!==void 0){this.model.set(t);return}this.model.set(this.value())})}ngAfterViewInit(){this.focused()&&this.focus()}focus(){this._inputEl().nativeElement.focus()}onChange(){let e=this.replace(),t=this.model();if(typeof e=="function"){let o=e(t);o!==t&&this.model.set(o)}if(this._usewForm()&&this._fieldApi)this._fieldApi.setValue(this.model()),this.error.set(!!this._fieldApi.error());else{let o=this.control();o?(o.setValue(this.model(),{emitEvent:!0}),this._reflectControlError()):this.wModel()!==void 0&&this.wModelChange.emit(this.model())}this._core.afterWhile(this,()=>this.wChange.emit(this.model()),2e3)}onChangeAfterWhile(){this.error.set(!1),this.onChange()}onBlur(){if(this.wBlur.emit(),this._usewForm()&&this._fieldApi){this._fieldApi.setTouched(!0),this.error.set(!!this._fieldApi.error());return}let e=this.control();e&&(e.markAsTouched(),this._reflectControlError())}onSubmit(){if(this.onChange(),this._usewForm()&&this._fieldApi){this._fieldApi.validate(),this.error.set(!!this._fieldApi.error()),this.wSubmit.emit(this.model());return}let e=this.control();if(e){e.markAsTouched(),this._reflectControlError(),this.wSubmit.emit(this.model());return}this.valid()(this.model())?this.wSubmit.emit(this.model()):this.error.set(!0)}setCheckboxValue(e,t){let o=Array.isArray(this.model())?this.model():[],a=this.items()[t],s=e?[...o,a]:o.filter(u=>u!==a);this.model.set(s),this.onChange()}isChecked(e){let t=this.model();return Array.isArray(t)?t.includes(e):!1}getAutocompleteAttr(e){let t=this.autocomplete();return t??(e==="password"?"current-password":null)}_reflectControlError(){let e=this.control();e&&this.error.set(!!(e.invalid&&(e.touched||e.dirty)))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["winput"]],viewQuery:function(t,o){t&1&&gt(o._inputEl,_i,5),t&2&&ft()},inputs:{value:[1,"value"],wModel:[1,"wModel"],control:[1,"control"],formId:[1,"formId"],formKey:[1,"formKey"],validators:[1,"validators"],items:[1,"items"],type:[1,"type"],name:[1,"name"],placeholder:[1,"placeholder"],label:[1,"label"],disabled:[1,"disabled"],focused:[1,"focused"],clearable:[1,"clearable"],wClass:[1,"wClass"],autocomplete:[1,"autocomplete"],replace:[1,"replace"],valid:[1,"valid"]},outputs:{wModelChange:"wModelChange",wChange:"wChange",wSubmit:"wSubmit",wBlur:"wBlur"},decls:14,vars:14,consts:[["inputEl",""],[1,"winput"],[1,"winput__label"],[1,"winput__control"],[1,"winput__field",3,"ngModelChange","keyup.enter","blur","placeholder","type","autocomplete","disabled","ngModel","ngClass","name"],[1,"material-icons","winput__clear"],[1,"winput__error"],[1,"material-icons","winput__clear",3,"click"],[1,"winput__field","winput__field--textarea",3,"ngModelChange","keyup.enter","blur","placeholder","disabled","ngModel","ngClass","name"],[1,"winput__choice",3,"disabled"],[1,"winput__choice"],[1,"winput__choice-text"],["type","radio",1,"winput__native",3,"ngModelChange","blur","disabled","ngModel","ngClass","value","name"],[1,"winput__choice-mark","winput__choice-mark--radio"],["type","checkbox",1,"winput__native",3,"ngModelChange","blur","disabled","ngClass","ngModel","name"],[1,"winput__choice-mark"]],template:function(t,o){if(t&1&&(le(0)(1)(2)(3)(4)(5)(6)(7)(8)(9),S(10,xi,8,14,"label",1),S(11,vi,7,11,"label",1),S(12,Mi,2,0),S(13,Fi,3,1)),t&2){let a=P(o.type());m(),P(o.name()),m(),P(o.label()),m(),P(o.disabled()),m(),P(o.items()),m(),P(o.wClass()),m(),P(o.clearable()),m(),P(o.placeholder()),m(),P(o.error()),m(),P(o.model()),m(),T(a!=="radio"&&a!=="checkbox"&&a!=="textarea"?10:-1),m(),T(a==="textarea"?11:-1),m(),T(a==="radio"?12:-1),m(),T(a==="checkbox"?13:-1)}},dependencies:[Ot,It,Tt,Rt,Ft,Vt,A,xe],styles:['[_ngcontent-%COMP%]:root{--c-white: #fff;--c-basic: #3558ae;--c-primary: #256eff;--c-primary-hover: #0051f1;--c-secondary: rgb(197, 61, 61);--c-secondary-hover: rgb(150, 42, 42);--c-bg-primary: #f3f4f7;--c-bg-secondary: #ffffff;--c-bg-tertiary: #fcfdfe;--c-border: #f0f1f7;--c-shadow: #f3f3f3;--c-text-primary: #666666;--c-text-secondary: #19235c;--c-placeholder: #313335ab;--c-img-round: 50%;--card-background: #fefefe;--card-border-radius: 10px;--card-box-shadow: 0 4px 12px rgba(0, 0, 0, .15);--card-margin-bottom: 24px;--card-header-padding: 20px;--card-header-background: #e0e0e0;--card-body-padding: 20px;--card-section-padding: 10px 0;--card-footer-padding: 20px;--card-footer-background: #e0e0e0;--card-border-width: 2px;--card-border-color: #cccccc;--file-img-border-radius: 50%;--file-add-bg: #28a745;--file-add-bg-hover: #218838;--file-item-border-radius: 10px;--day-name: #988888;--b-radius-btn: 10px;--transition: all .3s;--events: #4c8e9d;--border: rgba(102, 91, 91, .432);--header-doc: #d8d8d8;--doc-products: #f5f5f5}html.dark[_ngcontent-%COMP%]:root{--c-white: #fff;--c-basic: #333;--c-bg-primary: #282828;--c-bg-secondary: #343434;--c-bg-tertiary: #404040;--c-border: #404040;--c-shadow: #444444;--c-text-primary: #ffffff;--c-text-secondary: #ffffff;--c-placeholder: #d3cdcd;--c-calendar: #141414;--day-name: #dad5d5;--events: #1c2e32;--border: rgb(255 255 255 / 23%);--header-doc: #1b1b1be3;--doc-products: #252222}.winput[_ngcontent-%COMP%]{position:relative;padding:10px 0;display:block}.winput__label[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;font-weight:500;font-size:20px;line-height:23px;color:var(--c-text-primary);border-radius:var(--b-radius);letter-spacing:0}.winput__control[_ngcontent-%COMP%]{position:relative}.winput__field[_ngcontent-%COMP%]{width:100%;display:block;background-color:transparent;border:1px solid var(--c-border);border-radius:var(--b-radius);color:var(--c-text-secondary);font-size:calc(var(--fs) - 2px);line-height:calc(var(--fs) + 4px);letter-spacing:var(--letter-spacing);padding:8px 12px;transition:var(--transition);appearance:textfield;-webkit-appearance:textfield;-moz-appearance:textfield}.winput__field[_ngcontent-%COMP%]::placeholder{color:var(--c-placeholder);transition:var(--transition)}.winput__field[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--c-primary);transition:var(--transition)}.winput__field[_ngcontent-%COMP%]:disabled{background-color:var(--c-grey);border-color:var(--c-grey);color:var(--c-grey);cursor:default;opacity:.6}.winput__field[type=time][_ngcontent-%COMP%]{appearance:textfield;-webkit-appearance:textfield;-moz-appearance:textfield}.winput__field--textarea[_ngcontent-%COMP%]{min-height:88px;resize:vertical}.winput__clear[_ngcontent-%COMP%]{position:absolute;right:7px;bottom:8px;cursor:pointer;-webkit-user-select:none;user-select:none}.winput__error[_ngcontent-%COMP%]{margin-top:4px;font-size:12px;color:red}.winput__choice[_ngcontent-%COMP%]{display:flex;column-gap:5px;align-items:center;cursor:pointer}.winput__choice.disabled[_ngcontent-%COMP%]{opacity:.5}.winput__choice.disabled[_ngcontent-%COMP%]   .winput__choice-mark[_ngcontent-%COMP%]{background-color:gray!important}.winput__choice-text[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:500;font-size:18px;line-height:1.2}.winput__native[_ngcontent-%COMP%]{width:0;height:0;overflow:hidden;position:absolute;opacity:0;pointer-events:none}.winput__native[_ngcontent-%COMP%]:checked ~ .winput__choice-mark[_ngcontent-%COMP%]:before{opacity:1}.winput__native[_ngcontent-%COMP%]:checked ~ .winput__choice-mark--radio[_ngcontent-%COMP%]:before{opacity:1}.winput__choice-mark[_ngcontent-%COMP%]{order:-1;position:relative;width:26px;height:26px;display:inline-block;border-radius:4px;background-color:var(--c-primary);border:1px solid var(--c-border);box-shadow:0 1px 1px var(--c-shadow);transition:var(--transition);transform:scale(1)}.winput__choice-mark[_ngcontent-%COMP%]:before{content:"";position:absolute;left:50%;top:50%;width:7px;height:14px;border-bottom:3px solid #fff;border-right:3px solid #fff;transform:translate(-50%,-71%) rotate(45deg);opacity:0;transition:var(--transition);display:block}.winput__choice-mark--radio[_ngcontent-%COMP%]{border-radius:120px}.winput__choice-mark--radio[_ngcontent-%COMP%]:before{width:12px;height:12px;border-radius:120px;background:#fff;border:none;transform:translate(-50%,-50%)}input.error[_ngcontent-%COMP%], textarea.error[_ngcontent-%COMP%]{border:1px solid red}'],changeDetection:0});let r=i;return r})();var Ht=(()=>{let i=class i extends Et{constructor(){super({name:"file"}),this._file=x(Lt),this._http=x(De),this.files=this.getDocs(),this._file.add({id:"formPhoto",resize:1920,cb:e=>typeof e=="string"&&this.setFile?.(e)}),this._file.add({id:"formPhotos",multiple:!0,resize:1920,cb:e=>typeof e=="string"&&this.setFile?.(e)})}uploadBase64(e,t="general",o=""){return W(this,null,function*(){return yield new Promise(a=>{this._http.post("/api/file/photo",{container:t,name:o,dataUrl:e},s=>a(s))})})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=_e({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();var Vi=["wrapper"],Ri=["sourceImage"];function Oi(r,i){if(r&1){let n=w();l(0,"img",5,0),_("load",function(){d(n);let t=c();return h(t.imageLoadedInView())})("mousedown",function(t){d(n);let o=c();return h(o.startMove(t,o.moveTypes.Drag))})("touchstart",function(t){d(n);let o=c();return h(o.startMove(t,o.moveTypes.Drag))})("error",function(t){d(n);let o=c();return h(o.loadImageError(t))}),p()}if(r&2){let n=i.ngIf,e=c();ge("visibility",e.imageVisible?"visible":"hidden")("transform",e.safeTransformStyle()),$("ngx-ic-draggable",!e.disabled&&e.allowMoveImage),C("src",n,Ie),we("alt",e.imageAltText)}}function Pi(r,i){if(r&1){let n=w();ut(0),l(1,"span",9),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"topleft"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"topleft"))}),K(2,"span",10),p(),l(3,"span",11),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"topright"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"topright"))}),K(4,"span",10),p(),l(5,"span",12),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"bottomright"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"bottomright"))}),K(6,"span",10),p(),l(7,"span",13),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"bottomleft"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"bottomleft"))}),K(8,"span",10),p(),l(9,"span",14),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"top"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"top"))}),p(),l(10,"span",15),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"top"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"top"))}),K(11,"span",10),p(),l(12,"span",16),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"right"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"right"))}),p(),l(13,"span",17),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"right"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"right"))}),K(14,"span",10),p(),l(15,"span",18),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"bottom"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"bottom"))}),p(),l(16,"span",19),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"bottom"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"bottom"))}),K(17,"span",10),p(),l(18,"span",20),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"left"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"left"))}),p(),l(19,"span",21),_("mousedown",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"left"))})("touchstart",function(t){d(n);let o=c(2);return h(o.startMove(t,o.moveTypes.Resize,"left"))}),K(20,"span",10),p(),_t()}}function zi(r,i){if(r&1){let n=w();l(0,"div",6),_("keydown",function(t){d(n);let o=c();return h(o.keyboardAccess(t))}),l(1,"div",7),_("mousedown",function(t){d(n);let o=c();return h(o.startMove(t,o.moveTypes.Move))})("touchstart",function(t){d(n);let o=c();return h(o.startMove(t,o.moveTypes.Move))}),p(),M(2,Pi,21,0,"ng-container",8),p()}if(r&2){let n=c();ge("top",n.state.cropper().y1,"px")("left",n.state.cropper().x1,"px")("width",n.state.cropper().x2-n.state.cropper().x1,"px")("height",n.state.cropper().y2-n.state.cropper().y1,"px")("margin-left",n.state.options.alignImage==="center"?n.marginLeft:null)("visibility",n.imageVisible?"visible":"hidden"),$("ngx-ic-round",n.state.options.roundCropper),we("aria-label",n.state.options.cropperFrameAriaLabel),m(2),C("ngIf",!n.state.options.hideResizeSquares&&!(n.state.options.cropperStaticWidth&&n.state.options.cropperStaticHeight))}}function be(r,i,n){return r=ki(r,i),Be(r,i,n)}function ki(r,i){let n=r.x2-r.x1,e=r.y2-r.y1,t=r.x1+n/2,o=r.y1+e/2;i.options.cropperStaticHeight&&i.options.cropperStaticWidth?(n=i.maxSize().width>i.options.cropperStaticWidth?i.options.cropperStaticWidth:i.maxSize().width,e=i.maxSize().height>i.options.cropperStaticHeight?i.options.cropperStaticHeight:i.maxSize().height):(n=Math.max(i.cropperScaledMinWidth,Math.min(n,i.cropperScaledMaxWidth,i.maxSize().width)),e=Math.max(i.cropperScaledMinHeight,Math.min(e,i.cropperScaledMaxHeight,i.maxSize().height)),i.options.maintainAspectRatio&&(i.maxSize().width/i.options.aspectRatio<i.maxSize().height?e=n/i.options.aspectRatio:n=e*i.options.aspectRatio));let a=t-n/2,s=a+n,u=o-e/2,b=u+e;return{x1:a,x2:s,y1:u,y2:b}}function Be(r,i,n=!1){return r.x1<0&&(r=oe(B({},r),{x1:0,x2:r.x2-(n?r.x1:0)})),r.y1<0&&(r=oe(B({},r),{y2:r.y2-(n?r.y1:0),y1:0})),r.x2>i.maxSize().width&&(r=oe(B({},r),{x1:r.x1-(n?r.x2-i.maxSize().width:0),x2:i.maxSize().width})),r.y2>i.maxSize().height&&(r=oe(B({},r),{y1:r.y1-(n?r.y2-i.maxSize().height:0),y2:i.maxSize().height})),r}function Di(r,i){let n=Ne(r)-i.clientX,e=He(r)-i.clientY;return{x1:i.cropper.x1+n,y1:i.cropper.y1+e,x2:i.cropper.x2+n,y2:i.cropper.y2+e}}function Wt(r,i,n){let e=B({},n.cropper()),t=Ne(r)-i.clientX,o=He(r)-i.clientY;switch(i.position){case"left":e.x1=Math.min(Math.max(i.cropper.x1+t,e.x2-n.cropperScaledMaxWidth),e.x2-n.cropperScaledMinWidth);break;case"topleft":e.x1=Math.min(Math.max(i.cropper.x1+t,e.x2-n.cropperScaledMaxWidth),e.x2-n.cropperScaledMinWidth),e.y1=Math.min(Math.max(i.cropper.y1+o,e.y2-n.cropperScaledMaxHeight),e.y2-n.cropperScaledMinHeight);break;case"top":e.y1=Math.min(Math.max(i.cropper.y1+o,e.y2-n.cropperScaledMaxHeight),e.y2-n.cropperScaledMinHeight);break;case"topright":e.x2=Math.max(Math.min(i.cropper.x2+t,e.x1+n.cropperScaledMaxWidth),e.x1+n.cropperScaledMinWidth),e.y1=Math.min(Math.max(i.cropper.y1+o,e.y2-n.cropperScaledMaxHeight),e.y2-n.cropperScaledMinHeight);break;case"right":e.x2=Math.max(Math.min(i.cropper.x2+t,e.x1+n.cropperScaledMaxWidth),e.x1+n.cropperScaledMinWidth);break;case"bottomright":e.x2=Math.max(Math.min(i.cropper.x2+t,e.x1+n.cropperScaledMaxWidth),e.x1+n.cropperScaledMinWidth),e.y2=Math.max(Math.min(i.cropper.y2+o,e.y1+n.cropperScaledMaxHeight),e.y1+n.cropperScaledMinHeight);break;case"bottom":e.y2=Math.max(Math.min(i.cropper.y2+o,e.y1+n.cropperScaledMaxHeight),e.y1+n.cropperScaledMinHeight);break;case"bottomleft":e.x1=Math.min(Math.max(i.cropper.x1+t,e.x2-n.cropperScaledMaxWidth),e.x2-n.cropperScaledMinWidth),e.y2=Math.max(Math.min(i.cropper.y2+o,e.y1+n.cropperScaledMaxHeight),e.y1+n.cropperScaledMinHeight);break;case"center":let a="scale"in r?r.scale:1,s=Math.min(Math.max(n.cropperScaledMinWidth,Math.abs(i.cropper.x2-i.cropper.x1)*a),n.cropperScaledMaxWidth),u=Math.min(Math.max(n.cropperScaledMinHeight,Math.abs(i.cropper.y2-i.cropper.y1)*a),n.cropperScaledMaxHeight);e.x1=i.clientX-s/2,e.x2=i.clientX+s/2,e.y1=i.clientY-u/2,e.y2=i.clientY+u/2,e.x1<0?(e.x2-=e.x1,e.x1=0):e.x2>n.maxSize().width&&(e.x1-=e.x2-n.maxSize().width,e.x2=n.maxSize().width),e.y1<0?(e.y2-=e.y1,e.y1=0):e.y2>n.maxSize().height&&(e.y1-=e.y2-n.maxSize().height,e.y2=n.maxSize().height);break}return n.options.maintainAspectRatio?Ei(i.position,e,n):e}function Ei(r,i,n){i=B({},i);let e=0,t=0;switch(r){case"top":i.x2=i.x1+(i.y2-i.y1)*n.options.aspectRatio,e=Math.max(i.x2-n.maxSize().width,0),t=Math.max(0-i.y1,0),(e>0||t>0)&&(i.x2-=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y1+=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"bottom":i.x2=i.x1+(i.y2-i.y1)*n.options.aspectRatio,e=Math.max(i.x2-n.maxSize().width,0),t=Math.max(i.y2-n.maxSize().height,0),(e>0||t>0)&&(i.x2-=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y2-=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"topleft":i.y1=i.y2-(i.x2-i.x1)/n.options.aspectRatio,e=Math.max(0-i.x1,0),t=Math.max(0-i.y1,0),(e>0||t>0)&&(i.x1+=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y1+=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"topright":i.y1=i.y2-(i.x2-i.x1)/n.options.aspectRatio,e=Math.max(i.x2-n.maxSize().width,0),t=Math.max(0-i.y1,0),(e>0||t>0)&&(i.x2-=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y1+=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"right":case"bottomright":i.y2=i.y1+(i.x2-i.x1)/n.options.aspectRatio,e=Math.max(i.x2-n.maxSize().width,0),t=Math.max(i.y2-n.maxSize().height,0),(e>0||t>0)&&(i.x2-=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y2-=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"left":case"bottomleft":i.y2=i.y1+(i.x2-i.x1)/n.options.aspectRatio,e=Math.max(0-i.x1,0),t=Math.max(i.y2-n.maxSize().height,0),(e>0||t>0)&&(i.x1+=t*n.options.aspectRatio>e?t*n.options.aspectRatio:e,i.y2-=t*n.options.aspectRatio>e?t:e/n.options.aspectRatio);break;case"center":i.x2=i.x1+(i.y2-i.y1)*n.options.aspectRatio,i.y2=i.y1+(i.x2-i.x1)/n.options.aspectRatio;let o=Math.max(0-i.x1,0),a=Math.max(i.x2-n.maxSize().width,0),s=Math.max(i.y2-n.maxSize().height,0),u=Math.max(0-i.y1,0);(o>0||a>0||s>0||u>0)&&(i.x1+=s*n.options.aspectRatio>o?s*n.options.aspectRatio:o,i.x2-=u*n.options.aspectRatio>a?u*n.options.aspectRatio:a,i.y1+=u*n.options.aspectRatio>a?u:a/n.options.aspectRatio,i.y2-=s*n.options.aspectRatio>o?s:o/n.options.aspectRatio);break}return i}function Ne(r){return"touches"in r&&r.touches[0]?r.touches[0].clientX:"clientX"in r?r.clientX:0}function He(r){return"touches"in r&&r.touches[0]?r.touches[0].clientY:"clientX"in r?r.clientY:0}var Xe=class{constructor(){this.cropper=k({x1:0,x2:0,y1:0,y2:0}),this.maxSize=k({width:0,height:0}),this.transform={},this.options={format:"png",output:"blob",autoCrop:!0,maintainAspectRatio:!0,aspectRatio:1,resetCropOnAspectRatioChange:!0,resizeToWidth:0,resizeToHeight:0,cropperMinWidth:0,cropperMinHeight:0,cropperMaxHeight:0,cropperMaxWidth:0,cropperStaticWidth:0,cropperStaticHeight:0,canvasRotation:0,roundCropper:!1,onlyScaleDown:!1,imageQuality:92,backgroundColor:void 0,containWithinAspectRatio:!1,hideResizeSquares:!1,alignImage:"center",cropperFrameAriaLabel:void 0,checkImageType:!0},this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=3}setOptionsFromChanges(i){i.options?.currentValue&&this.setOptions(i.options.currentValue);let n=Object.entries(i).filter(([e])=>e in this.options).reduce((e,[t,o])=>oe(B({},e),{[t]:o.currentValue}),{});Object.keys(n).length>0&&this.setOptions(n)}setOptions(i){if(this.options=B(B({},this.options),i||{}),this.validateOptions(),!this.loadedImage?.transformed.image.complete||!this.maxSize)return;let n=!1;this.options.maintainAspectRatio&&i.aspectRatio||"maintainAspectRatio"in i?(this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.options.maintainAspectRatio&&(this.options.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(this.cropper.set(this.maxSizeCropperPosition()),n=!0)):((i.cropperMinWidth||i.cropperMinHeight)&&(this.setCropperScaledMinSize(),n=!0),(i.cropperMaxWidth||i.cropperMaxHeight)&&(this.setCropperScaledMaxSize(),n=!0),(i.cropperStaticWidth||i.cropperStaticHeight)&&(n=!0)),n&&this.cropper.update(e=>be(e,this,!1))}validateOptions(){if(this.options.maintainAspectRatio&&!this.options.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}setMaxSize(i,n){this.maxSize.set({width:i,height:n}),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}setCropperScaledMinSize(){this.loadedImage?.transformed.size?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.cropperScaledMinWidth=this.options.cropperMinWidth>0?Math.max(20,this.options.cropperMinWidth/this.loadedImage.transformed.size.width*this.maxSize().width):20}setCropperScaledMinHeight(){this.options.maintainAspectRatio?this.cropperScaledMinHeight=Math.max(20,this.cropperScaledMinWidth/this.options.aspectRatio):this.options.cropperMinHeight>0?this.cropperScaledMinHeight=Math.max(20,this.options.cropperMinHeight/this.loadedImage.transformed.size.height*this.maxSize().height):this.cropperScaledMinHeight=20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed.size){let i=this.loadedImage.transformed.size.width/this.maxSize().width;this.cropperScaledMaxWidth=this.options.cropperMaxWidth>20?this.options.cropperMaxWidth/i:this.maxSize().width,this.cropperScaledMaxHeight=this.options.cropperMaxHeight>20?this.options.cropperMaxHeight/i:this.maxSize().height,this.options.maintainAspectRatio&&(this.cropperScaledMaxWidth>this.cropperScaledMaxHeight*this.options.aspectRatio?this.cropperScaledMaxWidth=this.cropperScaledMaxHeight*this.options.aspectRatio:this.cropperScaledMaxWidth<this.cropperScaledMaxHeight*this.options.aspectRatio&&(this.cropperScaledMaxHeight=this.cropperScaledMaxWidth/this.options.aspectRatio))}else this.cropperScaledMaxWidth=this.maxSize().width,this.cropperScaledMaxHeight=this.maxSize().height}equalsCropperPosition(i){let n=this.cropper();return n==null&&i==null||n!=null&&i!=null&&n.x1.toFixed(3)===i.x1.toFixed(3)&&n.y1.toFixed(3)===i.y1.toFixed(3)&&n.x2.toFixed(3)===i.x2.toFixed(3)&&n.y2.toFixed(3)===i.y2.toFixed(3)}equalsTransformTranslate(i){return(this.transform.translateH??0)===(i.translateH??0)&&(this.transform.translateV??0)===(i.translateV??0)}equalsTransform(i){return this.equalsTransformTranslate(i)&&(this.transform.scale??1)===(i.scale??1)&&(this.transform.rotate??0)===(i.rotate??0)&&(this.transform.flipH??!1)===(i.flipH??!1)&&(this.transform.flipV??!1)===(i.flipV??!1)}aspectRatioIsCorrect(){let i=this.cropper();return(i.x2-i.x1)/(i.y2-i.y1)===this.options.aspectRatio}resizeCropperPosition(i){(i.width!==this.maxSize().width||i.height!==this.maxSize().height)&&this.cropper.update(n=>({x1:n.x1*this.maxSize().width/i.width,x2:n.x2*this.maxSize().width/i.width,y1:n.y1*this.maxSize().height/i.height,y2:n.y2*this.maxSize().height/i.height}))}maxSizeCropperPosition(){return{x1:0,y1:0,x2:this.maxSize().width,y2:this.maxSize().height}}toCropInput(){return{cropper:this.cropper(),maxSize:this.maxSize(),transform:this.transform,loadedImage:this.loadedImage,options:B({},this.options)}}},Z=(function(r){return r.Drag="drag",r.Move="move",r.Resize="resize",r.Pinch="pinch",r})(Z||{});function Li(r,i,n){let e=r.width,t=r.height;i=Math.round(i),n=Math.round(n);let o=e/i,a=t/n,s=Math.ceil(o/2),u=Math.ceil(a/2),b=r.getContext("2d");if(b){let I=b.getImageData(0,0,e,t),X=b.createImageData(i,n),q=I.data,Q=X.data;for(let ee=0;ee<n;ee++)for(let se=0;se<i;se++){let ve=(se+ee*i)*4,pi=ee*a,ne=0,ye=0,Ze=0,et=0,tt=0,it=0,nt=0,mi=Math.floor(se*o),di=Math.floor(ee*a),$e=Math.ceil((se+1)*o),Ue=Math.ceil((ee+1)*a);$e=Math.min($e,e),Ue=Math.min(Ue,t);for(let Me=di;Me<Ue;Me++){let ot=Math.abs(pi-Me)/u,hi=se*o,ui=ot*ot;for(let Se=mi;Se<$e;Se++){let rt=Math.abs(hi-Se)/s,he=Math.sqrt(ui+rt*rt);if(he>=1)continue;ne=2*he*he*he-3*he*he+1;let ue=4*(Se+Me*e);nt+=ne*q[ue+3],Ze+=ne,q[ue+3]<255&&(ne=ne*q[ue+3]/250),et+=ne*q[ue],tt+=ne*q[ue+1],it+=ne*q[ue+2],ye+=ne}}Q[ve]=et/ye,Q[ve+1]=tt/ye,Q[ve+2]=it/ye,Q[ve+3]=nt/Ze}r.width=i,r.height=n,b.putImageData(X,0,0)}}function $t(r,i){return r/100*i}var Ye=class{crop(i,n){let e=this.getImagePosition(i),t=e.x2-e.x1,o=e.y2-e.y1,a=document.createElement("canvas");a.width=t,a.height=o;let s=a.getContext("2d");if(!s)return null;i.options?.backgroundColor!=null&&(s.fillStyle=i.options.backgroundColor,s.fillRect(0,0,t,o));let u=(i.transform?.scale||1)*(i.transform?.flipH?-1:1),b=(i.transform?.scale||1)*(i.transform?.flipV?-1:1),{translateH:I,translateV:X}=this.getCanvasTranslate(i),q=i.loadedImage.transformed;s.setTransform(u,0,0,b,q.size.width/2+I,q.size.height/2+X),s.translate(-e.x1/u,-e.y1/b),s.rotate((i.transform?.rotate||0)*Math.PI/180),s.drawImage(q.image,-q.size.width/2,-q.size.height/2);let Q={width:t,height:o,imagePosition:e,cropperPosition:B({},i.cropper)};i.options?.containWithinAspectRatio&&(Q.offsetImagePosition=this.getOffsetImagePosition(i));let ee=this.getResizeRatio(t,o,i.options);return ee!==1&&(Q.width=Math.round(t*ee),Q.height=i.options?.maintainAspectRatio?Math.round(Q.width/(i.options?.aspectRatio??1)):Math.round(o*ee),Li(a,Q.width,Q.height)),n==="blob"?this.cropToBlob(Q,a,i):(Q.base64=a.toDataURL("image/"+(i.options?.format??"png"),this.getQuality(i.options)),Q)}cropToBlob(i,n,e){return W(this,null,function*(){return i.blob=yield new Promise(t=>n.toBlob(t,"image/"+(e.options?.format??"png"),this.getQuality(e.options))),i.blob&&(i.objectUrl=URL.createObjectURL(i.blob)),i})}getCanvasTranslate(i){if(i.transform?.translateUnit==="px"){let n=this.getRatio(i);return{translateH:(i.transform?.translateH||0)*n,translateV:(i.transform?.translateV||0)*n}}else return{translateH:i.transform?.translateH?$t(i.transform.translateH,i.loadedImage.transformed.size.width):0,translateV:i.transform?.translateV?$t(i.transform.translateV,i.loadedImage.transformed.size.height):0}}getRatio(i){return i.loadedImage.transformed.size.width/i.maxSize.width}getImagePosition(i){let n=this.getRatio(i),e={x1:Math.round(i.cropper.x1*n),y1:Math.round(i.cropper.y1*n),x2:Math.round(i.cropper.x2*n),y2:Math.round(i.cropper.y2*n)};return i.options?.containWithinAspectRatio||(e.x1=Math.max(e.x1,0),e.y1=Math.max(e.y1,0),e.x2=Math.min(e.x2,i.loadedImage.transformed.size.width),e.y2=Math.min(e.y2,i.loadedImage.transformed.size.height)),e}getOffsetImagePosition(i){let n=(i.options?.canvasRotation??0)+i.loadedImage.exifTransform.rotate,e=this.getRatio(i),t,o;n%2?(t=(i.loadedImage.transformed.size.width-i.loadedImage.original.size.height)/2,o=(i.loadedImage.transformed.size.height-i.loadedImage.original.size.width)/2):(t=(i.loadedImage.transformed.size.width-i.loadedImage.original.size.width)/2,o=(i.loadedImage.transformed.size.height-i.loadedImage.original.size.height)/2);let a=i.cropper,s={x1:Math.round(a.x1*e)-t,y1:Math.round(a.y1*e)-o,x2:Math.round(a.x2*e)-t,y2:Math.round(a.y2*e)-o};return i.options?.containWithinAspectRatio||(s.x1=Math.max(s.x1,0),s.y1=Math.max(s.y1,0),s.x2=Math.min(s.x2,i.loadedImage.transformed.size.width),s.y2=Math.min(s.y2,i.loadedImage.transformed.size.height)),s}getResizeRatio(i,n,e){let t=new Array;e?.resizeToWidth&&e.resizeToWidth>0&&t.push(e.resizeToWidth/i),e?.resizeToHeight&&e.resizeToHeight>0&&t.push(e.resizeToHeight/n);let o=t.length===0?1:Math.min(...t);return o>1&&!e?.onlyScaleDown?o:Math.min(o,1)}getQuality(i){return Math.min(1,Math.max(0,(i?.imageQuality??92)/100))}},Ai=[new Uint8Array([255,216,255,225,0,34,69,120,105,102,0,0,77,77,0,42,0,0,0,8,0,1,1,18,0,3,0,0,0,1,0,6,0,0,0,0,0,0,255,219,0,132,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,255,192,0,17,8,0,1,0,2,3,1,17,0,2,17,1,3,17,1,255,196,0,74,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,16,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,218,0,12,3,1,0,2,17,3,17,0,63,0,63,240,127,255,217])],Bi=URL.createObjectURL(new Blob(Ai,{type:"image/jpeg"}));function Ni(){return new Promise(r=>{let i=new Image;i.onload=()=>{let n=i.width===1&&i.height===2;r(n)},i.src=Bi})}function Hi(r){switch(typeof r=="object"&&(r=Wi(r)),r){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}function Wi(r){let i=new DataView(r);if(i.getUint16(0,!1)!==65496)return-2;let n=i.byteLength,e=2;for(;e<n;){if(i.getUint16(e+2,!1)<=8)return-1;let t=i.getUint16(e,!1);if(e+=2,t==65505){if(i.getUint32(e+=2,!1)!==1165519206)return-1;let o=i.getUint16(e+=6,!1)==18761;e+=i.getUint32(e+4,o);let a=i.getUint16(e,o);e+=2;for(let s=0;s<a;s++)if(i.getUint16(e+s*12,o)==274)return i.getUint16(e+s*12+8,o)}else{if((t&65280)!==65280)break;e+=i.getUint16(e,!1)}}return-1}var Je=class{constructor(){this.autoRotateSupported=Ni()}loadImageFile(i,n){return W(this,null,function*(){let e=yield i.arrayBuffer();return n.checkImageType?yield this.checkImageTypeAndLoadImageFromArrayBuffer(e,i.type,n):yield this.loadImageFromArrayBuffer(e,n)})}checkImageTypeAndLoadImageFromArrayBuffer(i,n,e){return this.isValidImageType(n)?this.loadImageFromArrayBuffer(i,e,n):Promise.reject(new Error("Invalid image type"))}isValidImageType(i){return/image\/(png|jpg|jpeg|heic|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(i)}loadImageFromURL(i,n){return W(this,null,function*(){let t=yield(yield fetch(i)).blob(),o=yield t.arrayBuffer();return yield this.loadImageFromArrayBuffer(o,n,t.type)})}loadBase64Image(i,n){let e=this.base64ToArrayBuffer(i);return this.loadImageFromArrayBuffer(e,n)}base64ToArrayBuffer(i){i=i.replace(/^data:([^;]+);base64,/gmi,"");let n=atob(i),e=n.length,t=new Uint8Array(e);for(let o=0;o<e;o++)t[o]=n.charCodeAt(o);return t.buffer}loadImageFromArrayBuffer(i,n,e){return W(this,null,function*(){let t=yield new Promise((o,a)=>W(this,null,function*(){try{let s=new Blob([i],e?{type:e}:void 0),u=URL.createObjectURL(s),b=new Image,X=e==="image/svg+xml"?yield this.getSvgImageSize(s):void 0;b.onload=()=>o({originalImage:b,originalImageSize:X,originalObjectUrl:u,originalArrayBuffer:i}),b.onerror=a,b.src=u}catch(s){a(s)}}));return yield this.transformImageFromArrayBuffer(t,n,t.originalImageSize!=null)})}getSvgImageSize(i){return W(this,null,function*(){let t=new DOMParser().parseFromString(yield i.text(),"image/svg+xml").querySelector("svg");if(!t)throw Error("Failed to parse SVG image");let o=t.getAttribute("width"),a=t.getAttribute("height");if(o&&a)return null;let s=t.getAttribute("viewBox")||t.getAttribute("viewbox");if(s){let u=s.split(" ");return{width:+u[2],height:+u[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})}transformImageFromArrayBuffer(i,n,e=!1){return W(this,null,function*(){let t=yield this.autoRotateSupported,o=Hi(t?-1:i.originalArrayBuffer);if(!i.originalImage||!i.originalImage.complete)return Promise.reject(new Error("No image loaded"));let a={original:{objectUrl:i.originalObjectUrl,image:i.originalImage,size:i.originalImageSize??{width:i.originalImage.naturalWidth,height:i.originalImage.naturalHeight}},exifTransform:o};return this.transformLoadedImage(a,n,e)})}transformLoadedImage(i,n,e=!1){return W(this,null,function*(){let t=(n.canvasRotation??0)+i.exifTransform.rotate,o=i.original.size;if(!e&&t===0&&!i.exifTransform.flip&&!n.containWithinAspectRatio)return{original:{objectUrl:i.original.objectUrl,image:i.original.image,size:B({},o)},transformed:{objectUrl:i.original.objectUrl,image:i.original.image,size:B({},o)},exifTransform:i.exifTransform};let a=this.getTransformedSize(o,i.exifTransform,n),s=document.createElement("canvas");s.width=a.width,s.height=a.height;let u=s.getContext("2d");u?.setTransform(i.exifTransform.flip?-1:1,0,0,1,s.width/2,s.height/2),u?.rotate(Math.PI*(t/2)),u?.drawImage(i.original.image,-o.width/2,-o.height/2);let b=yield new Promise(q=>s.toBlob(q,"image/"+(n.format??"png")));if(!b)throw new Error("Failed to get Blob for transformed image.");let I=URL.createObjectURL(b),X=yield this.loadImageFromObjectUrl(I);return{original:{objectUrl:i.original.objectUrl,image:i.original.image,size:B({},o)},transformed:{objectUrl:I,image:X,size:{width:X.width,height:X.height}},exifTransform:i.exifTransform}})}loadImageFromObjectUrl(i){return new Promise((n,e)=>{let t=new Image;t.onload=()=>n(t),t.onerror=e,t.src=i})}getTransformedSize(i,n,e){let t=(e.canvasRotation??0)+n.rotate;if(e.containWithinAspectRatio)if(t%2){let o=i.width*(e.aspectRatio??1),a=i.height/(e.aspectRatio??1);return{width:Math.max(i.height,o),height:Math.max(i.width,a)}}else{let o=i.height*(e.aspectRatio??1),a=i.width/(e.aspectRatio??1);return{width:Math.max(i.width,o),height:Math.max(i.height,a)}}return t%2?{height:i.width,width:i.height}:{width:i.width,height:i.height}}};function $i(r){switch(r){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}function Ui(r){switch(r){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}function qi(r,i){switch(r){case"ArrowUp":return{clientX:0,clientY:i*-1};case"ArrowRight":return{clientX:i,clientY:0};case"ArrowDown":return{clientX:0,clientY:i};case"ArrowLeft":default:return{clientX:i*-1,clientY:0}}}var Ut=(()=>{let i=class i{get alignImageStyle(){return this.state.options.alignImage}constructor(e){this.sanitizer=e,this.pinchStart$=new at,this.cropService=new Ye,this.loadImageService=new Je,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.moveTypes=Z,this.state=new Xe,this.safeImgDataUrl=k(void 0),this.safeTransformStyle=k(void 0),this.marginLeft="0px",this.imageVisible=!1,this.allowMoveImage=!1,this.checkImageType=!0,this.disabled=!1,this.hidden=!1,this.imageCropped=L(),this.startCropImage=L(),this.imageLoaded=L(),this.cropperReady=L(),this.loadImageFailed=L(),this.transformChange=L(),this.cropperChange=L(),this.reset()}ngOnInit(){this.state.stepSize=this.initialStepSize||this.state.stepSize}ngOnChanges(e){let t=this.state.cropper(),o=this.state.transform,a=this.state.options.backgroundColor;if(this.state.setOptionsFromChanges(e),this.onChangesInputImage(e),e.transform&&this.transform&&(this.state.transform=this.transform,this.setCssTransform()),!this.state.loadedImage?.transformed.image.complete||!this.state.maxSize)return;if(this.containWithinAspectRatio&&e.aspectRatio||e.containWithinAspectRatio||e.canvasRotation){this.loadImageService.transformLoadedImage(this.state.loadedImage,this.state.options).then(u=>this.setLoadedImage(u)).catch(u=>this.loadImageError(u));return}e.cropper&&this.cropper&&this.state.cropper.set(be(this.cropper,this.state,!0));let s=!this.state.equalsCropperPosition(t);s&&(!this.cropper||!this.state.equalsCropperPosition(this.cropper))&&this.cropperChange.emit(this.state.cropper()),(s||!this.state.equalsTransform(o)||this.state.options.backgroundColor!==a)&&this.doAutoCrop(),e.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesInputImage(e){(e.imageChangedEvent||e.imageURL||e.imageBase64||e.imageFile)&&this.reset(),e.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),e.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),e.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),e.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){let e=this.imageChangedEvent?.target?.files;return e instanceof FileList&&e.length>0}reset(){this.state.loadedImage=void 0,this.state.maxSize.set({width:0,height:0}),this.imageVisible=!1}loadImageFile(e){this.loadImageService.loadImageFile(e,this.state.options).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadBase64Image(e){this.loadImageService.loadBase64Image(e,this.state.options).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadImageFromURL(e){this.loadImageService.loadImageFromURL(e,this.state.options).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}setLoadedImage(e){this.state.loadedImage=e,this.safeImgDataUrl.set(this.sanitizer.bypassSecurityTrustResourceUrl(e.transformed.objectUrl))}loadImageError(e){console.error(e),this.loadImageFailed.emit()}setCssTransform(){let e=this.state.transform?.translateUnit||"%";this.safeTransformStyle.set(this.sanitizer.bypassSecurityTrustStyle(`translate(${this.state.transform.translateH||0}${e}, ${this.state.transform.translateV||0}${e}) scaleX(`+(this.state.transform.scale||1)*(this.state.transform.flipH?-1:1)+") scaleY("+(this.state.transform.scale||1)*(this.state.transform.flipV?-1:1)+") rotate("+(this.state.transform.rotate||0)+"deg)"))}imageLoadedInView(){this.state.loadedImage!=null&&(this.imageLoaded.emit(this.state.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.cropper&&(!this.maintainAspectRatio||this.state.aspectRatioIsCorrect())?(this.state.cropper.set(be(this.cropper,this.state,!0)),this.emitCropperPositionChange(this.cropper)):(this.state.cropper.set(be(this.state.maxSizeCropperPosition(),this.state,!0)),this.cropperChange.emit(this.state.cropper())),this.imageVisible=!0,this.cropperReady.emit(this.state.maxSize()),this.doAutoCrop()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>1}onResize(){if(this.state.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{let e=this.state.maxSize();this.setMaxSize(),this.state.resizeCropperPosition(e)}}keyboardAccess(e){this.changeKeyboardStepSize(e),this.keyboardMoveCropper(e)}changeKeyboardStepSize(e){let t=+e.key;t>=1&&t<=9&&(this.state.stepSize=t)}keyboardMoveCropper(e){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e.key))return;let o=e.shiftKey?Z.Resize:Z.Move,a=e.altKey?Ui(e.key):$i(e.key),s=qi(e.key,this.state.stepSize);e.preventDefault(),e.stopPropagation(),this.moveStart={type:o,position:a,clientX:0,clientY:0,transform:this.state.transform,cropper:this.state.cropper()},this.handleMouseMove(s),this.handleMouseUp()}startMove(e,t,o=null){this.disabled||this.moveStart&&this.moveStart.type===Z.Pinch||t===Z.Drag&&!this.allowMoveImage||("preventDefault"in e&&e.preventDefault(),this.moveStart={type:t,position:o,clientX:Ne(e),clientY:He(e),transform:this.state.transform,cropper:this.state.cropper()},this.initMouseMove())}initMouseMove(){qe(de(document,"mousemove"),de(document,"touchmove")).pipe(je(qe(de(document,"mouseup"),de(document,"touchend"),this.pinchStart$).pipe(st()))).subscribe({next:e=>this.handleMouseMove(e),complete:()=>this.handleMouseUp()})}handleMouseMove(e){if(this.moveStart){if("stopPropagation"in e&&e.stopPropagation(),"preventDefault"in e&&e.preventDefault(),this.moveStart.type===Z.Move)this.state.cropper.set(Be(Di(e,this.moveStart),this.state,!0));else if(this.moveStart.type===Z.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.state.cropper.set(Be(Wt(e,this.moveStart,this.state),this.state,!1));else if(this.moveStart.type===Z.Drag){let t=Ne(e)-this.moveStart.clientX,o=He(e)-this.moveStart.clientY;this.state.transform=oe(B({},this.state.transform),{translateH:(this.moveStart.transform?.translateH||0)+t,translateV:(this.moveStart.transform?.translateV||0)+o}),this.setCssTransform()}}}handleMouseUp(){!this.moveStart||this.moveStart.type===Z.Pinch||((!this.state.equalsCropperPosition(this.moveStart.cropper)||this.moveStart.transform&&!this.state.equalsTransform(this.moveStart.transform))&&(this.moveStart.type===Z.Drag?this.transformChange.emit(this.state.transform):this.cropperChange.emit(this.state.cropper()),this.doAutoCrop()),this.moveStart=void 0)}startPinch(e){if(this.disabled||!this.sourceImageLoaded()||e.touches.length<2)return;"preventDefault"in e&&e.preventDefault();let t=this.state.cropper();this.moveStart={type:Z.Pinch,position:"center",clientX:t.x1+(t.x2-t.x1)/2,clientY:t.y1+(t.y2-t.y1)/2,cropper:t},this.initPinch()}initPinch(){this.pinchStart$.next(),de(document,"touchmove").pipe(je(de(document,"touchend"))).subscribe({next:e=>this.handlePinchMove(e),complete:()=>this.handlePinchStop()})}handlePinchMove(e){this.moveStart&&(e.preventDefault&&e.preventDefault(),this.moveStart.type===Z.Pinch&&!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.state.cropper.set(Be(Wt(e,this.moveStart,this.state),this.state,!1)))}handlePinchStop(){this.moveStart&&(this.state.equalsCropperPosition(this.moveStart.cropper)||(this.emitCropperPositionChange(this.moveStart.cropper),this.doAutoCrop()),this.moveStart=void 0)}setMaxSize(){if(this.sourceImage){let e=getComputedStyle(this.sourceImage.nativeElement);this.state.setMaxSize(parseFloat(e.width),parseFloat(e.height)),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.state.maxSize().width/2+"px)")}}emitCropperPositionChange(e){this.state.equalsCropperPosition(e)||this.cropperChange.emit(this.state.cropper())}doAutoCrop(){this.state.options.autoCrop&&this.crop()}crop(e=this.state.options.output){if(this.state.loadedImage?.transformed?.image!=null){if(this.startCropImage.emit(),e==="blob")return this.cropToBlob();if(e==="base64")return this.cropToBase64()}return null}cropToBlob(){return new Promise((e,t)=>W(this,null,function*(){let o=yield this.cropService.crop(this.state.toCropInput(),"blob");o?(this.imageCropped.emit(o),e(o)):t("Crop image failed")}))}cropToBase64(){let e=this.cropService.crop(this.state.toCropInput(),"base64");return e?(this.imageCropped.emit(e),e):null}resetCropperPosition(){this.state.cropper.set(be(this.state.maxSizeCropperPosition(),this.state,!0)),this.cropperChange.emit(this.state.cropper())}ngOnDestroy(){this.pinchStart$.complete()}};i.\u0275fac=function(t){return new(t||i)(mt(Mt))},i.\u0275cmp=y({type:i,selectors:[["image-cropper"]],viewQuery:function(t,o){if(t&1&&(V(Vi,7),V(Ri,5)),t&2){let a;R(a=O())&&(o.wrapper=a.first),R(a=O())&&(o.sourceImage=a.first)}},hostVars:6,hostBindings:function(t,o){t&1&&_("resize",function(){return o.onResize()},pt),t&2&&(ge("text-align",o.alignImageStyle),$("disabled",o.disabled)("ngx-ic-hidden",o.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",options:"options",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",autoCrop:"autoCrop",cropper:"cropper",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",checkImageType:"checkImageType",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange",cropperChange:"cropperChange"},features:[ct],decls:4,vars:10,consts:[["sourceImage",""],[3,"touchstart"],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,o){t&1&&(l(0,"div",1),_("touchstart",function(s){return o.startPinch(s)}),M(1,Oi,2,8,"img",2),K(2,"div",3),M(3,zi,3,16,"div",4),p()),t&2&&(ge("background",o.imageVisible&&o.state.options.backgroundColor),m(),C("ngIf",o.safeImgDataUrl()),m(),ge("width",o.state.maxSize().width||0,"px")("height",o.state.maxSize().height||0,"px")("margin-left",o.state.options.alignImage==="center"?o.marginLeft:null),m(),C("ngIf",o.imageVisible))},dependencies:[yt],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{display:inline;max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:var(--cropper-color, #53535C);background:transparent;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:var(--cropper-border, 1px solid rgba(255, 255, 255, .5))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:hover   .ngx-ic-move[_ngcontent-%COMP%]{border:var(--cropper-hover-border, var(--cropper-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border:var(--cropper-focus-border, 2px solid dodgerblue)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{background:var(--cropper-resize-square-focus-bg, var(--cropper-resize-square-bg, #53535C));border:var(--cropper-resize-square-focus-border, var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;width:6px;height:6px;box-sizing:content-box;background:var(--cropper-resize-square-bg, #53535C);border:var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]:hover   .ngx-ic-square[_ngcontent-%COMP%]{background:var(--cropper-resize-square-hover-bg, var(--cropper-resize-square-bg, #53535C));border:var(--cropper-resize-square-hover-border, var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ic-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0});let r=i;return r})();var qt=(()=>{let i=class i{constructor(){this.maintainAspectRatio=!0,this.aspectRatio=1}imageCropped(e){this.croppedDataUrl=e.base64}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["app-file-cropper"]],decls:3,vars:5,consts:[["output","base64","format","png",3,"imageCropped","maintainAspectRatio","cropperStaticHeight","cropperStaticWidth","aspectRatio","imageBase64"],[1,"mt10",3,"click"]],template:function(t,o){t&1&&(l(0,"image-cropper",0),_("imageCropped",function(s){return o.imageCropped(s)}),p(),l(1,"wbutton",1),_("click",function(){return o.uploadImage(o.croppedDataUrl),o.close()}),v(2,` Crop
`),p()),t&2&&C("maintainAspectRatio",o.maintainAspectRatio)("cropperStaticHeight",o.height)("cropperStaticWidth",o.width)("aspectRatio",o.aspectRatio)("imageBase64",o.dataUrl)},dependencies:[Ut,me],encapsulation:2});let r=i;return r})();var ji=(r,i)=>({$implicit:r,index:i});function Qi(r,i){if(r&1&&(l(0,"div",4),v(1),D(2,"translate"),p()),r&2){c();let n=f(0);m(),j(N(2,1,n)())}}function Ki(r,i){if(r&1&&(l(0,"div",13),v(1),D(2,"translate"),p()),r&2){c(2);let n=f(1);m(),j(N(2,1,n)())}}function Xi(r,i){if(r&1&&(re(0,12),M(1,Ki,3,3,"ng-template",null,1,F)),r&2){let n=ae(2),e=c();C("ngTemplateOutlet",e.t_empty()||n)}}function Yi(r,i){if(r&1&&K(0,"img",17),r&2){let n=c().$implicit;C("src",n,Ie)}}function Ji(r,i){if(r&1){let n=w();l(0,"span",16),v(1),p(),S(2,Yi,1,1,"img",17),l(3,"button",18),_("click",function(){let t=d(n).index,o=c(3);return h(o.removeAt(t))}),v(4," close "),p()}if(r&2){let n=i.$implicit,e=c(3);m(),j(n),m(),T(e.preview()&&e.isImage(n)?2:-1)}}function Gi(r,i){if(r&1&&(l(0,"li",14),re(1,15),M(2,Ji,5,2,"ng-template",null,2,F),p()),r&2){let n=i.$implicit,e=i.$index,t=ae(3),o=c(2);m(),C("ngTemplateOutlet",o.t_item()||t)("ngTemplateOutletContext",xt(2,ji,n,e))}}function Zi(r,i){if(r&1&&(l(0,"ul"),Y(1,Gi,4,5,"li",14,te),p()),r&2){c();let n=f(2);m(),J(n)}}function en(r,i){if(r&1){let n=w();l(0,"button",19),_("click",function(){d(n);let t=c();return h(t.clear())}),l(1,"span",10),v(2,"close"),p(),l(3,"span"),v(4),D(5,"translate"),p()()}if(r&2){c();let n=f(3);C("disabled",n),m(4),j(N(5,2,"Clear")())}}var jt=(()=>{let i=class i{constructor(){this.label=g(""),this.placeholder=g("Select file"),this.disabled=g(!1),this.clearable=g(!0),this.accept=g("*/*"),this.multiple=g(!1),this.preview=g(!0),this.cropWidth=g(null),this.cropHeight=g(null),this.t_item=g(),this.t_empty=g(),this.formId=g(null),this.formKey=g(null),this.container=g("general"),this.name=g(""),this.wModel=ze(null,{alias:"wModel"}),this.wChange=L(),this._vf=x(ie),this._modal=x(Ee),this._fs=x(Ht),this._onChange=()=>{},this._onTouched=()=>{},this._disabledCva=!1,this.isDisabled=ce(()=>this.disabled()||this._disabledCva),this.files=ce(()=>{let t=this.wModel();return Array.isArray(t)?t:t?[t]:[]});let e=!1;U(()=>{let t=this.formId(),o=this.formKey();if(!t||!o)return;this._vf.registerField(t,o,null,[]);let a=this._vf.getValues(t)[o]??null;!e&&!this._equal(a,this.wModel())&&(e=!0,this.wModel.set(a),e=!1)}),U(()=>{let t=this.formId(),o=this.formKey();if(!t||!o)return;let a=this.wModel();this._equal(this._vf.getValues(t)[o],a)||this._vf.setValue(t,o,a??null)}),U(()=>{let t=this.wModel();this._onChange(t),this.wChange.emit(t)})}triggerPick(e){this.isDisabled()||e.click()}isImage(e){return/\.(png|jpe?g|webp|gif)(\?|$)/i.test(e??"")}onPicked(e){return W(this,null,function*(){let t=e.files;if(!t||!t.length)return;let o=!!(this.cropWidth()&&this.cropHeight()),a=[],s=this.container(),u=this.name();for(let I=0;I<t.length;I++){let X=t.item(I),q=yield tn(X);if(o)yield new Promise(Q=>{this._modal.show({component:qt,dataUrl:q,width:this.cropWidth(),height:this.cropHeight(),uploadImage:ee=>{this._fs.uploadBase64(ee,s,u).then(se=>{a.push(se),Q()})}})});else{let Q=yield this._fs.uploadBase64(q,s,u);a.push(Q)}}let b=this.multiple()?[...this.files(),...a]:a[0]??null;this.wModel.set(b),e.value="",this._onTouched()})}removeAt(e){if(!this.multiple()){this.wModel.set(null);return}let t=[...this.files()];t.splice(e,1),this.wModel.set(t.length?t:[])}clear(){this.wModel.set(this.multiple()?[]:null)}writeValue(e){this._equal(this.wModel(),e)||this.wModel.set(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._disabledCva=e}_equal(e,t){return Array.isArray(e)||Array.isArray(t)?JSON.stringify(e)===JSON.stringify(t):e===t}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ngx-file"]],inputs:{label:[1,"label"],placeholder:[1,"placeholder"],disabled:[1,"disabled"],clearable:[1,"clearable"],accept:[1,"accept"],multiple:[1,"multiple"],preview:[1,"preview"],cropWidth:[1,"cropWidth"],cropHeight:[1,"cropHeight"],t_item:[1,"t_item"],t_empty:[1,"t_empty"],formId:[1,"formId"],formKey:[1,"formKey"],container:[1,"container"],name:[1,"name"],wModel:[1,"wModel"]},outputs:{wModel:"wModelChange",wChange:"wChange"},features:[Re([{provide:ke,useExisting:Te(()=>i),multi:!0}])],decls:20,vars:15,consts:[["fileInput",""],["emptyTpl",""],["itemTpl",""],[1,"wfile"],[1,"wfile__label"],[1,"wfile__body"],[1,"wfile__list"],[1,"wfile__actions"],["type","file","hidden","",3,"change"],["type","button",1,"wfile__btn",3,"click","disabled"],[1,"material-icons"],["type","button",1,"wfile__btn","wfile__btn--ghost",3,"disabled"],[3,"ngTemplateOutlet"],[1,"wfile__empty"],[1,"wfile__item"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"wfile__name"],["alt","preview",1,"wfile__thumb",3,"src"],["type","button",1,"wfile__remove","material-icons",3,"click"],["type","button",1,"wfile__btn","wfile__btn--ghost",3,"click","disabled"]],template:function(t,o){if(t&1){let a=w();le(0)(1)(2)(3),l(4,"div",3),S(5,Qi,3,3,"div",4),l(6,"div",5)(7,"div",6),S(8,Xi,3,1)(9,Zi,3,0,"ul"),p(),l(10,"div",7)(11,"input",8,0),_("change",function(){d(a);let u=ae(12);return h(o.onPicked(u))}),p(),l(13,"button",9),_("click",function(){d(a);let u=ae(12);return h(o.triggerPick(u))}),l(14,"span",10),v(15,"upload_file"),p(),l(16,"span"),v(17),D(18,"translate"),p()(),S(19,en,6,4,"button",11),p()()()}if(t&2){let a=P(o.label());m(),P(o.placeholder()),m();let s=P(o.files());m();let u=P(o.isDisabled());m(),$("_disabled",u),m(),T(a?5:-1),m(3),T(s.length===0?8:9),m(3),we("accept",o.accept())("multiple",o.multiple()?"":null),m(2),C("disabled",u),m(4),j(N(18,13,"Browse")()),m(2),T(o.clearable()&&s.length?19:-1)}},dependencies:[Ce,xe],styles:["[_nghost-%COMP%]{display:block}.wfile._disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.wfile__label[_ngcontent-%COMP%]{margin-bottom:6px}.wfile__body[_ngcontent-%COMP%]{border:2px solid var(--c-text-primary);border-radius:12px;padding:12px;background:var(--c-bg-secondary);color:var(--c-text-primary)}.wfile__list[_ngcontent-%COMP%]{margin-bottom:10px}.wfile__list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}.wfile__empty[_ngcontent-%COMP%]{color:var(--c-text-primary);opacity:.8}.wfile__item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:6px 0;border-bottom:1px solid var(--c-border)}.wfile__item[_ngcontent-%COMP%]:last-child{border-bottom:0}.wfile__name[_ngcontent-%COMP%]{max-width:50%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.wfile__thumb[_ngcontent-%COMP%]{width:64px;height:64px;object-fit:cover;border-radius:8px;border:1px solid var(--c-border)}.wfile__remove[_ngcontent-%COMP%]{border:0;background:transparent;cursor:pointer;color:var(--c-text-primary);display:inline-flex;align-items:center;justify-content:center;border-radius:8px;padding:4px}.wfile__actions[_ngcontent-%COMP%]{display:flex;gap:8px}.wfile__btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:8px 12px;border-radius:10px;border:2px solid var(--c-primary);background:var(--c-primary);color:var(--c-white);cursor:pointer}.wfile__btn--ghost[_ngcontent-%COMP%]{background:transparent;color:var(--c-primary)}"],changeDetection:0});let r=i;return r})();function tn(r){return new Promise((i,n)=>{let e=new FileReader;e.onload=()=>i(e.result),e.onerror=n,e.readAsDataURL(r)})}var nn=["templateRef"];function on(r,i){if(r&1){let n=w();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("name",(n.props==null?null:n.props.Label)||"boolean")("focused",n.component.focused)("ngClass",n.component.class)}}var Qt=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Boolean",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(nn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","checkbox",3,"wChange","formId","formKey","label","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,on,1,6,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var rn=["templateRef"];function an(r,i){if(r&1){let n=w();l(0,"wbutton",1),_("click",function(){let t=d(n).$implicit;return c().invoke(t.props==null?null:t.props.Click),h(t.wClick())}),v(1),p()}if(r&2){let n=i.$implicit;C("disableSubmit",!0),m(),G(" ",n.props==null?null:n.props.Label," ")}}var Kt=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Button",this.templateRef)}invoke(e){typeof e=="function"&&e()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(rn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[3,"click","disableSubmit"]],template:function(t,o){t&1&&M(0,an,2,2,"ng-template",null,0,F)},dependencies:[me],encapsulation:2,changeDetection:0});let r=i;return r})();var sn=["templateRef"];function ln(r,i){if(r&1){let n=w();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("label",(n.props==null?null:n.props.Label)||"Code")("placeholder",(n.props==null?null:n.props.Placeholder)||"{ ... }")("name",(n.props==null?null:n.props.Label)||"code")("focused",n.component.focused)("ngClass",n.component.class)}}var Xt=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Code",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(sn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","textarea",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,ln,1,7,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var cn=["templateRef"];function pn(r,i){if(r&1){let n=w();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"date")("focused",n.component.focused)("ngClass",n.component.class)}}var Yt=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Date",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(cn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","date",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,pn,1,7,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var mn=["templateRef"];function dn(r,i){if(r&1){let n=w();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())})("wSubmit",function(){let t=d(n).$implicit;return h(t.wSubmit())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"email")("focused",n.component.focused)("ngClass",n.component.class)}}var Jt=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Email",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(mn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","email",3,"wChange","wSubmit","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,dn,1,7,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var hn=["templateRef"];function un(r,i){if(r&1){let n=w();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("label",(n.props==null?null:n.props.Label)||"HTML")("placeholder",(n.props==null?null:n.props.Placeholder)||"<p>...</p>")("name",(n.props==null?null:n.props.Label)||"html")("focused",n.component.focused)("ngClass",n.component.class)}}var Gt=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Html",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(hn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","textarea",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,un,1,7,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var _n=["templateRef"];function gn(r,i){if(r&1){let n=w();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"number")("focused",n.component.focused)("ngClass",n.component.class)}}var Zt=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Number",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(_n,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","number",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,gn,1,7,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var fn=["templateRef"];function Cn(r,i){if(r&1){let n=w();l(0,"div",1)(1,"winput",2),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())})("wSubmit",function(){let t=d(n).$implicit;return h(t.wSubmit())}),p(),l(2,"div",3)(3,"span",4),_("click",function(){let t=d(n).$implicit;return h(t.props&&(t.props.Show=!t.props.Show))}),v(4," visibility "),p()()()}if(r&2){let n=i.$implicit;m(),C("formId",n.wFormId)("formKey",n.wFormKey)("type",n.props!=null&&n.props.Show?"text":"password")("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"password")("focused",n.component.focused)("ngClass",n.component.class)}}var ei=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Password",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(fn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[1,"pass_container"],[3,"wChange","wSubmit","formId","formKey","type","label","placeholder","name","focused","ngClass"],[1,"eye"],[1,"material-icons",3,"click"]],template:function(t,o){t&1&&M(0,Cn,5,8,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var xn=["templateRef"];function wn(r,i){if(r&1){let n=w();l(0,"ngx-file",1),_("wChange",function(){let t=d(n).$implicit;return h((t==null?null:t.wChange)&&t.wChange())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("label",(n.props==null?null:n.props.Label)||"Photo")("accept",(n.props==null?null:n.props.Accept)||"image/*")("container",(n.props==null?null:n.props.Container)||n.wFormId)("name",(n.props==null?null:n.props.Name)||"")("multiple",!!(n.props!=null&&n.props.Multiple))("preview",(n.props==null?null:n.props.Preview)??!0)("clearable",(n.props==null?null:n.props.Clearable)??!0)("cropWidth",(n.props==null?null:n.props.Width)||null)("cropHeight",(n.props==null?null:n.props.Height)||null)}}var ti=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Photo",this.templateRef),this._form.addTemplateComponent("Photos",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(xn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[3,"wChange","formId","formKey","label","accept","container","name","multiple","preview","clearable","cropWidth","cropHeight"]],template:function(t,o){t&1&&M(0,wn,1,11,"ng-template",null,0,F)},dependencies:[jt],encapsulation:2,changeDetection:0});let r=i;return r})();var bn=()=>[],vn=r=>({item:r}),yn=(r,i)=>i.icon||i.text,Mn=(r,i)=>i().id;function Sn(r,i){if(r&1&&(l(0,"div",4),v(1),D(2,"translate"),p()),r&2){c();let n=f(1);m(),j(N(2,1,n)())}}function Tn(r,i){if(r&1&&(l(0,"div"),v(1),D(2,"translate"),p()),r&2){c(3);let n=f(0);m(),j(N(2,1,n)())}}function In(r,i){r&1&&(l(0,"span"),v(1,", "),p())}function Fn(r,i){if(r&1){let n=w();l(0,"span"),v(1),D(2,"translate"),l(3,"i",14),_("click",function(){d(n);let t=c().$index,o=c(3);return h(o.removeItem(t))}),v(4,"close"),p()()}if(r&2){let n=c().$implicit,e=c(3);m(),G(" ",N(2,1,e.allItem[n])()," ")}}function Vn(r,i){if(r&1&&(l(0,"span"),S(1,In,2,0,"span"),S(2,Fn,5,3,"span"),p()),r&2){let n=i.$implicit,e=i.$index,t=c(3);m(),T(e&&t.allItem[n]?1:-1),m(),T(t.allItem[n]?2:-1)}}function Rn(r,i){if(r&1&&(l(0,"div",13),S(1,Tn,3,3,"div"),Y(2,Vn,3,2,"span",null,te),p()),r&2){c(2);let n=f(3);m(),T(n.length?-1:1),m(),J(n)}}function On(r,i){if(r&1&&(l(0,"div",13),v(1),D(2,"translate"),p()),r&2){let n=c(2),e=f(0),t=f(4);m(),G(" ",N(2,1,t?n.allItem[t]:e)()," ")}}function Pn(r,i){if(r&1&&(l(0,"div",12),S(1,Rn,4,1,"div",13)(2,On,3,3,"div",13),p()),r&2){c();let n=f(2);m(),T(n?1:2)}}function zn(r,i){if(r&1){let n=w();l(0,"div",10),_("click",function(){d(n);let t=c();return h(t.clear())}),v(1,"close"),p()}}function kn(r,i){if(r&1){let n=w();l(0,"i",15),_("click",function(){d(n);let t=c().$implicit;return h(t.click())}),v(1),p()}if(r&2){let n=c().$implicit;m(),j(n.icon)}}function Dn(r,i){if(r&1){let n=w();l(0,"span",16),_("click",function(){d(n);let t=c().$implicit;return h(t.click())}),v(1),p()}if(r&2){let n=c().$implicit;m(),j(n.text)}}function En(r,i){if(r&1&&S(0,kn,2,1,"i",7)(1,Dn,2,1,"span"),r&2){let n=i.$implicit;T(n.icon?0:n.text?1:-1)}}function Ln(r,i){if(r&1){let n=w();l(0,"winput",21),D(1,"translate"),_("wChange",function(t){d(n);let o=c(3);return h(o.search.set((t??"")+""))}),p()}r&2&&C("placeholder",Ct(N(1,3,"Enter search text...")()))("focused",!0)}function An(r,i){if(r&1&&(l(0,"div"),re(1,8),M(2,Ln,2,5,"ng-template",null,2,F),p()),r&2){let n=ae(3),e=c(2);m(),C("ngTemplateOutlet",e.t_search()?e.t_search():n)}}function Bn(r,i){if(r&1&&re(0,19),r&2){let n=i.$implicit;c();let e=ae(9),t=c();C("ngTemplateOutlet",t.t_item()?t.t_item():e)("ngTemplateOutletContext",Pe(2,vn,n))}}function Nn(r,i){r&1&&(l(0,"div",20),v(1," Nothing was found "),p())}function Hn(r,i){if(r&1&&(v(0),D(1,"translate")),r&2){let n=c().item,e=c(2);G(" ",N(1,1,n()[e.bindLabel()])()," ")}}function Wn(r,i){r&1&&(v(0),D(1,"translate")),r&2&&G(" ",N(1,1,"Unknown item")()," ")}function $n(r,i){if(r&1){let n=w();l(0,"div",22),_("click",function(){let t=d(n).item,o=c(2);return h(o.selectOption(t()))}),l(1,"div",23),S(2,Hn,2,3)(3,Wn,2,3),p()()}if(r&2){let n=i.item,e=c(2),t=f(2),o=f(3),a=n().id;m(),$("selected",t?o.includes(a):!1),m(),T(n()[e.bindLabel()]?2:3)}}function Un(r,i){if(r&1&&(l(0,"div",17),S(1,An,4,1,"div"),l(2,"div",18),Y(3,Bn,1,4,"ng-container",19,Mn),D(5,"search"),S(6,Nn,2,0,"div",20),D(7,"search"),p(),M(8,$n,4,3,"ng-template",null,1,F),p()),r&2){let n;c();let e=f(5),t=f(6),o=f(7),a=f(8);$("_search",e),m(),T(e?1:-1),m(2),J(Ke(5,4,t,a,o+" __search")),m(3),T((n=Ke(7,8,t,a,o+" __search"))!=null&&n.length?-1:6)}}var ii=(()=>{let i=class i{constructor(){this.disabled=g(!1),this.clearable=g(!1),this.placeholder=g(""),this.multiple=g(!1),this.bindLabel=g("name"),this.bindValue=g("_id"),this.label=g(""),this.searchable=g(!1),this.searchableBy=g("name"),this.items=g([]),this.buttons=g([]),this.t_view=g(),this.t_item=g(),this.t_search=g(),this.formId=g(null),this.formKey=g(null),this.wModel=ze(null,{alias:"wModel"}),this.wChange=L(),this._core=x(pe),this._vform=x(ie),this.allItem={},this.allItems=k(this._core.toSignalsArray([])),this.showOptions=k(!1),this.search=k(""),this.isMulti=ce(()=>this.multiple()),this._disabledCva=!1,this.isDisabled=ce(()=>this.disabled()||this._disabledCva),this.selectedIds=ce(()=>{let t=this.wModel();return this.isMulti()?Array.isArray(t)?t:[]:t==null?[]:[t]}),this.selectedId=ce(()=>this.selectedIds()[0]??null),this._onChange=()=>{},this._onTouched=()=>{},U(()=>{let t=this.items();this.allItems.update(()=>t.map(s=>{let u={name:typeof s=="object"?s[this.bindLabel()]:s,id:typeof s=="object"?s[this.bindValue()]:s};return this.allItem[u.id]=u.name,this._core.toSignal(u)}));let o=new Set(this.allItems().map(s=>s().id)),a=this.wModel();if(this.isMulti()){let s=(Array.isArray(a)?a:[]).filter(u=>o.has(u));JSON.stringify(s)!==JSON.stringify(a)&&this.wModel.set(s)}else a!=null&&!o.has(a)&&this.wModel.set(null)});let e=!1;U(()=>{let t=this.formId(),o=this.formKey();if(!t||!o)return;this._vform.registerField(t,o,null,[]);let a=this._vform.getValues(t)[o]??null;!e&&!this._equal(a,this.wModel())&&(e=!0,this.wModel.set(a),e=!1)}),U(()=>{let t=this.formId(),o=this.formKey();if(!t||!o)return;let a=this.wModel();!e&&!this._equal(this._vform.getValues(t)[o],a)&&(e=!0,this._vform.setValue(t,o,a??null),e=!1)}),U(()=>{let t=this.wModel();this._onChange(t),this.wChange.emit(t)})}toggleOptions(e=!this.showOptions()){this.isDisabled()||this.showOptions.set(e)}selectOption(e){if(this.isMulti()){let t=new Set(this.selectedIds());t.has(e.id)?t.delete(e.id):t.add(e.id),this.wModel.set([...t])}else this.wModel.set(e.id),this.showOptions.set(!1);this._onTouched()}removeItem(e){if(!this.isMulti())return;let t=[...this.selectedIds()];t.splice(e,1),this.wModel.set(t)}clear(){this.wModel.set(this.isMulti()?[]:null)}writeValue(e){this._equal(this.wModel(),e)||this.wModel.set(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._disabledCva=e}_equal(e,t){return Array.isArray(e)||Array.isArray(t)?JSON.stringify(e)===JSON.stringify(t):e===t}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["wselect"]],inputs:{disabled:[1,"disabled"],clearable:[1,"clearable"],placeholder:[1,"placeholder"],multiple:[1,"multiple"],bindLabel:[1,"bindLabel"],bindValue:[1,"bindValue"],label:[1,"label"],searchable:[1,"searchable"],searchableBy:[1,"searchableBy"],items:[1,"items"],buttons:[1,"buttons"],t_view:[1,"t_view"],t_item:[1,"t_item"],t_search:[1,"t_search"],formId:[1,"formId"],formKey:[1,"formKey"],wModel:[1,"wModel"]},outputs:{wModel:"wModelChange",wChange:"wChange"},features:[Re([{provide:ke,useExisting:Te(()=>i),multi:!0}])],decls:24,vars:20,consts:[["defaultView",""],["defaultItem",""],["defaultSearch",""],[1,"wselect",3,"clickOutside"],[1,"wselect__label"],[1,"wselect__body"],[1,"wselect__header",3,"click"],[1,"material-icons"],[3,"ngTemplateOutlet"],[1,"wselect__arrow","material-icons"],[1,"wselect__arrow","material-icons",3,"click"],[1,"wselect__popup",3,"_search"],[1,"wselect__text"],[1,"text-overflow"],[1,"material-icons","avatar__icon",3,"click"],[1,"material-icons",3,"click"],[3,"click"],[1,"wselect__popup"],[1,"popup-block"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["translate","",1,"popup-block__empty-search"],[3,"wChange","placeholder","focused"],[1,"item",3,"click"],[1,"item__text"]],template:function(t,o){if(t&1){let a=w();le(0)(1)(2)(3)(4)(5)(6)(7)(8),l(9,"div",3),_("clickOutside",function(){return d(a),h(o.toggleOptions(!1))}),S(10,Sn,3,3,"div",4),l(11,"div",5)(12,"div",6),_("click",function(){return d(a),h(o.toggleOptions())}),l(13,"span",7),v(14,"unfold_more"),p(),re(15,8),M(16,Pn,3,1,"ng-template",null,0,F),p(),S(18,zn,2,0,"div",9),l(19,"div",10),_("click",function(){return d(a),h(o.toggleOptions())}),v(20," expand_more "),p(),Y(21,En,2,1,null,null,yn),S(23,Un,10,12,"div",11),p()()}if(t&2){let a=ae(17),s=o.showOptions();P(o.placeholder()),m();let u=P(o.label());m();let b=P(o.isMulti());m();let I=P(o.selectedIds());m();let X=P(o.selectedId());m(),P(o.searchable()),m(),P(o.allItems()),m(),P(o.searchableBy()),m(),P(o.search()),m(2),T(u?10:-1),m(),$("_disabled",o.isDisabled())("_active",s),m(4),C("ngTemplateOutlet",o.t_view()?o.t_view():a),m(3),T(o.clearable()&&(b?I.length:X)?18:-1),m(),$("_active",s),m(2),J(o.buttons()||Oe(19,bn)),m(2),T(s?23:-1)}},dependencies:[Ce,Bt,H,Pt,zt,xe],styles:["[_nghost-%COMP%]{display:block}._disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.wselect[_ngcontent-%COMP%]{width:100%}.wselect__label[_ngcontent-%COMP%]{margin-bottom:5px}.wselect__body[_ngcontent-%COMP%]{position:relative;cursor:pointer;display:flex;min-height:50px;height:50px;align-items:center;border:2px solid var(--c-text-primary);border-radius:12px;transition:var(--transition)}.wselect__body._active[_ngcontent-%COMP%]{border-color:var(--c-primary)}.wselect__header[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;overflow:hidden;white-space:nowrap;position:relative}.wselect__text[_ngcontent-%COMP%]{margin-right:10px;flex-grow:1;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.wselect__text[_ngcontent-%COMP%]   .text-overflow[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;word-break:keep-all;color:var(--c-text-primary)}.wselect__arrow[_ngcontent-%COMP%]{margin-right:15px;transition:var(--transition);display:flex;align-items:center;justify-content:center;border-radius:50%}.wselect__arrow._active[_ngcontent-%COMP%]{transform:rotate(180deg)}.wselect[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:var(--c-text-primary)}.wselect[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding:10px;transition:var(--transition);border-bottom:1px solid var(--c-text-primary)}.wselect[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{background:var(--c-shadow);border-bottom:1px solid var(--c-primary);color:var(--c-primary)}.wselect__popup[_ngcontent-%COMP%]{z-index:9;width:100%;left:0;position:absolute;top:calc(100% + 10px);background:var(--c-white);box-shadow:0 0 4px var(--c-border);border-radius:10px;border:2px solid var(--c-primary);background:var(--c-bg-secondary);color:var(--c-text-primary);padding-bottom:15px;padding-top:15px}.wselect__popup._search[_ngcontent-%COMP%]{padding-top:60px}.wselect__popup[_ngcontent-%COMP%]   .popup-block[_ngcontent-%COMP%]{max-height:180px;overflow-y:auto;padding:0 15px;margin-right:10px}.wselect__popup[_ngcontent-%COMP%]   .popup-block__empty-search[_ngcontent-%COMP%]{padding:15px;text-align:center;color:var(--c-text-primary)}.wselect__search[_ngcontent-%COMP%]{top:10px;position:absolute;display:flex;justify-content:center;align-items:center;width:100%;left:0;padding:0 15px}.wselect[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px;height:5px;background-color:var(--c-white)}.wselect[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:0;background-color:var(--c-border)}.selected[_ngcontent-%COMP%]{font-weight:700}"],changeDetection:0});let r=i;return r})();var qn=["templateRef"];function jn(r,i){if(r&1){let n=w();l(0,"wselect",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("multiple",(n.props==null?null:n.props.Multiple)||!1)("placeholder",n.props==null?null:n.props.Placeholder)("bindValue",(n.props==null?null:n.props.Value)||"_id")("bindLabel",(n.props==null?null:n.props.Name)||"name")("ngClass",n.component.class)("items",n.props==null?null:n.props.Items)("searchable",!0)}}var ni=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Select",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(qn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[3,"wChange","formId","formKey","multiple","placeholder","bindValue","bindLabel","ngClass","items","searchable"]],template:function(t,o){t&1&&M(0,jn,1,9,"ng-template",null,0,F)},dependencies:[ii,A],encapsulation:2});let r=i;return r})();var Qn=["templateRef"];function Kn(r,i){if(r&1){let n=w();l(0,"div",1)(1,"winput",2),_("wChange",function(t){let o=d(n).$implicit;return h(o.props.__name=t)})("wSubmit",function(){let t=d(n).$implicit,o=c();return h(o.addTag(t))}),p(),K(2,"div",3),l(3,"wbutton",4),_("click",function(){let t=d(n).$implicit,o=c();return h(o.addTag(t))}),v(4),p()()}if(r&2){let n=i.$implicit;m(),C("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder),m(2),C("disableSubmit",!0),m(),G(" ",(n.props==null?null:n.props.Button)||"Add"," ")}}var oi=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Tags",this.templateRef)}addTag(e){let t=e.props?.__name;t&&(Array.isArray(e.props.__buffer)&&e.props.__buffer.push(t),e.props.__name="",setTimeout(()=>e.wChange()))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(Qn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[1,"tags"],[3,"wChange","wSubmit","label","placeholder"],[1,"tags__list"],[3,"click","disableSubmit"]],template:function(t,o){t&1&&M(0,Kn,5,4,"ng-template",null,0,F)},dependencies:[H,me],encapsulation:2});let r=i;return r})();var Xn=["templateRef"];function Yn(r,i){if(r&1){let n=w();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())})("wSubmit",function(){let t=d(n).$implicit;return h(t.wSubmit())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("type",n.props!=null&&n.props.Textarea?"textarea":"text")("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"name")("focused",n.component.focused)("ngClass",n.component.class)}}var ri=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Text",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(Xn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],[3,"wChange","wSubmit","formId","formKey","type","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,Yn,1,8,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var Jn=["templateRef"];function Gn(r,i){if(r&1){let n=w();l(0,"winput",1),_("wChange",function(){let t=d(n).$implicit;return h(t.wChange())}),p()}if(r&2){let n=i.$implicit;C("formId",n.wFormId)("formKey",n.wFormKey)("label",n.props==null?null:n.props.Label)("placeholder",n.props==null?null:n.props.Placeholder)("name",(n.props==null?null:n.props.Label)||"time")("focused",n.component.focused)("ngClass",n.component.class)}}var ai=(()=>{let i=class i{constructor(){this._form=x(z)}ngOnInit(){this._form.addTemplateComponent("Time",this.templateRef)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&V(Jn,7),t&2){let a;R(a=O())&&(o.templateRef=a.first)}},decls:2,vars:0,consts:[["templateRef",""],["type","time",3,"wChange","formId","formKey","label","placeholder","name","focused","ngClass"]],template:function(t,o){t&1&&M(0,Gn,1,7,"ng-template",null,0,F)},dependencies:[H,A],encapsulation:2});let r=i;return r})();var si={Email:Jt,Boolean:Qt,Button:Kt,Code:Xt,Date:Yt,Html:Gt,Number:Zt,Password:ei,Photo:ti,Select:ni,Tags:oi,Text:ri,Time:ai};var Zn=()=>({}),eo=(r,i,n,e,t,o,a,s)=>({props:r,config:i,component:n,wFormId:e,wFormKey:t,wSubmit:o,wChange:a,wClick:s}),to=r=>({$implicit:r});function io(r,i){if(r&1){let n=w();l(0,"form-component",3),_("wSubmit",function(){d(n);let t=c(3);return h(t.wSubmit.emit(t.submition()))})("wChange",function(){d(n);let t=c(3);return h(t.wChange.emit())})("wClick",function(){d(n);let t=c(3);return h(t.wClick.emit())}),p()}if(r&2){let n=c(),e=n.$implicit,t=n.$index,o=c(2);fe(Ve("wformc__item ",o.config().formId," ",o.config().formId+"_"+o.index()+"_"+t," ",e.class||"")),C("component",e)("config",o.config())("submition",o.submition())("index",o.index()+"_"+t)}}function no(r,i){if(r&1&&S(0,io,1,9,"form-component",2),r&2){let n=i.$implicit;T(n.hidden?-1:0)}}function oo(r,i){if(r&1&&(l(0,"div"),Y(1,no,1,1,null,null,te),p()),r&2){let n=c();fe(Fe("wformc ",n.component().class||"")),m(),J(n.component().components)}}function ro(r,i){r&1&&re(0)}function ao(r,i){if(r&1&&(l(0,"div",1),M(1,ro,1,0,"ng-container",4),p()),r&2){let n=c();m(),C("ngTemplateOutlet",n.template())("ngTemplateOutletContext",Pe(12,to,wt(3,eo,n.component().props||Oe(2,Zn),n.config(),n.component(),n.config().formId,n.effectiveKey(),n.submit.bind(n),n.change.bind(n),n.click.bind(n))))}}var li=(()=>{let i=class i{constructor(){this._form=x(z),this.index=g(""),this.config=g.required(),this.component=g.required(),this.submition=g({}),this.wSubmit=L(),this.wChange=L(),this.wClick=L(),this.template=k(null),U(()=>{let e=this.component().name;this.template.set(e&&this._form.getTemplateComponent(e)||null)})}hasChildren(){return Array.isArray(this.component().components)}effectiveKey(){let e=this.component().key;if(!e)return null;if(!e.includes("[]"))return e;let t=(this.index()||"").split("_").pop()||"0",o=Number.isFinite(+t)?+t:0;return e.replace(/\[\]/g,`[${o}]`)}submit(){this.wSubmit.emit(this.submition())}change(){this.wChange.emit()}click(){this.wClick.emit()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["form-component"]],inputs:{index:[1,"index"],config:[1,"config"],component:[1,"component"],submition:[1,"submition"]},outputs:{wSubmit:"wSubmit",wChange:"wChange",wClick:"wClick"},decls:2,vars:1,consts:[[3,"class"],[1,"wformc"],[3,"class","component","config","submition","index"],[3,"wSubmit","wChange","wClick","component","config","submition","index"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,o){t&1&&S(0,oo,3,3,"div",0)(1,ao,2,14,"div",1),t&2&&T(o.hasChildren()?0:o.component().name&&o.template()&&o.effectiveKey()?1:-1)},dependencies:[i,Ce],styles:["[_nghost-%COMP%]{display:block;position:relative}.wformc[_ngcontent-%COMP%]{position:relative;padding:0}.wformc__item[_ngcontent-%COMP%]{display:block;margin:0 0 10px}"],changeDetection:0});let r=i;return r})();function so(r,i){if(r&1&&(l(0,"h1",0),v(1),p()),r&2){c();let n=f(0);m(),j(n.title)}}function lo(r,i){if(r&1){let n=w();l(0,"form-component",3),_("wSubmit",function(){d(n);let t=c(2);return h(t.onSubmit())})("wChange",function(){d(n);let t=c(2);return h(t.onLegacyChange())})("wClick",function(){d(n);let t=c(2);return h(t.onClick())}),p()}if(r&2){let n=c(),e=n.$implicit,t=n.$index;c();let o=f(0),a=f(1);fe(Ve("wform__component ",o.formId," ",o.formId+"_"+t," ",e.class||"")),C("component",e)("config",o)("submition",a)("index",""+t)}}function co(r,i){if(r&1&&S(0,lo,1,9,"form-component",2),r&2){let n=i.$implicit;T(n.hidden?-1:0)}}var We=(()=>{let i=class i{constructor(){this._core=x(pe),this._virtualFormService=x(ie),this.config=g.required(),this.submition=g({}),this.wChange=L(),this.wSubmit=L(),this._formId=k(""),this._unsubFns=[]}ngAfterViewInit(){this.submition()&&(this.submition().data=this.submition().data||{}),U(()=>{let e=this.config(),t=e?.formId||crypto.randomUUID();this._formId.set(t),this._virtualFormService.getForm(t),(e?.components||[]).forEach(s=>this._registerFromSchema(t,s));let o=this.submition();o&&Object.keys(o).length&&this._virtualFormService.patch(t,o),this._clearHandlers(),this._virtualFormService.setHandler(t,"onValidSubmit",s=>this.wSubmit.emit(s)),this._virtualFormService.setHandler(t,"onInvalidSubmit",(s,u)=>this._emitLegacyChange(u)),this._virtualFormService.setHandler(t,"onPatch",()=>{this._emitLegacyChange(this._virtualFormService.getValues(t))});let a=()=>{this._core.afterWhile(this,()=>{this._emitLegacyChange(this._virtualFormService.getValues(t))})};this._virtualFormService.addListener(t,"onFieldChange",a),this._unsubFns.push(()=>this._virtualFormService.removeListener(t,"onFieldChange",a))})}ngOnDestroy(){this._clearHandlers();let e=this._formId();e&&this._virtualFormService.destroyForm(e)}onSubmit(){let e=this._formId();this._virtualFormService.submit(e)}onLegacyChange(){let e=this._formId();this._core.afterWhile(this,()=>{this._emitLegacyChange(this._virtualFormService.getValues(e))})}onClick(){}_emitLegacyChange(e){this.wChange.emit(e||{})}_registerFromSchema(e,t){if(Array.isArray(t.components)&&t.components.length){t.components.forEach(s=>this._registerFromSchema(e,s));return}if(!t.key)return;let o=(this.submition()||{})[t.key],a=[t.props&&t.props.Required?Ae():null,...t.validators||[]].filter(Boolean);this._virtualFormService.registerField(e,t.key,o,a||[])}_clearHandlers(){this._unsubFns.forEach(t=>t()),this._unsubFns=[];let e=this._formId();e&&this._virtualFormService.clearHandlers(e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["wform"]],inputs:{config:[1,"config"],submition:[1,"submition"]},outputs:{wChange:"wChange",wSubmit:"wSubmit"},decls:7,vars:6,consts:[[1,"wform__title"],[1,"wform__body",3,"ngSubmit"],[3,"class","component","config","submition","index"],[3,"wSubmit","wChange","wClick","component","config","submition","index"]],template:function(t,o){if(t&1){let a=w();le(0)(1),l(2,"div"),S(3,so,2,1,"h1",0),l(4,"form",1),_("ngSubmit",function(){return d(a),h(o.onSubmit())}),Y(5,co,1,1,null,null,te),p()()}if(t&2){let a=P(o.config());m(),P(o.submition()),m(),fe(Fe("wform ",(a==null?null:a.class)||"")),m(),T(a!=null&&a.title?3:-1),m(2),J(a==null?null:a.components)}},dependencies:[li],styles:[".wform[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;row-gap:12px;width:100%}.wform__title[_ngcontent-%COMP%]{margin:0 0 10px;color:var(--c-text-primary);font-weight:600;font-size:20px;line-height:1.2;letter-spacing:var(--letter-spacing, 0)}.wform__body[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:12px;width:100%}.wform__component[_ngcontent-%COMP%]{display:block;width:100%}.wform__input[_ngcontent-%COMP%], .wform__textarea[_ngcontent-%COMP%], .wform__select[_ngcontent-%COMP%]{width:100%;display:block;border:1px solid var(--c-border);border-radius:var(--b-radius, 8px);background:transparent;color:var(--c-text-secondary);font-size:var(--fs, 16px);line-height:1.25;padding:10px 12px;transition:var(--transition, .15s ease)}.wform__input[_ngcontent-%COMP%]::placeholder, .wform__textarea[_ngcontent-%COMP%]::placeholder, .wform__select[_ngcontent-%COMP%]::placeholder{color:var(--c-placeholder);transition:inherit}.wform__input[_ngcontent-%COMP%]:focus, .wform__textarea[_ngcontent-%COMP%]:focus, .wform__select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--c-primary)}.wform__input[_ngcontent-%COMP%]:disabled, .wform__textarea[_ngcontent-%COMP%]:disabled, .wform__select[_ngcontent-%COMP%]:disabled{background:var(--c-grey);border-color:var(--c-grey);color:var(--c-grey);opacity:.6;cursor:default}.wform__textarea[_ngcontent-%COMP%]{min-height:88px;resize:vertical}.wform__select[_ngcontent-%COMP%]{appearance:none;padding-right:30px;position:relative}.wform--two-col[_ngcontent-%COMP%]   .wform__body[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}@media (max-width: 768px){.wform__body[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"],changeDetection:0});let r=i;return r})();function po(r,i){if(r&1){let n=w();l(0,"wbutton",4),_("click",function(){let t=d(n).$implicit,o=c();return h(o.onButtonClick(t))}),v(1),p()}if(r&2){let n=i.$implicit,e=c();C("ngClass",n.class)("disabled",e.submitting()),m(),G(" ",n.label," ")}}var Ge=(()=>{let i=class i{constructor(){this._core=x(pe),this.submit=e=>{},this.change=e=>{},this.submitting=k(!1)}_sync(e){this._core.copy(e,this.submition),this._core.copy(e.data,this.submition.data)}handleSubmit(){this.submitting.set(!0);try{this._sync(this.submition),this.submit(this.submition),this.close()}finally{this.submitting.set(!1)}}handleChange(){this._sync(this.submition),this.change(this.submition)}onButtonClick(e){this.submitting()||e.click(this.submition,this.close)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],decls:5,vars:2,consts:[["formRef",""],[3,"wSubmit","wChange","config","submition"],[1,"modal-actions"],[1,"w-btn","_primary",3,"ngClass","disabled"],[1,"w-btn","_primary",3,"click","ngClass","disabled"]],template:function(t,o){if(t&1){let a=w();l(0,"wform",1,0),_("wSubmit",function(){return d(a),h(o.handleSubmit())})("wChange",function(){return d(a),h(o.handleChange())}),p(),l(2,"div",2),Y(3,po,2,3,"wbutton",3,te),p()}t&2&&(C("config",o.form)("submition",o.submition),m(3),J(o.modalButtons))},dependencies:[We,me,A],styles:[".modal-actions[_ngcontent-%COMP%]{padding:30px 0 0}.modal-actions[_ngcontent-%COMP%]   .w-btn[_ngcontent-%COMP%]{width:100%;display:block}"]});let r=i;return r})();var ci=(()=>{let i=class i{constructor(){this._http=x(De),this.form=g.required(),this.module=g.required(),this.field=g.required(),this.doc=g.required()}get getDoc(){return this.doc()}change(){this._http.post(`/api/${this.module()}/unique${this.field()||""}`,this.doc()).subscribe(e=>{this.doc()[this.field()]!==e&&(this.doc()[this.field()]=e)})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=y({type:i,selectors:[["ng-component"]],inputs:{form:[1,"form"],module:[1,"module"],field:[1,"field"],doc:[1,"doc"]},decls:1,vars:2,consts:[[3,"wChange","config","submition"]],template:function(t,o){t&1&&(l(0,"wform",0),_("wChange",function(){return o.change()}),p()),t&2&&C("config",o.form())("submition",o.getDoc)},dependencies:[We],encapsulation:2,changeDetection:0});let r=i;return r})();var z=(()=>{let i=class i{constructor(){this._translate=x(Le),this.appRef=x(ht),this._modal=x(Ee),this._store=x(Dt),this._emitterService=x(kt),this._vform=x(ie),this.appId=At.appId,this._templateComponent={},this.templateFields={},this.customTemplateFields={},this.forms=[],this.formIds=[],this._addedFormComponent={},this._store.getJson("formIds",e=>{Array.isArray(e)&&this.formIds.push(...e)})}addTemplateComponent(e,t){this._templateComponent[e]||(this._templateComponent[e]=t)}getTemplateComponent(e){return this._templateComponent[e]}getTemplateComponentsNames(){return Object.keys(this._templateComponent)}getTemplateFields(e){return this.templateFields[e]||["Placeholder","Label"]}setTemplateFields(e,t,o={}){this.templateFields[e]=t,this.customTemplateFields[e]=B(B({},this.customTemplateFields[e]||{}),o)}getCustomTemplateFields(e){return this.customTemplateFields[e]||{}}translateForm(e){if(e.title){let t=this._translate.translate(`${e.title}`);U(()=>e.title=t())}this._translateComponents(e.components)}_translateComponents(e=[]){for(let t of e){if(t.props){for(let[o,a]of Object.entries(t.props))if(typeof a=="string"){let s=this._translate.translate(`${a}`);U(()=>t.props[o]=s())}else if(Array.isArray(a)){let s=a;s.forEach((u,b)=>{if(typeof u=="string"){let I=this._translate.translate(`${u}`);U(()=>s[b]=I())}})}}Array.isArray(t.components)&&t.components.length&&this._translateComponents(t.components)}}getDefaultForm(e,t=["name","description"]){this._rememberFormId(e);let o=t.map((a,s)=>{let u=a.includes(".")?a.split(".")[1]:"Text",b=(a.split(".")[0]||a).replace(/\[\]|\[\d+\]/g,"");return{name:u,key:a,focused:s===0,props:{Placeholder:`Enter your ${b}`,Label:b.charAt(0).toUpperCase()+b.slice(1)}}});return{formId:e,components:o}}prepareForm(e){let t=`${e.formId??""}`;return this._rememberFormId(t),e=e||this.getDefaultForm(t),e.formId=t,this._emitterService.onComplete("form_loaded").subscribe(()=>{this.translateForm(e),this._addFormComponents(e.components),this.ensureVirtualForm(e)}),this.translateForm(e),this._addFormComponents(e.components),this.ensureVirtualForm(e),e}ensureVirtualForm(e,t){let o=e.formId||crypto.randomUUID();this._vform.getForm(o);let a=(s=[])=>{for(let u of s){if(u.components?.length){a(u.components);continue}if(!u.key)continue;let b=(t||{})[u.key]??null,I=[u.props&&u.props.Required?Ae():null,...u.validators||[]].filter(Boolean);this._vform.registerField(o,u.key,b,I)}};a(e.components),t&&Object.keys(t).length&&this._vform.patch(o,t)}modal(e,t=[],o={data:{}},a=u=>{},s={}){return(Array.isArray(e)?e:[e]).forEach(b=>this.ensureVirtualForm(b,o)),new Promise(b=>{this._modal.show(oe(B({},s),{component:Ge,class:"forms_modal",size:"big",form:e,modalButtons:Array.isArray(t)?t:[t],submition:o,onClose:()=>b(o),submit:I=>b(I),change:I=>{typeof a=="function"&&a(I)}}))})}modalDocs(e){return new Promise(t=>{let o={docs:JSON.stringify(e.length?e:[],null,4)};this._modal.show({component:Ge,class:"forms_modal",size:"big",submition:o,form:{title:"Modify content of documents",components:[{name:"Code",key:"docs",props:{Placeholder:"fill content of documents"}}]},onClose:()=>{let a=o.docs?JSON.parse(o.docs):[];t(a)},submit:()=>{let a=o.docs?JSON.parse(o.docs):[];t(a)}})})}modalUnique(e,t,o,a="",s=()=>{}){let u=this.getDefaultForm("unique",[t+(a?"."+a:"")]);this.ensureVirtualForm(u,o),this._modal.show({component:ci,form:u,module:e,field:t,doc:o,class:"forms_modal",onClose:s})}getComponent(e,t){return this._getComponent(e.components,t)||{}}getProp(e,t,o){return this.getComponent(e,t)?.props?.[o]??null}setProp(e,t,o,a){let s=this.getComponent(e,t);s&&(s.props=s.props||{},s.props[o]=a)}_getComponent(e,t){for(let o of e||[]){if(o.key===t)return o;if(o.components?.length){let a=this._getComponent(o.components,t);if(a)return a}}return null}_addFormComponents(e){return W(this,null,function*(){for(let t of e||[])t.name&&(yield this._addFormComponent(t.name)),t.components?.length&&(yield this._addFormComponents(t.components))})}_addFormComponent(e){return W(this,null,function*(){let t=si[e];if(t&&!this._addedFormComponent[e]){this._addedFormComponent[e]=!0;let o=vt(t,{environmentInjector:this.appRef.injector});this.appRef.attachView(o.hostView),o.hostView.detectChanges?.()}})}_rememberFormId(e){e&&(this.formIds.includes(e)||(this.formIds.push(e),this._store.setJson("formIds",this.formIds)))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=_e({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();export{xe as a,H as b,jt as c,ii as d,z as e,We as f};
