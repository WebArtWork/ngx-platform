import{b as D}from"./chunk-3XSUABL3.js";import"./chunk-BJZLS4P7.js";import"./chunk-T6CMCPX7.js";import"./chunk-AEEX7I5M.js";import"./chunk-P54445ST.js";import{a as C,b as S,c as P,e as m,h as O}from"./chunk-INPKZIN2.js";import"./chunk-EKLJLNLC.js";import"./chunk-XQJPQ7LG.js";import{b as k}from"./chunk-XDLC4A3K.js";import"./chunk-MQXU7KO6.js";import{a as I}from"./chunk-WIHX7NDF.js";import{a as V}from"./chunk-73YO2PIT.js";import{p as T}from"./chunk-4NITVLUQ.js";import{B as v,Fa as h,G as b,H as w,Ha as d,Ja as p,O as g,Wa as f,Y as r,ba as M,na as a,oa as l,pa as E,qa as F,tb as y,va as c,wa as i,xa as o}from"./chunk-VOU2RNQA.js";import{a as _,b as x}from"./chunk-FDERIQAA.js";var N=P(t=>{m(t.name,{message:"Enter your name..."}),m(t.email,{message:"Enter your email..."})}),z=P(t=>{m(t.currentPassword,{message:"Enter your current password..."}),m(t.newPassword,{message:"Enter your new password..."}),m(t.confirmPassword,{message:"Confirm your new password..."})});function U(t,A){if(t&1){let e=h();i(0,"div",5)(1,"ngx-file",7),d("wImageChange",function(n){b(e);let u=p();return w(u.updateThumb(n||""))}),o(),i(2,"form",8),d("submit",function(n){return b(e),p().wFormSubmit(),w(n.preventDefault())}),i(3,"winput",9),a(),o(),i(4,"winput",10),a(),o(),i(5,"winput",11),a(),o(),i(6,"winput",12),a(),o(),i(7,"wbutton",13),f(8," Update "),o()()()}if(t&2){let e=p();r(),c("wImage",e.userService.thumb())("container","user")("name",e.userService.user()._id+".jpg")("accept","image/*")("clearable",!1)("preview",!0)("cropWidth",512)("cropHeight",512),r(2),l(e.profileForm.name),r(),l(e.profileForm.email),r(),l(e.profileForm.phone),r(),l(e.profileForm.bio),r(),c("disabled",e.isSubmitDisabled())}}function j(t,A){if(t&1){let e=h();i(0,"div",6)(1,"form",8),d("submit",function(n){return b(e),p().wSecuritySubmit(),w(n.preventDefault())}),i(2,"winput",14),a(),o(),i(3,"winput",15),a(),o(),i(4,"winput",16),a(),o(),i(5,"wbutton",13),f(6," Update password "),o()()()}if(t&2){let e=p();r(2),l(e.securityForm.currentPassword),r(),l(e.securityForm.newPassword),r(),l(e.securityForm.confirmPassword),r(),c("disabled",e.isSecurityDisabled())}}var ee=(()=>{class t{constructor(){this.userService=v(I),this._emitterService=v(T),this._alertService=v(V),this.activeTab=g("profile",{}),this.profileModel=g({name:this.userService.user().name||"",email:this.userService.user().email||"",phone:this.userService.user().phone||"",bio:this.userService.user().bio||""},{}),this.profileForm=C(this.profileModel,N),this.isSubmitDisabled=y(()=>this.profileForm().invalid(),{}),this.securityModel=g({currentPassword:"",newPassword:"",confirmPassword:""},{}),this.securityForm=C(this.securityModel,z),this.isSecurityDisabled=y(()=>this.securityForm().invalid()||this.securityModel().newPassword!==this.securityModel().confirmPassword,{}),this._emitterService.onComplete("us.user").subscribe(()=>{let e=this.userService.user();this.profileModel.set({name:e.name||"",email:e.email||"",phone:e.phone||"",bio:e.bio||""}),this.profileForm().reset()})}setTab(e){this.activeTab.set(e)}wFormSubmit(){S(this.profileForm,e=>(this.userService.user.set(_(_({},this.userService.user()),e().value())),this.userService.updateMe(),Promise.resolve()))}wSecuritySubmit(){S(this.securityForm,e=>{let s=e().value();return this.userService.changePassword(s.currentPassword,s.newPassword).subscribe({next:()=>{this.securityForm().reset(),this.securityModel.set({currentPassword:"",newPassword:"",confirmPassword:""})}}),Promise.resolve()})}updateThumb(e){this.userService.user.set(x(_({},this.userService.user()),{thumb:e})),this.userService.thumb.set(e),this.userService.updateMe()}static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275cmp=M({type:t,selectors:[["ng-component"]],decls:10,vars:5,consts:[[1,"profile","grid","g-4"],[1,"profile__card","shadow","rounded-card"],[1,"profile__tabs"],[1,"profile__tab",3,"click","type","isMultipleClicksAllowed"],[1,"profile__body"],[1,"profile__panel","profile__panel--profile"],[1,"profile__panel","profile__panel--security"],["mode","single-image","view","thumb-only",3,"wImageChange","wImage","container","name","accept","clearable","preview","cropWidth","cropHeight"],[1,"profile__fields","stack",3,"submit"],["placeholder","Enter your name...",3,"field"],["placeholder","Enter your email...","type","email",3,"field"],["placeholder","Enter your phone...","type","tel",3,"field"],["placeholder","Enter your bio...","type","textarea",3,"field"],["type","primary",1,"mt-2",3,"disabled"],["placeholder","Enter your current password...","type","password",3,"field"],["placeholder","Enter your new password...","type","password",3,"field"],["placeholder","Confirm your new password...","type","password",3,"field"]],template:function(s,n){s&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"wbutton",3),d("click",function(){return n.setTab("profile")}),f(4," Profile "),o(),i(5,"wbutton",3),d("click",function(){return n.setTab("security")}),f(6," Security "),o()(),i(7,"div",4),E(8,U,9,17,"div",5)(9,j,7,7,"div",6),o()()()),s&2&&(r(3),c("type",n.activeTab()==="profile"?"primary":"link")("isMultipleClicksAllowed",!0),r(2),c("type",n.activeTab()==="security"?"primary":"link")("isMultipleClicksAllowed",!0),r(3),F(n.activeTab()==="profile"?8:9))},dependencies:[O,k,D],styles:[".profile[_ngcontent-%COMP%]{display:block}.profile__card[_ngcontent-%COMP%]{position:relative;inline-size:100%;max-inline-size:100%;background:var(--c-bg-secondary);padding:var(--sp-5) var(--sp-4);display:flex;flex-direction:column;gap:var(--sp-4)}.profile__tabs[_ngcontent-%COMP%]{display:flex;gap:var(--sp-3);border-bottom:1px solid var(--c-border);padding-bottom:var(--sp-3);margin-bottom:var(--sp-3)}.profile__tab[_ngcontent-%COMP%]{border:0;background:transparent;color:var(--c-text-secondary);font-weight:600;font-size:.9rem;padding:var(--sp-1_5) var(--sp-3);border-radius:var(--b-radius-btn);cursor:pointer;transition:background-color var(--motion) var(--easing),color var(--motion) var(--easing)}.profile__tab[_ngcontent-%COMP%]:focus-visible{outline:none;box-shadow:var(--focus-ring)}.profile__body[_ngcontent-%COMP%], .profile__panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--sp-3)}.profile__fields[_ngcontent-%COMP%]   .winput__field[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--c-border);border-radius:var(--b-radius);color:var(--c-text-secondary);transition:border-color var(--motion) var(--easing)}.profile__fields[_ngcontent-%COMP%]   .winput__field[_ngcontent-%COMP%]:focus-within{border-color:var(--c-primary)}.profile__fields[_ngcontent-%COMP%]   .wbutton[_ngcontent-%COMP%]{min-block-size:42px;border-radius:var(--b-radius-btn);font-weight:600}@media(max-width:991.9px){.profile[_ngcontent-%COMP%]{padding:var(--sp-3)}.profile__card[_ngcontent-%COMP%]{padding:var(--sp-4)}}"],changeDetection:0})}}return t})();export{ee as ProfileComponent};
