import{a as U}from"./chunk-RETWRCVX.js";import{b as q,e as B}from"./chunk-43RR6EI4.js";import{$ as p,$a as j,Aa as b,E as y,G as o,J as n,K as k,L as I,Ma as x,O as _,Q as s,Qa as E,U as a,V as l,W as g,Z as v,_ as m,_a as M,bb as T,eb as P,ga as S,gb as L,hb as V,qb as F,r as C,rb as N,w as h,x as f}from"./chunk-APRAEAY4.js";function O(e,u){if(e&1&&g(0,"img",9),e&2){let t=p();s("src",t.logo,y)}}function W(e,u){e&1&&g(0,"icon-spider")}function G(e,u){if(e&1){let t=v();a(0,"span",10),m("click",function(){h(t);let i=p();return f(i.userService.setMode("dark"))}),S(1," dark_mode "),l()}}function K(e,u){if(e&1){let t=v();a(0,"span",10),m("click",function(){h(t);let i=p();return f(i.userService.setMode())}),S(1," light_mode "),l()}}var D=(()=>{class e{constructor(t,r,i,d,H,R,z,A){this.userService=t,this.ui=r,this._alert=i,this._http=d,this._hash=H,this._router=R,this._form=z,this._translate=A,this.logo=L.meta.logo,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Submit",value:!0},{name:"Click",value:()=>{this.submit()}}]}]}),this.user={email:"ceo@webart.work",password:"asdasdasdasd",resetPin:null},this._set=c=>{if(c){let w=c.token||"";w&&this._http.set("token",w),localStorage.setItem("waw_user",JSON.stringify(c)),this.userService.setUser(c),this.userService.get(),this._router.navigateByUrl("/profile")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?(this._hash.set("email",this.user.email),this._http.post("/api/user/status",this.user,t=>{t.email&&t.pass?this.login():t.email?this.reset():this.sign()})):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",this.user,this._set.bind(this))}sign(){this._http.post("/api/user/sign",this.user,this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,t=>{t?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}static{this.\u0275fac=function(r){return new(r||e)(n(U),n(P),n(j),n(M),n(T),n(x),n(F),n(V))}}static{this.\u0275cmp=k({type:e,selectors:[["ng-component"]],standalone:!1,decls:10,vars:6,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img",3,"click"],["alt","Logo",3,"src",4,"ngIf"],[4,"ngIf"],[1,"auth__form"],[1,"auth"],["class","material-icons auth__icon",3,"click",4,"ngIf"],[3,"wSubmit","submition","config"],["alt","Logo",3,"src"],[1,"material-icons","auth__icon",3,"click"]],template:function(r,i){r&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),m("click",function(){return i.userService.setMode(i.userService.mode?"":"dark")}),_(3,O,1,1,"img",3)(4,W,1,0,"icon-spider",4),l(),a(5,"div",5)(6,"div",6),_(7,G,2,0,"span",7)(8,K,2,0,"span",7),a(9,"wform",8),m("wSubmit",function(){return i.submit()}),l()()()()()),r&2&&(o(3),s("ngIf",i.logo),o(),s("ngIf",!i.logo),o(3),s("ngIf",!i.userService.mode),o(),s("ngIf",i.userService.mode),o(),s("submition",i.user)("config",i.form))},dependencies:[b,N,q],encapsulation:2})}}return e})();var Q=[{path:"",component:D}],me=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=I({type:e})}static{this.\u0275inj=C({imports:[E.forChild(Q),B]})}}return e})();export{me as SignModule};
