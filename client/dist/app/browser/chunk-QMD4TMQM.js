import{d as z}from"./chunk-4YLOSOFQ.js";import{a as B,b as R}from"./chunk-RMZCV472.js";import{$ as y,Cb as E,Db as j,G as C,L as g,M as v,P as b,Y as k,Z as c,_ as p,da as T,db as A,ea as w,fa as x,fb as L,hb as V,ib as W,kb as N,mb as P,pa as h,r as _,ra as F,ta as S,u as r,ua as M,va as I,w as f,x as u,yb as D}from"./chunk-Q5TT443V.js";function q(m,n){if(m&1&&h(0),m&2){let a=n.$implicit;F(" ",a.components==null?null:a.components.length," ")}}function K(m,n){if(m&1){let a=T();c(0,"label",3)(1,"input",4),w("ngModelChange",function(){let t=f(a).$implicit,s=x();return u(s.changeStatus(t))}),I("ngModelChange",function(t){let s=f(a).$implicit;return M(s.active,t)||(s.active=t),u(t)}),p(),y(2,"span",5),c(3,"span",6),h(4,"Active"),p()()}if(m&2){let a=n.$implicit;C(),S("ngModel",a.active)}}var d=(()=>{let n=class n{get rows(){return this._cfs.customforms}constructor(){this._translate=r(D),this._cfs=r(E),this._alert=r(P),this._form=r(j),this.columns=["formId","components","active"],this.form=this._form.getForm("form",{formId:"form",title:"Custom form",components:[{name:"Text",key:"title",focused:!0,fields:[{name:"Placeholder",value:"fill title"},{name:"Label",value:"Title"}]},{name:"Select",key:"formId",fields:[{name:"Placeholder",value:"Select form id"},{name:"Label",value:"Form ID"},{name:"Items",value:this._form.formIds}]}]}),this.components=[],this.formComponents=this._form.getForm("formComponents",{formId:"formComponents",title:"Custom components",components:[{components:this.components},{name:"Select",key:"addComponent",fields:[{name:"Placeholder",value:"Select form componnet"},{name:"Label",value:"Form Component"},{name:"Value",value:"name",skipTranslation:!0},{name:"Items",value:this._form.getTemplateComponentsNames()}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(e,t)=>{this._cfs.create(e,{callback:t.bind(this)})}}).then(this._cfs.create.bind(this))},update:e=>{this._form.modal(this.form,{label:"Update",click:(t,s)=>{this._cfs.update(t,{callback:s.bind(this)})}},e).then(this._cfs.update.bind(this))},delete:e=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this user?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._cfs.delete(e)}}]})},buttons:[{icon:"text_fields",click:e=>{console.log(this.formComponents),this.components.splice(0,this.components.length);let t={addComponent:"Text"};e.components=e.components||[];for(let o=e.components.length-1;o>=0;o--){let l=this._form.getTemplateFields(e.components[o].name);e.components[o].fields=e.components[o].fields.filter(i=>l.includes(i.name));for(let i of l)e.components[o].fields.find(U=>U.name===i)||e.components[o].fields.push({value:"",name:i});t["key"+o]=e.components[o].key;for(let i of e.components[o].fields)t[i.name+o]=i.value}let s=o=>{this.components.splice(o,1),e.components.splice(o,1),this._cfs.updateAfterWhile(e)};(e.components||[]).forEach(o=>{this.components.push(this._addCustomComponent(o.name,this.components.length,s))}),this._form.modal(this.formComponents,{label:"Add component",click:()=>{let o=t.addComponent;this.components.push(this._addCustomComponent(o,this.components.length,s)),e.components.push({name:t.addComponent,fields:this._form.getTemplateFields(o).map(l=>({value:"",name:l}))})}},t,()=>{},{size:"big"}).then(()=>{for(let o=0;o<e.components.length;o++){e.components[o].key=t["key"+o];for(let l of e.components[o].fields)l.value=t[l.name+o]}this._cfs.updateAfterWhile(e)})}}]}}_addCustomComponent(e,t,s){let o=this._form.getTemplateFields(e).map(i=>({name:this._form.getCustomTemplateFields(e)[i]||"Text",key:i+t,fields:[{name:"Placeholder",value:"fill "+i},{name:"Label",value:i.charAt(0).toUpperCase()+i.slice(1,i.length)}]}));return{class:"d-f mt10",components:[{name:"Text",key:"key"+t,fields:[{name:"Placeholder",value:"fill key"},{name:"Label",value:"Key"}]},...o,{name:"Button",fields:[{name:"Label",value:"Remove"},{name:"Click",value:()=>{s(t)}}]}]}}changeStatus(e){setTimeout(()=>{if(e.active)for(let t of this._cfs.customforms)t._id===e._id||t.formId!==e.formId||t.active&&(t.active=!1,this._cfs.updateAfterWhile(t));this._cfs.updateAfterWhile(e)})}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=g({type:n,selectors:[["ng-component"]],decls:3,vars:3,consts:[["title","Forms Customization",3,"columns","config","rows"],["cell","components"],["cell","active"],[1,"container-box"],["type","checkbox",1,"w-input__checkbox",3,"ngModelChange","ngModel"],[1,"checkmark"],[1,"checkmark-text"]],template:function(t,s){t&1&&(c(0,"wtable",0),b(1,q,1,1,"ng-template",1)(2,K,5,1,"ng-template",2),p()),t&2&&k("columns",s.columns)("config",s.config)("rows",s.rows)},dependencies:[R,B,N,L,V,W],encapsulation:2});let m=n;return m})();var Y=[{path:"",component:d}],le=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=v({type:n}),n.\u0275inj=_({imports:[A.forChild(Y),z,d]});let m=n;return m})();export{le as CustomformsModule};
